{"version":3,"sources":["webpack:///./src/components/widgets/form-report/form-report.vue?0010","webpack:///./src/components/widgets/form-report/mixins/io.mixin.js","webpack:///./src/components/widgets/form-report/mixins/stat.mixin.js","webpack:///src/components/widgets/form-report/form-report.vue","webpack:///./src/components/widgets/form-report/form-report.vue?2aca","webpack:///./src/components/widgets/form-report/form-report.vue","webpack:///./node_modules/vuetify/lib/components/VCombobox/VCombobox.js","webpack:///./src/components/core/ext/echart.vue?b856","webpack:///./src/components/core/ext/echart.vue?ff55","webpack:///src/components/core/ext/echart.vue","webpack:///./src/components/core/ext/echart.vue?b538","webpack:///./src/components/core/ext/echart.vue?e824","webpack:///./src/mixins/core/widget-i18n.mixin.js","webpack:///./node_modules/vuetify/lib/components/VGrid/VContainer.js"],"names":["render","_vm","this","_c","_self","isProductionMode","_e","attrs","formList","on","onChangeForm","scopedSlots","_u","key","fn","data","staticClass","staticStyle","_v","_s","item","id","metadata","app_name","value","form_title","model","config","callback","$$v","$set","expression","translate","moment","Date","formConfig","updatedAt","format","app_url","accessMode","text","access","lastNotificatedAt","fromNow","formStat","events","total","range","min","max","chartOptions","_l","q","q_index","options","title","note","type","rule","maxCustomResponses","step","n","nIndex","e","eIndex","f","fIndex","s","sIndex","idx","class","cellClass","style","effects","length","index1","index2","getChart","entities","staticRenderFns","_dps","createForm","cloneForm","updateForm","extendForm","getForm","deleteForm","exportForm","updateAnswer","getAnswer","loadResponseStat","exportResponses","loadAllResponses","findUserProfile","getStat","getFormList","methods","$dps","run","script","state","then","res","form","Object","assign","cloned","location","href","createdAt","formId","questions","$djvue","selectWidgets","$root","widget","map","JSON","parse","stringify","question","$refs","instance","a","document","createElement","setAttribute","encodeURIComponent","click","email","user","answer","form_id","app","dpsURL","url","users","_template","interpolate","forEach","u","index","to","subject","html","context","Promise","resolve","reject","date","start","level","defFormat","lo","startOf","hi","add","isSameOrAfter","isSameOrBefore","dLo","diff","dHi","r","responses","timeline","RStat","sort","b","push","p","getPoints","stop","titleFormat","splice","round","points","stats","filter","t","isSame","sum","reduce","height","eventDynamic","stat","nominals","result","c","statOptions","color","$vuetify","theme","themes","light","primary","grid","left","right","bottom","containLabel","xAxis","yAxis","series","name","itemStyle","opacity","truncate","reverse","concat","v","scale","l","legend","areaStyle","markLine","e1","e2","values","angleAxis","d","axisLabel","margin","fontSize","fontWeight","secondary","radiusAxis","splitNumber","axisLine","show","polar","coordinateSystem","factors","factor","effect","priority","toFixed","stack","toString","substring","statMap","oneOfManyStat","manyOfManyStat","rangeStat","rateStat","dateStat","associationStat","influenceStat","priorityStat","icon","mixins","components","echart","computed","width","Math","trunc","loadReport","loadForm","locale","setLocale","getChartOptions","getQuestionChartOptions","setNeedSave","getResponseDynamic","maxResponses","redraw","tooltip","position","formatter","x","y","top","textBaseline","textStyle","singleAxis","boundaryGap","interval","lineStyle","axisTick","singleAxisIndex","symbolSize","dataItem","props","watch","loadFormList","$emit","i18n","en","uk","component","VCard","VCombobox","VContainer","VDivider","VFlex","VLayout","extend","delimiters","Array","default","returnObject","Boolean","editingIndex","multiple","selectedItems","internalSearch","hasSlot","call","isFocused","hasDisplayedItems","$slots","hideNoData","val","delimiter","find","endsWith","slice","updateTags","updateMenuDimensions","input","genInput","paste","onPaste","chip","genChipSelection","componentOptions","listeners","dblclick","getText","selectedIndex","onChipInput","preventDefault","getMenuIndex","$nextTick","updateSelf","keyCode","ctrlKey","home","end","includes","onKeyDown","selectionStart","enter","onEnterDown","changeSelectedIndex","stopPropagation","onTabDown","updateEditing","selectItem","toLocaleLowerCase","internalValue","setValue","undefined","findIndex","searchIsDirty","isUsingSlot","$scopedSlots","selection","hasChips","updateCombobox","menuIndex","itemToSelect","event","_a","pastedItemText","clipboardData","getData","findExistingIndex","clearableCallback","chart","echarts","$el","resizeHandler","clientWidth","resize","window","attachEvent","addEventListener","setTimeout","setOption","params","handler","deep","initChart","detachEvent","removeEventListener","off","$t","$i18n_id","randomName","messages","$i18n","mergeLocaleMessage","_initI18n","_destroyI18n","functional","String","tag","fluid","h","children","classes","keys","startsWith","domProps"],"mappings":"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","file":"js/chunk-3246118a.3f0109d0.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[(!_vm.isProductionMode)?_c('v-container',[_c('v-layout',{attrs:{\"align-center\":\"\",\"justify-center\":\"\",\"row\":\"\",\"fill-height\":\"\"}},[_c('v-flex',{attrs:{\"xs12\":\"\",\"pa-3\":\"\",\"justify-center\":\"\"}},[_c('v-combobox',{attrs:{\"items\":_vm.formList,\"label\":\"Select form\"},on:{\"change\":_vm.onChangeForm},scopedSlots:_vm._u([{key:\"item\",fn:function(data){return [_c('span',{staticClass:\"caption\",staticStyle:{\"padding-left\":\"1em\"}},[_vm._v(\"\\n              \"+_vm._s(data.item.id)+\":\\n              \"+_vm._s((data.item.metadata.app_name) ? data.item.metadata.app_name.value : '')+\":\\n              \"+_vm._s((data.item.metadata.form_title) ? data.item.metadata.form_title.value : '')+\"\\n            \")])]}},{key:\"selection\",fn:function(data){return [_c('span',{staticClass:\"caption\",staticStyle:{\"padding-left\":\"1em\"}},[_vm._v(\"\\n              \"+_vm._s(data.item.id)+\":\\n              \"+_vm._s((data.item.metadata.app_name) ? data.item.metadata.app_name.value : '')+\":\\n              \"+_vm._s((data.item.metadata.form_title) ? data.item.metadata.form_title.value : '')+\"\\n            \")])]}}],null,false,2135581308),model:{value:(_vm.config.form),callback:function ($$v) {_vm.$set(_vm.config, \"form\", $$v)},expression:\"config.form\"}})],1)],1),_c('v-divider')],1):_vm._e(),_c('v-container',[_c('v-divider'),(_vm.formConfig)?_c('div',[_c('div',{staticClass:\"font-weight-bold primary white--text caption ma-0 pa-2\"},[_c('p',{staticClass:\"font-weight-bold mx-0 px-2\",staticStyle:{\"text-align\":\"right\",\"margin\":\"0 0 2px 0\"}},[_vm._v(\"\\n          JACE FORMS REPORT\\n        \")]),_c('p',{staticClass:\"font-weight-light mx-0 px-2\",staticStyle:{\"text-align\":\"left\",\"margin\":\"0 0 2px 0\"}},[_c('b',[_vm._v(_vm._s(_vm.translate('Last_update')))]),_vm._v(\" \"+_vm._s(_vm.moment(new Date(_vm.formConfig.updatedAt)).format('YYYY-MM-DD'))+\"\\n        \")]),_c('p',{staticClass:\"font-weight-light mx-0 px-2\",staticStyle:{\"text-align\":\"left\",\"margin\":\"0 0 2px 0\"}},[_c('b',[_vm._v(_vm._s(_vm.translate('Application')))]),_c('a',{staticClass:\"white--text\",attrs:{\"href\":_vm.formConfig.metadata.app_url.value,\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.formConfig.metadata.app_name.value))])]),_c('p',{staticClass:\"font-weight-light mx-0 px-2\",staticStyle:{\"text-align\":\"left\",\"margin\":\"0 0 2px 0\"}},[_c('b',[_vm._v(_vm._s(_vm.translate('Access_for')))]),_vm._v(\"\\n           \"+_vm._s(_vm.translate(_vm.accessMode.text))+\"\\n           \"+_vm._s((_vm.formConfig.config.access.enabled) ? _vm.translate('Opened') : _vm.translate('Closed'))+\"\\n           \"+_vm._s((_vm.formConfig.config.access.lastNotificatedAt) ? _vm.moment(new Date(_vm.formConfig.config.access.lastNotificatedAt)).fromNow() : '')+\"\\n        \")]),(_vm.formStat)?_c('p',{staticClass:\"font-weight-light mx-0 px-2\",staticStyle:{\"text-align\":\"left\",\"margin\":\"0 0 2px 0\"}},[_c('b',[_vm._v(_vm._s(_vm.translate('Respondent_activity')))]),_vm._v(\"\\n           \"+_vm._s(_vm.translate('Total'))+\"\\n           \"+_vm._s(_vm.formStat.events.total)+\"\\n           \"+_vm._s(_vm.translate('Responses'))+\"\\n           ( \"+_vm._s(_vm.moment(new Date(_vm.formStat.events.range.min)).format('YYYY-MM-DD HH:mm'))+\" -\\n           \"+_vm._s(_vm.moment(new Date(_vm.formStat.events.range.max)).format('YYYY-MM-DD HH:mm'))+\" )\\n        \")]):_vm._e()])]):_vm._e(),(_vm.formStat)?_c('div',[_c('echart',{attrs:{\"options\":_vm.chartOptions,\"height\":\"250\"}}),_c('v-divider')],1):_vm._e(),(_vm.formConfig)?_c('div',_vm._l((_vm.formConfig.config.questions),function(q,q_index){return _c('div',{key:q_index,staticClass:\"mt-3\"},[_c('h2',{staticClass:\"headline font-weight-light primary--text\"},[_vm._v(\"\\n          \"+_vm._s(q_index+1)+\". \"+_vm._s(q.options.title)+\" \"),(q.options.required)?_c('span',{staticClass:\"caption warning--text\"},[_vm._v(\"(\"+_vm._s(_vm.translate('Required'))+\")\")]):_vm._e()]),_c('p',{staticClass:\"caption secondary--text font-weight-light pl-3 ma-0\"},[_vm._v(\"\\n          \"+_vm._s(q.options.note)+\"\\n        \")]),_c('p',{staticClass:\"caption primary--text pl-2 ma-0\"},[_vm._v(\"\\n          \"+_vm._s(_vm.translate('Response_type'))+\" \"+_vm._s(_vm.translate(q.options.type))+\"\\n        \")]),(q.options.type == 'One of many selection' || q.options.type == 'Many of many selection')?_c('p',{staticClass:\"caption secondary--text weight-light pl-3 ma-0\"},[(q.options.type == 'Many of many selection')?_c('span',{staticClass:\"font-weight-light\"},[_vm._v(\"\\n            \"+_vm._s(_vm.translate('Respondent_shuld_select_between'))+\" \"+_vm._s(q.options.rule.min)+\" \"+_vm._s(_vm.translate('And'))+\" \"+_vm._s(q.options.rule.max)+\" \"+_vm._s(_vm.translate('Variants'))+\". \")]):_vm._e(),(q.options.addEnabled)?_c('span',{staticClass:\"font-weight-light\"},[_vm._v(_vm._s(_vm.translate('Respondent_can_add_max'))+\" \"+_vm._s(q.options.maxCustomResponses)+\" \"+_vm._s(_vm.translate('Self_variants'))+\". \")]):_vm._e(),(q.options.userCollaboration)?_c('span',{staticClass:\"font-weight-light\"},[_vm._v(_vm._s(_vm.translate('Respondents_collaboration_detected'))+\".\")]):_vm._e()]):_vm._e(),(q.options.type == 'Range')?_c('p',{staticClass:\"body-1 secondary--text font-weight-light pl-3 ma-0\"},[_vm._v(\"\\n          \"+_vm._s(_vm.translate('Range_between'))+\" \"+_vm._s(q.options.range[0])+\" \"+_vm._s(_vm.translate('And'))+\" \"+_vm._s(q.options.range[1])+\" \"+_vm._s(_vm.translate('By_step'))+\" \"+_vm._s(q.options.step)+\"\\n        \")]):_vm._e(),(q.options.nominals)?_c('p',{staticClass:\"caption secondary--text pl-3 pt-2 ma-0\"},[_c('b',[_vm._v(_vm._s(_vm.translate('Nominals')))]),_c('ul',_vm._l((q.options.nominals),function(n,nIndex){return _c('li',{key:nIndex},[_vm._v(\"\\n              \"+_vm._s(n.title)+\"\\n            \")])}),0)]):_vm._e(),(q.options.entities)?_c('p',{staticClass:\"caption secondary--text weight-light pl-3 ma-0 pt-2\"},[_c('b',[_vm._v(_vm._s(_vm.translate('Entities')))]),_c('ul',_vm._l((q.options.entities),function(e,eIndex){return _c('li',{key:eIndex},[_vm._v(\"\\n              \"+_vm._s(e.title)+\"\\n            \")])}),0)]):_vm._e(),(q.options.factors)?_c('p',{staticClass:\"caption secondary--text weight-light pl-3 ma-0 pt-2\"},[_c('b',[_vm._v(_vm._s(_vm.translate('Factors')))]),_c('ul',_vm._l((q.options.factors),function(f,fIndex){return _c('li',{key:fIndex},[_vm._v(\"\\n              \"+_vm._s(f.title)+\"\\n            \")])}),0)]):_vm._e(),(q.options.effects)?_c('p',{staticClass:\"caption secondary--text weight-light pl-3 ma-0 pt-2\"},[_c('b',[_vm._v(_vm._s(_vm.translate('Effects')))]),_c('ul',_vm._l((q.options.effects),function(e,eIndex){return _c('li',{key:eIndex},[_vm._v(\"\\n              \"+_vm._s(e.title)+\"\\n            \")])}),0)]):_vm._e(),(q.options.scale)?_c('p',{staticClass:\"caption secondary--text weight-light pl-3 ma-0 pt-2\"},[_c('b',[_vm._v(_vm._s(_vm.translate('Scale')))]),_c('ul',_vm._l((q.options.scale),function(s,sIndex){return _c('li',{key:sIndex},[_vm._v(\"\\n              \"+_vm._s(s.value)+\" ( \"+_vm._s(s.title)+\" )\\n            \")])}),0)]):_vm._e(),(_vm.formStat)?_c('div',[_c('div',{staticClass:\"caption secondary--text pl-3 pt-2 ma-0\"},[_c('b',[_vm._v(_vm._s(_vm.translate('Statistic')))])]),(q.options.type=='Influence')?_c('v-card',{staticClass:\"mt-3\",attrs:{\"flat\":\"\",\"color\":\"transparent\"}},[_c('v-layout',{attrs:{\"fill-height\":\"\",\"row\":\"\"}},[_c('v-flex',{staticClass:\"text-xs-center headline\",staticStyle:{\"border-left\":\"1px solid #dedede\",\"border-bottom\":\"1px solid #dcdcdc\",\"border-top\":\"1px solid #dcdcdc\"},attrs:{\"xs2\":\"\",\"pa-2\":\"\"}}),_vm._l((q.options.effects),function(e,idx){return _c('v-flex',{key:idx,class:`${_vm.cellClass(q)} text-xs-center`,style:(`\n                    min-height:3em; \n                    border-left:1px solid #dedede; \n                    border-bottom:1px solid #dcdcdc;  \n                    border-top:1px solid #dcdcdc;\n                    ${ (idx == (q.options.effects.length-1)) ? 'border-right: 1px solid #dcdcdc !important;' : ''}\n                  `)},[_c('span',{staticClass:\"caption\"},[_vm._v(_vm._s(e.title))])])})],2),_vm._l((q.options.factors),function(f,index1){return _c('v-layout',{key:index1,attrs:{\"fill-height\":\"\",\"row\":\"\"}},[_c('v-flex',{staticClass:\"caption\",staticStyle:{\"border-left\":\"1px solid #dcdcdc\",\"border-bottom\":\"1px solid #dcdcdc\"},attrs:{\"xs2\":\"\",\"pa-2\":\"\",\"align-center\":\"\"}},[_vm._v(\"\\n                \"+_vm._s(f.title)+\"\\n              \")]),_vm._l((q.options.effects),function(e,index2){return _c('v-flex',{key:index2,class:`${_vm.cellClass(q)} text-xs-center`,style:(`\n                  min-height:3em; \n                  border-left: 1px solid #dcdcdc;\n                  border-bottom:1px solid #dcdcdc; \n                  ${ (index2 < (q.options.effects.length-1)) ? '' :'border-right: 1px solid #dcdcdc !important;'}\n                `),attrs:{\"align-center\":\"\"}},[_c('v-layout',{staticStyle:{\"height\":\"100%\"},attrs:{\"align-center\":\"\"}},[_c('v-flex',{staticClass:\"text-xs-center body-2\"},[(_vm.getChart(q,f,e))?_c('echart',{attrs:{\"options\":_vm.getChart(q,f,e),\"height\":\"150\"}}):_vm._e()],1)],1)],1)})],2)})],2):_vm._e(),(q.options.type=='Association')?_c('v-card',{staticClass:\"mt-3\",attrs:{\"flat\":\"\",\"color\":\"transparent\"}},[_c('v-layout',{attrs:{\"fill-height\":\"\",\"row\":\"\"}},[_c('v-flex',{staticClass:\"text-xs-center headline\",staticStyle:{\"border-left\":\"1px solid #dedede\",\"border-bottom\":\"1px solid #dcdcdc\",\"border-top\":\"1px solid #dcdcdc\"},attrs:{\"xs2\":\"\",\"pa-2\":\"\"}}),_vm._l((q.options.entities),function(e,idx){return _c('v-flex',{key:idx,class:`${_vm.cellClass(q)} text-xs-center`,style:(`\n                    min-height:3em; \n                    border-left:1px solid #dedede; \n                    border-bottom:1px solid #dcdcdc;  \n                    border-top:1px solid #dcdcdc;\n                    ${ (idx == (q.options.entities.length-1)) ? 'border-right: 1px solid #dcdcdc !important;' : ''}\n                  `)},[_c('span',{staticClass:\"caption\"},[_vm._v(_vm._s(e.title))])])})],2),_vm._l((q.options.entities),function(f,index1){return _c('v-layout',{key:index1,attrs:{\"fill-height\":\"\",\"row\":\"\"}},[_c('v-flex',{staticClass:\"caption\",staticStyle:{\"border-left\":\"1px solid #dcdcdc\",\"border-bottom\":\"1px solid #dcdcdc\"},attrs:{\"xs2\":\"\",\"pa-2\":\"\",\"align-center\":\"\"}},[_vm._v(\"\\n                \"+_vm._s(f.title)+\"\\n              \")]),_vm._l((q.options.entities),function(e,index2){return _c('v-flex',{key:index2,class:`${_vm.cellClass(q)} text-xs-center`,style:(`\n                  min-height:3em; \n                  border-left: 1px solid #dcdcdc;\n                  border-bottom:1px solid #dcdcdc; \n                  ${ (index2 < (q.options.entities.length-1)) ? '' :'border-right: 1px solid #dcdcdc !important;'}\n                `),attrs:{\"align-center\":\"\"}},[(index2 > index1)?_c('v-layout',{staticStyle:{\"height\":\"100%\"},attrs:{\"align-center\":\"\"}},[_c('v-flex',{staticClass:\"text-xs-center body-2\"},[(_vm.getChart(q,f,e))?_c('echart',{attrs:{\"options\":_vm.getChart(q,f,e),\"height\":\"150\"}}):_vm._e()],1)],1):_c('v-layout',{staticStyle:{\"height\":\"100%\"}})],1)})],2)})],2):_vm._e(),(q.options.type != 'Association' && q.options.type != 'Influence')?_c('echart',{attrs:{\"options\":q.chartOptions,\"height\":\"250\"}}):_vm._e()],1):_vm._e()])}),0):_vm._e()],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { templateSettings, template } from \"lodash\"\r\nimport moment from \"moment\"\r\n\r\n\r\nlet _dps = {\r\n\r\n  createForm: `\r\n            // createForm \r\n            client();\r\n            set(\"owner\")\r\n            <?javascript\r\n                $scope.form = {\r\n                    metadata: $scope.form.metadata,\r\n                    config: $scope.form.config,\r\n                    owner:$scope.owner.client.user,\r\n                    history:[\r\n                        {\r\n                            state:\"created\",\r\n                            message:\"Create form via \"+$scope.owner.client.app,\r\n                            user: $scope.owner.client.user,\r\n                            date: new Date()\r\n                        }\r\n                    ]\r\n                }\r\n            ?>\r\n            dml.insert(into:\"form\", values:{{form}})\r\n        `,\r\n\r\n    cloneForm: `\r\n            // cloneForm \r\n            client();\r\n            set(\"owner\")\r\n            <?javascript\r\n                $scope.form.owner = $scope.owner.client.user;\r\n                $scope.form.history.push({\r\n                            state:\"created\",\r\n                            message:\"Clone form via \"+$scope.owner.client.app,\r\n                            user: $scope.owner.client.user,\r\n                            date: new Date()\r\n                })\r\n            ?>\r\n            dml.insert(into:\"form\", values:{{form}})\r\n        `,    \r\n\r\n  updateForm: `\r\n        // updateForm\r\n            client();\r\n            set(\"owner\")\r\n\r\n            <?javascript\r\n\r\n                $scope.updatedForm = (item) => item.id == $scope.form.id;\r\n                $scope.update = (item) => {\r\n                    \r\n                    // $scope.form.history.push({\r\n                    //     date: new Date(),\r\n                    //     message:\"Update form\",\r\n                    //     state:\"updated\",\r\n                    //     user: $scope.owner.client.user\r\n                    // });\r\n                    \r\n                    return $scope.form;\r\n                };\r\n\r\n            ?>\r\n\r\n            dml.update(for:\"form\", as:{{update}}, where:{{updatedForm}})\r\n        `,\r\n\r\n  extendForm: `\r\n        // extendForm\r\n            <?javascript\r\n    \r\n                $scope.updatedForm = (item) => item.id == $scope.form.id;\r\n                \r\n                $scope.extendNominals = (form) => {\r\n                  \r\n                  if (!form.config.questions) return form\r\n\r\n                  form.config.questions.forEach( q => {\r\n                    let fromForm = _.find($scope.form.config.questions, ff => ff.id == q.id)\r\n                    if(fromForm && fromForm.options.nominals){\r\n                      q.options.nominals = (q.options.nominals || []).concat(fromForm.options.nominals)\r\n                      q.options.nominals = _.unique(q.options.nominals,'id')  \r\n                    }\r\n                  })\r\n                  \r\n                  return form\r\n                }\r\n    \r\n            ?>\r\n\r\n\r\n            dml.update(for:\"form\", as:{{extendNominals}}, where:{{updatedForm}})\r\n\r\n\r\n            \r\n        `,\r\n\r\n\r\n  getForm: `\r\n            // getForm\r\n            <?javascript\r\n                $scope.filter = (item) => item.id == $scope.form;\r\n            ?>\r\n\r\n            dml.select(from:\"form\", where:{{filter}}, populate:\"project\")\r\n        `,\r\n\r\n\r\n\r\n  deleteForm: `\r\n            // deleteForm\r\n            <?javascript\r\n                $scope.filter = (item) => item.id == $scope.form;\r\n            ?>\r\n\r\n            dml.delete(from:\"form\", where:{{filter}})\r\n    `,\r\n\r\n  exportForm:`\r\n      get(\"form\")\r\n      export(\"formExport.json\")\r\n  `,  \r\n\r\n  updateAnswer: `\r\n            // updateAnswer\r\n            dml.insertOrUpdate(into:\"answer\", value:{{answer}})\r\n    `,\r\n\r\n  getAnswer: `\r\n      // getAnswer\r\n      \r\n      <?javascript\r\n\r\n        $scope.forUser = item => {\r\n        \r\n            if(!$scope.form) return false;\r\n                     \r\n            if($scope.user.apikey){\r\n                return (item.form == $scope.form) && (item.user.apikey == $scope.user.apikey);\r\n            }\r\n            \r\n            if($scope.user.id){\r\n                return (item.form == $scope.form) && (item.user.id == $scope.user.id);\r\n            }\r\n            \r\n            return false;\r\n        }    \r\n              \r\n        $scope.byDate = _util.comparator.Date[\"Z-A\"](item => item.updatedAt)\r\n\r\n      ?>\r\n\r\n      dml.select(from:\"answer\",where:{{forUser}})\r\n      c.order(by:\"updatedAt\")\r\n      set(\"res\")\r\n      return(\"res[0]\")\r\n\r\n    `,\r\n    loadResponseStat:\r\n    `\r\n        <?javascript\r\n          $scope.f = item => item.form == $scope.form;\r\n          $scope.map = (item,index) => {return {date:item.updatedAt,v:1}};\r\n          $scope.sort = _util.comparator.Date[\"A-Z\"](item => item.date);\r\n        ?>\r\n\r\n        dml.select(from:\"answer\", where:{{f}}, as:{{map}})\r\n        // json()\r\n        c.order(by:\"date\")\r\n    `,\r\n    exportResponses:`\r\n\r\n<?javascript\r\n    // $scope.form = \"5c38b9a9327cb41c1df5d8ea\"\r\n    $scope.forForm = item => $scope.form && (item.form == $scope.form);\r\n    $scope.filter = (item) => item.id == $scope.form;\r\n    $scope.byDate = _util.comparator.Date[\"A-Z\"](item => item.updatedAt);\r\n?>\r\n\r\ndml.select(from:\"answer\",where:{{forForm}})\r\nc.order(by:\"updatedAt\")\r\nset(\"responses\")\r\n\r\ndml.select(from:\"form\", where:{{filter}})\r\nset(\"form\")\r\n\r\n<?javascript\r\n    $scope.form = $scope.form[0]\r\n    \r\n    \r\n    $scope.responses = $scope.responses.map( (r, index) => ({\r\n        response_id: r.id\r\n        ,form: r.form\r\n        ,access: r.updatedAt\r\n        ,respondent_id: (r.user.id) ? r.user.id : null\r\n        ,respondent_apikey: (r.user.apikey) ? r.user.apikey : null\r\n        ,respondent_index: (!r.user.id && !r.user.apikey) ? index : null\r\n        ,data: r.data\r\n    }));\r\n    \r\n    \r\n    \r\n    let rawData = []\r\n    $scope.responses.forEach( r => {\r\n        if(r.data)\r\n            r.data.forEach( q => {\r\n                let q_desc = _.find($scope.form.config.questions, qd => qd.id == q.id)\r\n                rawData.push({\r\n                     response_id: r.response_id\r\n                    ,response_valid: r.response_valid\r\n                    ,form: r.form\r\n                    ,access: r.access\r\n                    ,respondent_id: r.respondent_id\r\n                    ,respondent_apikey: r.respondent_apikey\r\n                    ,respondent_index: r.respondent_index\r\n                    ,question_id: q.id\r\n                    ,question_type: q.type\r\n                    ,question_required: (q_desc) ? q_desc.options.required : null\r\n                    ,response_valid: q.valid\r\n                    ,question_title: (q_desc) ? q_desc.options.title : null\r\n                    ,question_note: (q_desc) ? q_desc.options.note : null\r\n                    ,data: q.data\r\n                })          \r\n            })\r\n    })\r\n    \r\n    rawData = rawData.filter( \r\n        r => _.find($scope.form.config.questions, qd => r.question_id == qd.id)\r\n    );\r\n    \r\n    let rawData1 = []\r\n    \r\n    rawData.forEach( r => {\r\n        r.data.forEach( d => {\r\n            \r\n            let conf = _.find($scope.form.config.questions, q => q.id == r.question_id)\r\n            \r\n            let nominal = null;\r\n            let entity_1 = null;\r\n            let entity_2 = null;\r\n            let factor = null;\r\n            let effect = null;\r\n            let value = null;\r\n            let min = null;\r\n            let max = null;\r\n            let nominal_title = null;\r\n            let entity_1_title = null;\r\n            let entity_2_title = null;\r\n            let factor_title = null;\r\n            let effect_title = null;\r\n            let value_title = null;\r\n            let v;\r\n            \r\n            switch (r.question_type) {\r\n              \r\n                case 'One of many selection' : \r\n                case 'Many of many selection' : \r\n                    let n = _.find(conf.options.nominals, n => n.id == d)\r\n                \r\n                    nominal = d;\r\n                    nominal_title = n.title\r\n                    value = true;\r\n                    break\r\n              \r\n                case 'Association' : \r\n                    let e1 = _.find(conf.options.entities, n => n.id == d.e1)\r\n                    let e2 = _.find(conf.options.entities, n => n.id == d.e2)\r\n                    v = conf.options.scale[d.value-1]\r\n                    entity_1 = d.e1;\r\n                    entity_1_title = e1.title\r\n                    entity_2 = d.e2;\r\n                    entity_2_title = e2.title\r\n                    value = d.value;\r\n                    value_title = (v) ? (v.title) ? v.title : null : null\r\n                    break\r\n                    \r\n                case 'Influence' : \r\n                    let f = _.find(conf.options.factors, n => n.id == d.e1)\r\n                    let e = _.find(conf.options.effects, n => n.id == d.e2)\r\n                    v = conf.options.scale[d.value-1]\r\n                    \r\n                    factor = d.e1;\r\n                    factor_title = f.title\r\n                    effect = d.e2;\r\n                    effect_title = e.title\r\n                    value = d.value;\r\n                    value_title = (v) ? (v.title) ? v.title : null : null\r\n                    break\r\n                    \r\n                case 'Range':\r\n                    min = d[0];\r\n                    max = d[1];\r\n                    value = true;\r\n                    break\r\n                    \r\n                case 'Date':\r\n                    value = d\r\n                    break    \r\n                \r\n                case 'Rate':\r\n                    v = conf.options.scale[d-1]\r\n                    value = d\r\n                    value_title = v.title\r\n                    break\r\n            }\r\n            \r\n            \r\n            rawData1.push({\r\n                 response_id: r.response_id\r\n                ,response_valid: r.response_valid\r\n                ,form: r.form\r\n                ,access: r.access\r\n                ,respondent_id: r.respondent_id\r\n                ,respondent_apikey: r.respondent_apikey\r\n                ,respondent_index: r.respondent_index\r\n                ,question_id: r.question_id\r\n                ,question_type: r.question_type\r\n                ,question_required: r.question_required\r\n                ,question_valid: r.question_valid\r\n                ,question_title: r.question_title\r\n                ,question_note: r.question_note\r\n                ,nominal \r\n                ,nominal_title\r\n                ,entity_1\r\n                ,entity_1_title\r\n                ,entity_2\r\n                ,entity_2_title\r\n                ,factor\r\n                ,factor_title\r\n                ,effect\r\n                ,effect_title\r\n                ,min\r\n                ,max\r\n                ,value\r\n                ,value_title\r\n                \r\n            })\r\n        })\r\n    })\r\n    \r\n    $scope.rawData = rawData1.filter(r => r.value != null)\r\n    $scope.filename = $scope.form.id + \"_\" + _util.format.date(new Date(),\"YYYY_MM_DD_HH_mm\") + \"_responses.csv\";\r\n    \r\n?>\r\nget(\"rawData\")\r\nexport({{filename}})\r\n\r\n\r\n\r\n    `,\r\n    loadAllResponses:\r\n    `\r\n      // loadAllResponses    \r\n        <?javascript\r\n            $scope.forForm = (item) => item.form == $scope.form_id;\r\n            $scope.isForm = (item) => item.id == $scope.form_id;\r\n\r\n            // $scope.filename = $scope.form_id+\"_\"+_util.format.date(new Date(),\"YYYY_MM_DD_HH_mm\")+\"_responses.csv\";\r\n        ?>\r\n\r\n        dml.select(from:\"answer\", where:{{forForm}})\r\n        set(\"answers\")\r\n        dml.select(from:\"form\", where:{{isForm}})\r\n        set(\"form\")\r\n\r\n        <?javascript\r\n\r\n        let questions = $scope.form[0].config.questions;\r\n\r\n        let answers = $scope.answers.map ((a) => {\r\n          a.data = _.pairs(a.data).map(d => {\r\n            d[1].title = questions[d[0]].options.title;\r\n            \r\n            d[1].id = d[0];\r\n            \r\n            if (!d[1].value) {\r\n              return d[1]\r\n            }\r\n            \r\n            if( [\"influences\"].indexOf(d[1].type) >=0 ){\r\n              d[1].value = d[1].value.map(v => {\r\n                return {\r\n                  entity_id: v.entity,\r\n                  entity_title: questions[d[0]].options.entities[v.entity].title,\r\n                  property_id: v.property,\r\n                  property_title: questions[d[0]].options.properties[v.property].title,\r\n                  value:v.value\r\n                }\r\n              }) \r\n            }\r\n\r\n            if( [\"pairs\",\"radiopairs\"].indexOf(d[1].type) >=0 ){\r\n              d[1].value = d[1].value.map(v => {\r\n                return {\r\n                  entity_id: v.entity,\r\n                  entity_title: questions[d[0]].options.entities[v.entity].title,\r\n                  property_id: v.property,\r\n                  property_title: questions[d[0]].options.properties[v.property].title,\r\n                  value:1\r\n                }\r\n              }) \r\n            }\r\n\r\n            if( [\"radio\",\"check\",\"dropdown\"].indexOf(d[1].type) >= 0 ){\r\n              d[1].value = d[1].value.map(v => {\r\n                return {\r\n                  entity_id: v,\r\n                  entity_title: questions[d[0]].options.nominals[v].title,\r\n                  property_id: \"\",\r\n                  property_title:\"\",\r\n                  value:1\r\n                }\r\n              }) \r\n            }\r\n            \r\n            if( [\"scales\"].indexOf(d[1].type) >= 0 ){\r\n              d[1].value = d[1].value.map(v => {\r\n                return {\r\n                  entity_id: v.entity,\r\n                  entity_title: questions[d[0]].options.entities[v.entity].title,\r\n                  property_id: \"\",\r\n                  property_title:\"\",\r\n                  value:v.value\r\n                }\r\n              }) \r\n            }\r\n            \r\n            \r\n            if( [\"text\",\"rate\",\"range\",\"datetime\",\"scale\"].indexOf(d[1].type) >= 0 ){\r\n              d[1].value = d[1].value.map(v => {\r\n                return {\r\n                  entity_id: \"\",\r\n                  entity_title: \"\",\r\n                  property_id: \"\",\r\n                  property_title:\"\",\r\n                  value:(d[1].type==\"datetime\")? _util.format.date(new Date(v), \"DD/MM/YY HH:mm\") : v\r\n                }\r\n              }) \r\n            }\r\n            \r\n            return d[1];\r\n          })\r\n          return a;\r\n        });\r\n\r\n\r\n\r\n\r\n\r\n        let responses = [];\r\n\r\n        answers = answers.forEach( a => {\r\n            a.data.forEach( d => {\r\n              if(d.value){\r\n                d.value.forEach( v => {\r\n                    responses.push({\r\n                      response_id:a.id,\r\n                      updatedAt: _util.format.date(a.updatedAt, \"DD/MM/YY HH:mm\"),\r\n                      form:a.form,\r\n                      respondent:(a.user.email)? a.user.email : \"\",\r\n                      question_id: d.id,\r\n                      question_title: d.title,\r\n                      question_type: d.type,\r\n                      valid:(d.valid)? 1 : 0,\r\n                      entity_id: v.entity_id,\r\n                      entity_title:v.entity_title,\r\n                      property_id:v.property_id,\r\n                      property_title:v.property_title,\r\n                      value:v.value     \r\n                    })\r\n                  })    \r\n              } \r\n            })\r\n        });\r\n\r\n        $scope.responses = responses;\r\n\r\n        ?>\r\n\r\n        get(\"responses\")\r\n\r\n    `,\r\n    findUserProfile: `\r\n      // <?javascript\r\n      //     $scope.email = \"annakukharuk@gmail.com\";\r\n      //     $scope.email = \"ishchenko.kpi@gmail.com\";\r\n      // ?>\r\n\r\n      profile.find({{email}})\r\n    `,\r\n    getStat:`\r\n\r\n// getStat\r\n\r\n<?javascript\r\n    // $scope.form = \"5c24becd327cb41c1df5d85f\"\r\n    $scope.forForm = item => $scope.form && (item.form == $scope.form);\r\n    $scope.filter = (item) => item.id == $scope.form;\r\n    $scope.byDate = _util.comparator.Date[\"A-Z\"](item => item.updatedAt);\r\n    $scope.stat = {};\r\n?>\r\n\r\ndml.select(from:\"answer\",where:{{forForm}})\r\nc.order(by:\"updatedAt\")\r\nset(\"responses\")\r\ndml.select(from:\"form\", where:{{filter}})\r\nset(\"form\")\r\n\r\n<?javascript\r\n    \r\n    $scope.stat.events = {\r\n        total: $scope.responses.length,\r\n        range: {\r\n          min: $scope.responses[0].updatedAt,\r\n          max: $scope.responses[$scope.responses.length-1].updatedAt\r\n        },\r\n        timeline: $scope.responses.map( r => ({\r\n                        user: r.user,\r\n                        date: r.updatedAt\r\n                    }))\r\n    }; \r\n\r\n?>\r\n\r\n<?javascript\r\n\r\n    let questions = $scope.form[0].config.questions;\r\n\r\n    $scope.stat.questions = questions.map( q => ({\r\n        id: q.id,\r\n        responses: $scope.responses.map( r => {\r\n            let f = _.find(r.data, a => a.id == q.id) \r\n            return (f) ? (f.data) ? f.data : null : null\r\n        })\r\n    }))\r\n\r\n\r\n?>\r\n\r\nreturn(\"stat\")\r\n\r\n    `,\r\n\r\ngetFormList:`\r\n  <?javascript\r\n    $scope.filter = item => true;\r\n    $scope.mapper = item => ({id: item.id, metadata: item.metadata})\r\n  ?>\r\n\r\n  dml.select(from:\"form\", where:{{filter}}, map:{{mapper}})\r\n`    \r\n\r\n\r\n}\r\n\r\n\r\nexport default {\r\n\r\n  methods:{\r\n\r\n\r\n    loadFormList(){\r\n      return this.$dps.run({\r\n        script: _dps.getFormList,\r\n        state: {}\r\n      }).then(res => res.data)\r\n    },\r\n    \r\n    createForm(form) {\r\n      return this.$dps.run({\r\n        script: _dps.createForm,\r\n        state: { form: form }\r\n      }).then(res => res.data[0])\r\n\r\n    },\r\n\r\n    cloneForm(form) {\r\n      let f = Object.assign({}, form);\r\n      f.config.cloned = form.id;\r\n      f.metadata.app_url.value = location.href;\r\n      delete f.id;\r\n      delete f.updatedAt;\r\n      delete f.createdAt;\r\n      \r\n      return this.$dps.run({\r\n        script: _dps.cloneForm,\r\n        state: { form: f }\r\n      })\r\n\r\n    },\r\n\r\n    loadForm(formId) {\r\n\r\n      return this.$dps.run({\r\n        script: _dps.getForm,\r\n        state: { form: formId }\r\n      }).then(res => res.data[0])\r\n\r\n    },\r\n\r\n    updateForm(form) {\r\n\r\n      return this.$dps.run({\r\n        script: _dps.updateForm,\r\n        state: { form: form }\r\n      }).then(res => res.data[0])\r\n\r\n    },\r\n\r\n    extendForm(form) {\r\n      return this.$dps.run({\r\n        script: _dps.extendForm,\r\n        state: { form: form }\r\n      })\r\n    },\r\n\r\n    deleteForm(formId) {\r\n\r\n      return this.$dps.run({\r\n        script: _dps.deleteForm,\r\n        state: { form: formId }\r\n      })\r\n\r\n    },\r\n\r\n    exportForm(){\r\n      \r\n      let questions = this.$djvue\r\n        .selectWidgets( this.$root, widget => (widget.config) && widget.config.type == \"question-widget\" )\r\n        .map( q => {\r\n          let res = JSON.parse(JSON.stringify(q.config))\r\n          res.question.options = JSON.parse(JSON.stringify(q.$refs.instance.options))\r\n          return res\r\n        })\r\n\r\n      let a = document.createElement('a');\r\n            a.setAttribute('href', 'data:text/plain;charset=utf-u,'+encodeURIComponent(JSON.stringify(questions,null,'\\t')));\r\n            a.setAttribute('download', 'form_config.json');\r\n            a.click()  \r\n      \r\n      // this.$dps.run({\r\n      //   script: _dps.exportForm,\r\n      //   state: { form: questions }\r\n      // }).then( res => {\r\n      //   window.location.href = this.app.config.dpsURL+res.data.url\r\n      // })      \r\n\r\n\r\n    },\r\n\r\n    findUserProfile(email) {\r\n\r\n      return this.$dps.run({\r\n        script: _dps.findUserProfile,\r\n        state: { email: email }\r\n      }).then(res => res.data)\r\n\r\n    },\r\n\r\n    loadAnswer(user,formId) {\r\n      return this.$dps.run({\r\n        script: _dps.getAnswer,\r\n        state: {\r\n          user: user,\r\n          form: formId\r\n        }\r\n      }).then(res => {\r\n        if(res.data) return res.data[0]\r\n        return {\r\n          form: formId,\r\n          user: user,\r\n          data: []\r\n        }  \r\n      })\r\n    },\r\n\r\n    updateAnswer(answer) {\r\n\r\n      return this.$dps.run({\r\n        script: _dps.updateAnswer,\r\n        state: { answer: answer }\r\n      })\r\n\r\n    },\r\n\r\n    exportResponses(form_id){\r\n      return this.$dps.run({\r\n        script: _dps.exportResponses,\r\n        state: { form: form_id }\r\n      }).then( res => this.app.config.dpsURL+res.data.url )\r\n    },\r\n\r\n    sendMails(users, _template) {\r\n        let state = {}\r\n        let script = \"\";\r\n\r\n        // users\r\n        //   .forEach((u, index) => {\r\n        //     script += `sendmail({{o${index}}});\r\n        //     `\r\n        //   })\r\n\r\n        // set {{}} template delimiters \r\n        templateSettings.interpolate = /{{([\\s\\S]+?)}}/g;\r\n\r\n        users\r\n          .forEach( (u, index) => {\r\n\r\n             script += `sendmail({{o${index}}});\r\n            `\r\n            state[(\"o\"+index)] = {\r\n              to: u.email,\r\n              subject: \"DJVUE Forms Service notiification\",\r\n              html: template(_template)(u.context)\r\n            }\r\n        })\r\n\r\n        // back to default template delimiters\r\n        templateSettings.interpolate = /<%=([\\s\\S]+?)%>/g;\r\n        \r\n       \r\n    // TODO Comments 3 lines below for production mode\r\n       // return new Promise((resolve) => {\r\n       //  resolve({script:script, state:state})\r\n       // }) \r\n\r\n\r\n\r\n\r\n        return this.$dps.run({\r\n          script: script,\r\n          state: state\r\n        })\r\n\r\n      },\r\n\r\n    getStat(formId) {\r\n\r\n      return new Promise((resolve,reject) => {\r\n          this.$dps.run({\r\n            script: _dps.getStat,\r\n            state: {\r\n              form: formId\r\n            }\r\n          }).then( res => {\r\n            if(res.type == \"error\") {\r\n              reject()\r\n            } else {\r\n              resolve(res.data)\r\n            }  \r\n          })\r\n      })\r\n       \r\n    },\r\n\r\n    round( date, start, level, value) {\r\n      let defFormat = \"YYYY-MM-DD HH:mm\";\r\n    \r\n      let lo = moment(start).startOf(level).format(defFormat)\r\n      let hi = moment(lo).add(value,level).format(defFormat)\r\n      while(!(moment(date).isSameOrAfter(lo) && moment(date).isSameOrBefore(hi))){\r\n        lo = hi;\r\n        hi = moment(lo).add(value,level).format(defFormat);\r\n      }\r\n\r\n      let dLo = moment(date).diff(lo)\r\n      let dHi = -moment(date).diff(hi)\r\n      return (dLo < dHi) ? lo: hi\r\n    },\r\n\r\n    getResponseDynamic(r) {\r\n      let responses = r.events.timeline;\r\n      //responses.push({date: new Date()})\r\n\r\n      let defFormat = \"YYYY-MM-DD HH:mm\";\r\n      // let inputFormat = \"DD/MM/YY HH:mm\";\r\n\r\n\r\n      let RStat = responses\r\n          .map(item => moment(new Date(item.date)))\r\n          .sort((a,b) => a.diff(b))\r\n          .map(item => item.format(defFormat))\r\n\r\n      RStat.push(moment(new Date()).format(defFormat))  \r\n\r\n      let p = [\r\n        ['m',1],\r\n        ['m',5],\r\n        ['m',10],\r\n        ['m',15],\r\n        ['m',20],\r\n        ['m',30],\r\n        ['h',1],\r\n        ['h',2],\r\n        ['h',4],\r\n        ['h',12],\r\n        ['d',1],\r\n        ['d',3],\r\n        ['d',7],\r\n        ['M',1],\r\n        ['M',3],\r\n        ['M',6],\r\n        ['y',1],\r\n        ['y',2],\r\n        ['y',5],\r\n        ['y',10]\r\n      ]\r\n      \r\n      \r\n      let getPoints = (start, stop, level, value) => {\r\n        let res =[];\r\n        start = moment(start).add(-value,level).format(defFormat);\r\n        stop = moment(new Date()).format(defFormat);\r\n         \r\n        let lo = moment(start).startOf(level).format(defFormat)\r\n        let hi = moment(lo).add(value,level).format(defFormat)\r\n        res.push(lo)\r\n        while(!(moment(stop).isSameOrAfter(lo) && moment(stop).isSameOrBefore(hi))){\r\n          lo = hi;\r\n          hi = moment(lo).add(value,level).format(defFormat);\r\n          res.push(lo)\r\n        }\r\n        res.push(hi)\r\n        return res;      \r\n      }\r\n\r\n      \r\n\r\n      let titleFormat = {\r\n        'm' :['HH:mm',''],\r\n        'h' :['DD.MM HH:','00'],\r\n        'd' :['DD.MM',''],\r\n        'M' :['MM.YY',''],\r\n        'y' :['YYYY','']\r\n      } \r\n      \r\n      let u;\r\n      \r\n      for(u of p){\r\n        if( (moment(RStat[RStat.length-1]).diff(RStat[0],u[0]) / u[1]) <= 24) break;\r\n      }\r\n      \r\n      this.u = u;\r\n\r\n      if(moment(RStat[RStat.length-1]).diff(RStat[0],u[0])<1) return;\r\n\r\n      RStat.splice(RStat.length-1,1)\r\n      \r\n      RStat = RStat.map(\r\n        item => this.round(item,RStat[0],u[0],u[1])\r\n      );\r\n\r\n      let points = getPoints(RStat[0], RStat[RStat.length-1], u[0], u[1]);\r\n\r\n      let stats = points.map(item => RStat.filter(t => moment(t).isSame(item,u[0])).length)\r\n      let sum = stats.reduce((item,sum) => {return sum+item})\r\n      \r\n      \r\n      if(sum==0){\r\n            stats = stats.map(() => 0)\r\n          }else{\r\n            stats = stats.map(item => item)//sum )\r\n          }\r\n      \r\n      let max = stats.reduce((item,max) => {return (max>item) ? max : item})\r\n          \r\n      RStat = points.map((item,index) => {\r\n        return {\r\n          title: moment(item).format(titleFormat[u[0]][0])+titleFormat[u[0]][1],\r\n          value: stats[index],\r\n          height: (max>0) ? stats[index]/max : 0\r\n        }\r\n      })\r\n\r\n      this.points = points;\r\n      return RStat;\r\n    }\r\n\r\n  }\r\n}","import moment from \"moment\"\r\nimport { find, countBy, orderBy, uniq, union, sum, sumBy } from \"lodash\"\r\n\r\n\r\nlet round = (date, start, level, value) => {\r\n  let defFormat = \"YYYY-MM-DD HH:mm\";\r\n\r\n  let lo = moment(start).startOf(level).format(defFormat)\r\n  let hi = moment(lo).add(value, level).format(defFormat)\r\n  while (!(moment(date).isSameOrAfter(lo) && moment(date).isSameOrBefore(hi))) {\r\n    lo = hi;\r\n    hi = moment(lo).add(value, level).format(defFormat);\r\n  }\r\n\r\n  let dLo = moment(date).diff(lo)\r\n  let dHi = -moment(date).diff(hi)\r\n  return (dLo < dHi) ? lo : hi\r\n}\r\n\r\n\r\n\r\nlet eventDynamic = (timeline) => {\r\n\r\n  let defFormat = \"YYYY-MM-DD HH:mm\";\r\n  // let inputFormat = \"DD/MM/YY HH:mm\";\r\n\r\n\r\n  let RStat = timeline\r\n    .map(item => moment(new Date(item)))\r\n    .sort((a, b) => a.diff(b))\r\n    .map(item => item.format(defFormat))\r\n\r\n  RStat.push(moment(new Date()).format(defFormat))  \r\n\r\n  let p = [\r\n    ['m', 1],\r\n    ['m', 5],\r\n    ['m', 10],\r\n    ['m', 15],\r\n    ['m', 20],\r\n    ['m', 30],\r\n    ['h', 1],\r\n    ['h', 2],\r\n    ['h', 4],\r\n    ['h', 12],\r\n    ['d', 1],\r\n    ['d', 3],\r\n    ['d', 7],\r\n    ['M', 1],\r\n    ['M', 3],\r\n    ['M', 6],\r\n    ['y', 1],\r\n    ['y', 2],\r\n    ['y', 5],\r\n    ['y', 10]\r\n  ]\r\n\r\n\r\n  let getPoints = (start, stop, level, value) => {\r\n    let res = [];\r\n    start = moment(start).add(-value, level).format(defFormat)\r\n    stop = moment(stop).add(value, level).format(defFormat)\r\n\r\n    let lo = moment(start).startOf(level).format(defFormat)\r\n    let hi = moment(lo).add(value, level).format(defFormat)\r\n\r\n    res.push(lo)\r\n    while (!(moment(stop).isSameOrAfter(lo) && moment(stop).isSameOrBefore(hi))) {\r\n      lo = hi;\r\n      hi = moment(lo).add(value, level).format(defFormat);\r\n      res.push(lo)\r\n    }\r\n    res.push(hi)\r\n    return res;\r\n  }\r\n\r\n\r\n\r\n  let titleFormat = {\r\n    'm': ['HH:mm', ''],\r\n    'h': ['DD.MM HH:', '00'],\r\n    'd': ['DD.MM.YY', ''],\r\n    'M': ['MM.YYYY', ''],\r\n    'y': ['YYYY', '']\r\n  }\r\n\r\n  let u;\r\n\r\n  for (u of p) {\r\n    if ((moment(RStat[RStat.length - 1]).diff(RStat[0], u[0]) / u[1]) <= 24) break;\r\n  }\r\n\r\n\r\n  if (moment(RStat[RStat.length - 1]).diff(RStat[0], u[0]) < 1) return;\r\n\r\n  RStat.splice(RStat.length-1,1)\r\n  \r\n  RStat = RStat.map(\r\n    item => round(item, RStat[0], u[0], u[1])\r\n  );\r\n\r\n\r\n  let points = getPoints(RStat[0], RStat[RStat.length - 1], u[0], u[1]);\r\n\r\n  let stats = points.map(item => RStat.filter(t => moment(t).isSame(item, u[0])).length)\r\n\r\n  // let sum = stats.reduce((item,sum) => {return sum+item})\r\n\r\n\r\n  // if(sum==0){\r\n  //       stats = stats.map(item => 0)\r\n  //     }else{\r\n  //       stats = stats.map(item => item/sum )\r\n  //     }\r\n\r\n  // let max = stats.reduce((item,max) => {return (max>item) ? max : item})\r\n\r\n  RStat = points.map((item, index) => {\r\n    return {\r\n      title: moment(item).format(titleFormat[u[0]][0]) + titleFormat[u[0]][1],\r\n      value: stats[index],\r\n    }\r\n  })\r\n\r\n  return RStat;\r\n}\r\n\r\n\r\n\r\n\r\n\r\nexport default {\r\n  methods: {\r\n\r\n    oneOfManyStat(question, stat) {\r\n\r\n      if (!question.options.nominals) return {}\r\n\r\n      let stats = stat.responses.filter(a => a && find(question.options.nominals, n => n.id == a[0]))\r\n      let result = question.options.nominals.map(n => {\r\n        let c = countBy(stats, s => s[0])[n.id]\r\n        return {\r\n          id: n.id,\r\n          title: n.title,\r\n          value: ((c) ? c : 0) / ((stats.length == 0) ? 1 : stats.length)\r\n        }\r\n      })\r\n      let statOptions = {\r\n        color: [ this.$vuetify.theme.themes.light.primary ],\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'value',\r\n          min: 0,\r\n          max: 1.0\r\n        },\r\n        yAxis: {\r\n          type: 'category',\r\n          data: []\r\n        },\r\n        series: [{\r\n          name: '',\r\n          type: 'bar',\r\n          data: [],\r\n          itemStyle: {\r\n            opacity: 0.5\r\n          }\r\n        }]\r\n      }\r\n\r\n      statOptions.yAxis.data = result.map(r => this.truncate(r.title)).reverse()\r\n      statOptions.series[0].data = result.map(r => r.value).reverse()\r\n\r\n      return statOptions\r\n    },\r\n\r\n    manyOfManyStat(question, stat) {\r\n\r\n      if (!question.options.nominals) return {}\r\n\r\n      let s = stat.responses.filter(a => a)\r\n      let stats = []\r\n      s.forEach(item => {\r\n        stats = stats.concat(item)\r\n      })\r\n      let result = question.options.nominals.map(n => {\r\n        let c = countBy(stats)[n.id]\r\n        return {\r\n          id: n.id,\r\n          title: n.title,\r\n          value: ((c) ? c : 0) / ((stats.length == 0) ? 1 : stats.length)\r\n        }\r\n      })\r\n      let statOptions = {\r\n        color: [ this.$vuetify.theme.themes.light.primary ],\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'value',\r\n          min: 0,\r\n          max: 1.0\r\n        },\r\n        yAxis: {\r\n          type: 'category',\r\n          data: []\r\n        },\r\n        series: [{\r\n          name: '',\r\n          type: 'bar',\r\n          data: [],\r\n          itemStyle: {\r\n            opacity: 0.5\r\n          }\r\n        }]\r\n      }\r\n\r\n      statOptions.yAxis.data = result.map(r => this.truncate(r.title)).reverse()\r\n      statOptions.series[0].data = result.map(r => r.value).reverse()\r\n\r\n      return statOptions\r\n    },\r\n\r\n    rateStat(question, stat) {\r\n\r\n      let s = stat.responses.filter(a => a)\r\n      let stats = [];\r\n\r\n      s.forEach(v => {\r\n        stats = stats.concat(v)\r\n      })\r\n\r\n      let result = question.options.scale.map( n => {\r\n        let c = countBy(stats)[n.value]\r\n        return {\r\n          title: `${n.value} ${(n.title) ? ' ('+n.title+')': ''}`,\r\n          value: ((c) ? c : 0) / ((stats.length == 0) ? 1 : stats.length)\r\n        }\r\n      })\r\n      let statOptions = {\r\n        color: [ this.$vuetify.theme.themes.light.primary ],\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'value',\r\n          min: 0,\r\n          max: 1.0\r\n        },\r\n        yAxis: {\r\n          type: 'category',\r\n          data: []\r\n        },\r\n        series: [{\r\n          name: '',\r\n          type: 'bar',\r\n          data: [],\r\n          itemStyle: {\r\n            opacity: 0.5\r\n          }\r\n        }]\r\n      }\r\n\r\n      statOptions.yAxis.data = result.map(r => this.truncate(r.title)).reverse()\r\n      statOptions.series[0].data = result.map(r => r.value).reverse()\r\n\r\n      return statOptions\r\n    },\r\n\r\n    rangeStat(question, stat) {\r\n\r\n      let s = stat.responses.filter(a => a)\r\n\r\n\r\n      let stats = [];\r\n\r\n      s.forEach(v => {\r\n        stats = stats.concat(v)\r\n      })\r\n\r\n      let left = stats.map(item => item[0])\r\n      let right = stats.map(item => item[1])\r\n\r\n      let r = union(uniq(left), uniq(right)).sort((a, b) => a - b).map(item => ({ title: item }))\r\n\r\n      let result = r.map( n => {\r\n        let l = countBy(left)[n.title]\r\n        let r = countBy(right)[n.title]\r\n\r\n        return {\r\n          title: n.title,\r\n          left: ((l) ? l : 0),\r\n          right: ((r) ? r : 0)\r\n        }\r\n      })\r\n\r\n      if (result.length == 0) return {}\r\n\r\n      let statOptions = {\r\n\r\n        legend: {\r\n          data: ['Left boundary', 'Right boundary']\r\n        },\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'value',\r\n        },\r\n        yAxis: {\r\n          type: 'value'\r\n        },\r\n        series: []\r\n      }\r\n\r\n      statOptions.series.push({\r\n        name: 'Left boundary',\r\n        type: 'line',\r\n        step: 'middle',\r\n        areaStyle: {\r\n          opacity: 0.25\r\n        },\r\n        data: result.map(item => [item.title, item.left]),\r\n        markLine: {\r\n          data: [{\r\n            xAxis: (sum(left) / left.length)\r\n          }]\r\n        }\r\n      })\r\n      statOptions.series.push({\r\n        name: 'Right boundary',\r\n        type: 'line',\r\n        step: 'middle',\r\n        areaStyle: {\r\n          opacity: 0.25\r\n        },\r\n        data: result.map(item => [item.title, item.right]),\r\n        markLine: {\r\n          data: [{\r\n            xAxis: (sum(right) / right.length)\r\n          }]\r\n        }\r\n      })\r\n\r\n\r\n      return statOptions\r\n    },\r\n\r\n    dateStat(question, stat) {\r\n\r\n      let s = stat.responses.filter(a => a)\r\n      let stats = [];\r\n\r\n      s.forEach(v => {\r\n        stats = stats.concat(v)\r\n      })\r\n\r\n      let result = eventDynamic(stats);\r\n\r\n      if (!result) return {}\r\n\r\n      let statOptions = {\r\n        color: [ this.$vuetify.theme.themes.light.primary ],\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n\r\n        xAxis: {\r\n          type: 'category'\r\n        },\r\n\r\n        yAxis: {\r\n          type: 'value'\r\n        },\r\n\r\n        series: [{\r\n          name: '',\r\n          type: 'bar',\r\n          itemStyle: {\r\n            opacity: 0.5\r\n          },\r\n          data: []\r\n        }]\r\n      }\r\n\r\n      statOptions.xAxis.data = result.map(r => r.title)\r\n      statOptions.series[0].data = result.map(r => r.value)\r\n\r\n      this.height = 250;\r\n      return statOptions\r\n\r\n    },\r\n\r\n    associationStat(question, stat) {\r\n\r\n      if (!question.options.entities) return {}\r\n\r\n      let s = stat.responses.filter(a => a)\r\n\r\n      let stats = []\r\n      s.forEach(item => {\r\n        stats = stats.concat(item)\r\n      })\r\n\r\n      let r = []\r\n\r\n      question.options.entities.forEach(f => {\r\n        question.options.entities.forEach(e => {\r\n          r.push({\r\n            e1: f,\r\n            e2: e,\r\n            values: stats\r\n              .filter(s => s.e1 == f.id && s.e2 == e.id && s.value && find(question.options.scale, v => v.value == s.value))\r\n              .map(s => s.value)\r\n          })\r\n        })\r\n      })\r\n\r\n      r = r.filter(s => s.values.length > 0)\r\n\r\n      r.forEach(s => {\r\n        let c = countBy(s.values);\r\n        s.data = question.options.scale.map(v => ({\r\n          title: v.value,\r\n          value: (c[v.value]) ? c[v.value] : 0\r\n        }))\r\n      })\r\n\r\n      r.forEach(s => {\r\n        s.chartOptions = {\r\n          color: [ this.$vuetify.theme.themes.light.primary ],\r\n\r\n          angleAxis: {\r\n            type: 'category',\r\n            data: question.options.scale.map(d => d.value),\r\n            axisLabel: {\r\n              margin: 2,\r\n              fontSize: 8,\r\n              fontWeight: \"bold\",\r\n              color:  this.$vuetify.theme.themes.light.secondary\r\n            }\r\n          },\r\n          radiusAxis: {\r\n            splitNumber: 1,\r\n            axisLine: {\r\n              show: false\r\n            },\r\n            axisLabel: {\r\n              show: false\r\n            }\r\n          },\r\n          polar: {},\r\n          series: [{\r\n            type: 'bar',\r\n            itemStyle: {\r\n              opacity: 0.5\r\n            },\r\n            data: s.data.map(d => d.value),\r\n            coordinateSystem: 'polar'\r\n          }]\r\n        }\r\n      })\r\n\r\n      return r\r\n\r\n    },\r\n\r\n    influenceStat(question, stat) {\r\n\r\n      if (!question.options.effects || !question.options.factors) return {}\r\n\r\n      let s = stat.responses.filter(a => a)\r\n\r\n      let stats = []\r\n      s.forEach(item => {\r\n        stats = stats.concat(item)\r\n      })\r\n\r\n      let r = []\r\n\r\n      question.options.factors.forEach(f => {\r\n        question.options.effects.forEach(e => {\r\n          r.push({\r\n            factor: f,\r\n            effect: e,\r\n            values: stats\r\n              .filter(s => s.e1 == f.id && s.e2 == e.id && s.value && find(question.options.scale, v => v.value == s.value))\r\n              .map(s => s.value)\r\n          })\r\n        })\r\n      })\r\n\r\n      r = r.filter(s => s.values.length > 0)\r\n\r\n      r.forEach(s => {\r\n        let c = countBy(s.values);\r\n        s.data = question.options.scale.map(v => ({\r\n          title: v.value,\r\n          value: (c[v.value]) ? c[v.value] : 0\r\n        }))\r\n      })\r\n\r\n\r\n      r.forEach(s => {\r\n        s.chartOptions = {\r\n          color: [ this.$vuetify.theme.themes.light.primary ],\r\n          angleAxis: {\r\n            type: 'category',\r\n            data: question.options.scale.map(d => d.value),\r\n            axisLabel: {\r\n              margin: 2,\r\n              fontSize: 8,\r\n              fontWeight: \"bold\",\r\n              color:  this.$vuetify.theme.themes.light.secondary\r\n            }\r\n          },\r\n          radiusAxis: {\r\n            splitNumber: 1,\r\n            axisLine: {\r\n              show: false\r\n            },\r\n            axisLabel: {\r\n              show: false\r\n            }\r\n          },\r\n          polar: {},\r\n          series: [{\r\n            type: 'bar',\r\n            itemStyle: {\r\n              opacity: 0.5\r\n            },\r\n            data: s.data.map(d => d.value),\r\n            coordinateSystem: 'polar'\r\n          }]\r\n        }\r\n      })\r\n\r\n      return r\r\n\r\n\r\n    },\r\n\r\n    priorityStat(question, stat) {\r\n      if (!question.options.nominals) return {}\r\n      let stats = stat.responses.filter(a => a);\r\n\r\n      let r = [];\r\n      stats.forEach(s => {\r\n        r = r.concat(s)\r\n      })\r\n\r\n      let res = question.options.nominals.map(n => {\r\n        let data = r.filter(item => item.id == n.id);\r\n        n.data = question.options.nominals.map((t, idx) => ({\r\n          priority: (idx + 1),\r\n          value: data.filter(d => (d.priority == (idx + 1))).length / data.length\r\n        }))\r\n        n.priority = sumBy(n.data, item => item.priority * item.value)\r\n        return n\r\n      })\r\n\r\n      res = res.map(item => {\r\n        item.data = item.data.map(d => {\r\n          d.value = d.value * item.priority\r\n          return d\r\n        })\r\n        return item\r\n      })\r\n\r\n      res = orderBy(res, 'priority')\r\n      res.reverse()\r\n\r\n\r\n      let statOptions = {\r\n\r\n        legend: {\r\n          data: question.options.nominals.map((d, idx) => (idx + 1).toFixed(0))\r\n        },\r\n\r\n        grid: {\r\n          left: '3%',\r\n          right: '4%',\r\n          bottom: '3%',\r\n          containLabel: true\r\n        },\r\n\r\n        xAxis: {\r\n          type: 'value'\r\n        },\r\n\r\n        yAxis: {\r\n          type: 'category',\r\n          data: res.map(d => this.truncate(d.title))\r\n        },\r\n\r\n        series: res.map((t, idx) => ({\r\n          name: (idx + 1).toFixed(0),\r\n          type: 'bar',\r\n          stack: '1',\r\n          itemStyle: {\r\n            opacity: 0.75\r\n          },\r\n          data: res.map(d => d.data[idx].value)\r\n        }))\r\n\r\n      }\r\n\r\n      return statOptions\r\n    },\r\n\r\n\r\n\r\n    truncate(value, length) {\r\n      length = length || 50;\r\n      return (value.toString().length <= length) ?\r\n        value.toString() :\r\n        ((value.toString().length - length) > 10) ?\r\n        value.toString().substring(0, length) + '...' :\r\n        value.toString()\r\n    },\r\n\r\n\r\n    getQuestionChartOptions(question, stat) {\r\n\r\n      let statMap = {\r\n        \"One of many selection\": this.oneOfManyStat,\r\n        \"Many of many selection\": this.manyOfManyStat,\r\n        \"Range\": this.rangeStat,\r\n        \"Rate\": this.rateStat,\r\n        \"Date\": this.dateStat,\r\n        \"Association\": this.associationStat,\r\n        \"Influence\": this.influenceStat,\r\n        \"Priority\": this.priorityStat\r\n      }\r\n\r\n      let s = find(stat.questions, s => s.id == question.id)\r\n      // console.log(question)\r\n      if (!question.options) return {}\r\n      if (s && question.options.type && statMap[question.options.type]) return statMap[question.options.type](question, s)\r\n      return {}\r\n    }\r\n\r\n  }\r\n}\r\n","<template>\r\n  <div>\r\n    <v-container v-if=\"!isProductionMode\">\r\n      <v-layout align-center justify-center row fill-height>\r\n        <v-flex xs12 pa-3 justify-center>\r\n          <v-combobox v-model=\"config.form\" :items=\"formList\" label=\"Select form\" @change=\"onChangeForm\">\r\n            <template slot=\"item\" slot-scope=\"data\">\r\n              <span style=\"padding-left:1em;\" class=\"caption\">\r\n                {{data.item.id}}:\r\n                {{ (data.item.metadata.app_name) ? data.item.metadata.app_name.value : ''}}:\r\n                {{ (data.item.metadata.form_title) ? data.item.metadata.form_title.value : ''}}\r\n              </span>\r\n            </template>\r\n            <template slot=\"selection\" slot-scope=\"data\">\r\n              <span style=\"padding-left:1em;\" class=\"caption\">\r\n                {{data.item.id}}:\r\n                {{ (data.item.metadata.app_name) ? data.item.metadata.app_name.value : '' }}:\r\n                {{ (data.item.metadata.form_title) ? data.item.metadata.form_title.value : '' }}\r\n              </span>\r\n            </template>\r\n          </v-combobox>\r\n        </v-flex>\r\n      </v-layout>\r\n      <v-divider></v-divider>\r\n    </v-container>\r\n    <v-container>\r\n      <v-divider></v-divider>\r\n      <div v-if=\"formConfig\">\r\n        <div class=\"font-weight-bold primary white--text caption ma-0 pa-2\">\r\n          <p class=\"font-weight-bold mx-0 px-2\" style=\"text-align:right;  margin:0 0 2px 0;\">\r\n            JACE FORMS REPORT\r\n          </p>\r\n          <p class=\"font-weight-light mx-0 px-2\" style=\"text-align:left; margin:0 0 2px 0;\">\r\n            <b>{{translate('Last_update')}}</b> {{moment(new Date(formConfig.updatedAt)).format('YYYY-MM-DD')}}\r\n          </p>\r\n          <p class=\"font-weight-light mx-0 px-2\" style=\"text-align:left; margin:0 0 2px 0;\">\r\n            <b>{{translate('Application')}}</b> <a class=\"white--text\" :href=\"formConfig.metadata.app_url.value\" target=\"_blank\">{{formConfig.metadata.app_name.value}}</a>\r\n          </p>\r\n          <p class=\"font-weight-light mx-0 px-2\" style=\"text-align:left;  margin:0 0 2px 0;\">\r\n            <b>{{translate('Access_for')}}</b>\r\n            &nbsp;{{translate(accessMode.text)}}\r\n            &nbsp;{{ (formConfig.config.access.enabled) ? translate('Opened') : translate('Closed') }}\r\n            &nbsp;{{(formConfig.config.access.lastNotificatedAt) ? moment(new Date(formConfig.config.access.lastNotificatedAt)).fromNow() : '' }}\r\n          </p>\r\n          <p v-if=\"formStat\" class=\"font-weight-light mx-0 px-2\" style=\"text-align:left;  margin:0 0 2px 0;\">  \r\n            <b>{{translate('Respondent_activity')}}</b>\r\n            &nbsp;{{ translate('Total') }}\r\n            &nbsp;{{ formStat.events.total }}\r\n            &nbsp;{{ translate('Responses') }}\r\n            &nbsp;( {{moment(new Date(formStat.events.range.min)).format('YYYY-MM-DD HH:mm')}} -\r\n            &nbsp;{{moment(new Date(formStat.events.range.max)).format('YYYY-MM-DD HH:mm')}} )\r\n          </p>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"formStat\">\r\n        <echart :options=\"chartOptions\" height=\"250\"></echart>\r\n        <v-divider></v-divider>\r\n      </div>\r\n      <div v-if=\"formConfig\">\r\n        <div v-for=\"(q, q_index) in formConfig.config.questions\" :key=\"q_index\" class=\"mt-3\">\r\n          <h2 class=\"headline font-weight-light primary--text\">\r\n            {{q_index+1}}. {{q.options.title}} <span v-if=\"q.options.required\" class=\"caption warning--text\">({{translate('Required')}})</span>\r\n          </h2>\r\n          <p class=\"caption secondary--text font-weight-light pl-3 ma-0\">\r\n            {{q.options.note}}\r\n          </p>\r\n          <p class=\"caption primary--text pl-2 ma-0\">\r\n            {{translate('Response_type')}} {{translate(q.options.type)}}\r\n          </p>\r\n          <p v-if=\"q.options.type == 'One of many selection' || q.options.type == 'Many of many selection'\" class=\"caption secondary--text weight-light pl-3 ma-0\">\r\n            <span v-if=\"q.options.type == 'Many of many selection'\" class=\"font-weight-light\">\r\n              {{translate('Respondent_shuld_select_between')}} {{q.options.rule.min}} {{translate('And')}} {{q.options.rule.max}} {{translate('Variants')}}. </span>\r\n            <span v-if=\"q.options.addEnabled\" class=\"font-weight-light\">{{translate('Respondent_can_add_max')}} {{q.options.maxCustomResponses}} {{translate('Self_variants')}}. </span>\r\n            <span v-if=\"q.options.userCollaboration\" class=\"font-weight-light\">{{translate('Respondents_collaboration_detected')}}.</span>\r\n          </p>\r\n          <p v-if=\"q.options.type == 'Range'\" class=\"body-1 secondary--text font-weight-light pl-3 ma-0\">\r\n            {{translate('Range_between')}} {{q.options.range[0]}} {{translate('And')}} {{q.options.range[1]}} {{translate('By_step')}} {{q.options.step}}\r\n          </p>\r\n          <p v-if=\"q.options.nominals\" class=\"caption secondary--text  pl-3  pt-2 ma-0\">\r\n            <b>{{translate('Nominals')}}</b>\r\n            <ul>\r\n              <li v-for=\"(n, nIndex) in q.options.nominals\" :key=\"nIndex\">\r\n                {{n.title}}\r\n              </li>\r\n            </ul>\r\n          </p>\r\n          <p v-if=\"q.options.entities\" class=\"caption secondary--text weight-light pl-3 ma-0 pt-2\">\r\n            <b>{{translate('Entities')}}</b>\r\n            <ul>\r\n              <li v-for=\"(e, eIndex) in q.options.entities\" :key=\"eIndex\">\r\n                {{e.title}}\r\n              </li>\r\n            </ul>\r\n          </p>\r\n          <p v-if=\"q.options.factors\" class=\"caption secondary--text weight-light pl-3 ma-0 pt-2\">\r\n            <b>{{translate('Factors')}}</b>\r\n            <ul>\r\n              <li v-for=\"(f, fIndex) in q.options.factors\" :key=\"fIndex\">\r\n                {{f.title}}\r\n              </li>\r\n            </ul>\r\n          </p>\r\n          <p v-if=\"q.options.effects\" class=\"caption secondary--text weight-light pl-3 ma-0 pt-2\">\r\n            <b>{{translate('Effects')}}</b>\r\n            <ul>\r\n              <li v-for=\"(e, eIndex) in q.options.effects\" :key=\"eIndex\">\r\n                {{e.title}}\r\n              </li>\r\n            </ul>\r\n          </p>\r\n          <p v-if=\"q.options.scale\" class=\"caption secondary--text weight-light pl-3 ma-0 pt-2\">\r\n            <b>{{translate('Scale')}}</b>\r\n            <ul>\r\n              <li v-for=\"(s, sIndex) in q.options.scale\" :key=\"sIndex\">\r\n                {{s.value}} ( {{s.title}} )\r\n              </li>\r\n            </ul>\r\n          </p>\r\n          <div v-if=\"formStat\">\r\n            <div class=\"caption  secondary--text pl-3  pt-2 ma-0\">\r\n              <b>{{translate('Statistic')}}</b>\r\n            </div>\r\n            <v-card v-if=\"q.options.type=='Influence'\" flat color=\"transparent\" class=\"mt-3\">\r\n              <v-layout fill-height row>\r\n                <v-flex xs2 pa-2 class=\"text-xs-center headline\" style=\"border-left:1px solid #dedede; border-bottom:1px solid #dcdcdc;  border-top:1px solid #dcdcdc;\">\r\n                </v-flex>\r\n                <v-flex v-for=\"(e, idx) in q.options.effects\" :key=\"idx\" :class=\"`${cellClass(q)} text-xs-center`\" :style=\"`\r\n                      min-height:3em; \r\n                      border-left:1px solid #dedede; \r\n                      border-bottom:1px solid #dcdcdc;  \r\n                      border-top:1px solid #dcdcdc;\r\n                      ${ (idx == (q.options.effects.length-1)) ? 'border-right: 1px solid #dcdcdc !important;' : ''}\r\n                    `\">\r\n                  <span class=\"caption\">{{e.title}}</span>\r\n                </v-flex>\r\n              </v-layout>\r\n              <v-layout fill-height row v-for=\"(f, index1) in q.options.factors\" :key=\"index1\">\r\n                <v-flex xs2 pa-2 class=\"caption\" align-center style=\"border-left: 1px solid #dcdcdc;\r\n                    border-bottom:1px solid #dcdcdc; \">\r\n                  {{f.title}}\r\n                </v-flex>\r\n                <v-flex v-for=\"(e, index2) in q.options.effects\" :class=\"`${cellClass(q)} text-xs-center`\" :key=\"index2\" :style=\"`\r\n                    min-height:3em; \r\n                    border-left: 1px solid #dcdcdc;\r\n                    border-bottom:1px solid #dcdcdc; \r\n                    ${ (index2 < (q.options.effects.length-1)) ? '' :'border-right: 1px solid #dcdcdc !important;'}\r\n                  `\" align-center>\r\n                  <v-layout align-center style=\"height:100%;\">\r\n                    <v-flex class=\"text-xs-center body-2\">\r\n                      <echart v-if=\"getChart(q,f,e)\" :options=\"getChart(q,f,e)\" height=\"150\"></echart>\r\n                    </v-flex>\r\n                  </v-layout>\r\n                  <!-- <v-layout v-else style=\"height:100%;\"></v-layout> -->\r\n                </v-flex>\r\n              </v-layout>\r\n            </v-card>\r\n            <v-card v-if=\"q.options.type=='Association'\" flat color=\"transparent\" class=\"mt-3\">\r\n              <v-layout fill-height row>\r\n                <v-flex xs2 pa-2 class=\"text-xs-center headline\" style=\"border-left:1px solid #dedede; border-bottom:1px solid #dcdcdc;  border-top:1px solid #dcdcdc;\">\r\n                </v-flex>\r\n                <v-flex v-for=\"(e, idx) in q.options.entities\" :class=\"`${cellClass(q)} text-xs-center`\" :key=\"idx\" :style=\"`\r\n                      min-height:3em; \r\n                      border-left:1px solid #dedede; \r\n                      border-bottom:1px solid #dcdcdc;  \r\n                      border-top:1px solid #dcdcdc;\r\n                      ${ (idx == (q.options.entities.length-1)) ? 'border-right: 1px solid #dcdcdc !important;' : ''}\r\n                    `\">\r\n                  <span class=\"caption\">{{e.title}}</span>\r\n                </v-flex>\r\n              </v-layout>\r\n              <v-layout fill-height row v-for=\"(f, index1) in q.options.entities\" :key=\"index1\">\r\n                <v-flex xs2 pa-2 class=\"caption\" align-center style=\"border-left: 1px solid #dcdcdc;\r\n                    border-bottom:1px solid #dcdcdc; \">\r\n                  {{f.title}}\r\n                </v-flex>\r\n                <v-flex v-for=\"(e, index2) in q.options.entities\" :key=\"index2\" :class=\"`${cellClass(q)} text-xs-center`\" :style=\"`\r\n                    min-height:3em; \r\n                    border-left: 1px solid #dcdcdc;\r\n                    border-bottom:1px solid #dcdcdc; \r\n                    ${ (index2 < (q.options.entities.length-1)) ? '' :'border-right: 1px solid #dcdcdc !important;'}\r\n                  `\" align-center>\r\n                  <v-layout v-if=\"index2 > index1\" align-center style=\"height:100%;\">\r\n                    <v-flex class=\"text-xs-center body-2\">\r\n                      <echart v-if=\"getChart(q,f,e)\" :options=\"getChart(q,f,e)\" height=\"150\"></echart>\r\n                    </v-flex>\r\n                  </v-layout>\r\n                  <v-layout v-else style=\"height:100%;\"></v-layout>\r\n                </v-flex>\r\n              </v-layout>\r\n            </v-card>\r\n            <echart v-if=\"q.options.type != 'Association' && q.options.type != 'Influence'\" :options=\"q.chartOptions\" height=\"250\"></echart>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </v-container>\r\n    <!-- <pre class=\"caption primary\">\r\n      {{JSON.stringify(formConfig, null,\"\\t\")}}\r\n    </pre>\r\n    <pre class=\"caption secondary\">\r\n      {{JSON.stringify(formStat, null,\"\\t\")}}\r\n    </pre> -->\r\n  </div>\r\n</template>\r\n<script>\r\nimport djvueMixin from \"@/mixins/core/djvue.mixin.js\";\r\nimport listenerMixin from \"@/mixins/core/listener.mixin.js\";\r\nimport i18nMixin from \"@/mixins/core/widget-i18n.mixin.js\"\r\nimport ioMixin from \"./mixins/io.mixin.js\"\r\nimport statMixin from \"./mixins/stat.mixin.js\"\r\nimport echart from \"@/components/core/ext/echart.vue\"\r\nimport { find, isNumber, max } from \"lodash\"\r\nimport moment from \"moment\"\r\n\r\nexport default {\r\n\r\n  name: \"form-report-widget\",\r\n\r\n  icon: \"mdi-view-dashboard-outline\",\r\n\r\n  mixins: [djvueMixin, listenerMixin, i18nMixin, ioMixin, statMixin],\r\n\r\n  components: { echart },\r\n\r\n  computed: {\r\n\r\n    accessMode() {\r\n      return {\r\n        \"any\": { icon: \"mdi-account\", text: \"Any_respondents\" },\r\n        \"users\": { icon: \"mdi-account-key\", text: \"Logged_user\" },\r\n        \"invited\": { icon: \"mdi-account-star\", text: \"Invited_respondents\" }\r\n      } [this.formConfig.config.access.type]\r\n    }\r\n\r\n  },\r\n\r\n  methods: {\r\n\r\n    getChart(question, e1, e2) {\r\n      let f = (question.options.type == \"Influence\") ?\r\n        find(question.chartOptions, s => s.factor.id == e1.id && s.effect.id == e2.id) :\r\n        find(question.chartOptions, s => s.e1.id == e1.id && s.e2.id == e2.id)\r\n      if (f) return f.chartOptions\r\n      return null\r\n    },\r\n\r\n    cellClass(question) {\r\n      let width = (question.options.type == \"Influence\") ?\r\n        Math.trunc(10 / question.options.effects.length) :\r\n        Math.trunc(10 / question.options.entities.length)\r\n      width = (width > 3) ? 3 : width;\r\n      return `xs${width}`\r\n    },\r\n\r\n\r\n\r\n    onPageStart() {\r\n      if (this.config.form) {\r\n        this.loadReport(this.config.form)\r\n      }\r\n    },\r\n\r\n    loadReport(form) {\r\n      this.loadForm(form.id)\r\n        .then(res => {\r\n          this.formConfig = res;\r\n          let locale = this.formConfig.config.locale || \"en\";\r\n          this.setLocale(locale);\r\n          this.getStat(form.id)\r\n            .then(res => {\r\n              this.formStat = res\r\n              this.getChartOptions()\r\n              this.formConfig.config.questions.forEach(q => {\r\n                q.chartOptions = this.getQuestionChartOptions(q, this.formStat)\r\n              })\r\n            })\r\n        })\r\n    },\r\n\r\n    onChangeForm(form) {\r\n      this.loadReport(form);\r\n      this.setNeedSave(true)\r\n    },\r\n\r\n    getChartOptions() {\r\n      let d = this.getResponseDynamic(this.formStat)\r\n      // let d = this.getResponseDynamic(this.stat)\r\n\r\n          let maxResponses = max(d.map(r => r.value))\r\n          this.chartOptions = {\r\n            redraw: false,\r\n\r\n            tooltip: {\r\n              position: 'top',\r\n              formatter: d => {\r\n                let x = d.data[0];\r\n                let y = d.data[1];\r\n\r\n                x = (isNumber(x)) ? x.toFixed(2) : x;\r\n                // y = (_.isNumber(y)) ? y.toFixed(2) : y;\r\n                y = Math.round(y * maxResponses) + \" resp.\"\r\n                return x + \", \" + y\r\n              }\r\n            },\r\n\r\n            title: [{\r\n              top: 5,\r\n              textBaseline: 'middle',\r\n              text: \"Pulse\",\r\n              textStyle: {\r\n                fontSize: 12,\r\n                fontWeight: \"normal\"\r\n              }\r\n            }],\r\n\r\n            color: [this.$vuetify.theme.themes.light.primary],\r\n\r\n            singleAxis: [{\r\n              left: 150,\r\n              top: '5%',\r\n              height: '80%',\r\n              type: 'category',\r\n              boundaryGap: false,\r\n              data: d.map(item => item.title),\r\n              axisLabel: {\r\n                interval: 2\r\n              },\r\n              axisLine: {\r\n                show: true,\r\n                lineStyle: {\r\n                  width: 0.5\r\n                }\r\n              },\r\n              axisTick: {\r\n                show: false\r\n              }\r\n            }],\r\n            series: [{\r\n              singleAxisIndex: 0,\r\n              coordinateSystem: 'singleAxis',\r\n              type: 'scatter',\r\n              data: d.map(item => [item.title, item.height]),\r\n              symbolSize: function(dataItem) {\r\n                return dataItem[1] * 80 + 3;\r\n              },\r\n              itemStyle: {\r\n                opacity: 0.5\r\n              }\r\n            }]\r\n          }\r\n\r\n      // this.chartOptions = {\r\n\r\n      //   grid: {\r\n      //     left: '3%',\r\n      //     right: '4%',\r\n      //     bottom: '3%',\r\n      //     containLabel: true\r\n      //   },\r\n\r\n      //   color: [ this.$vuetify.theme.themes.light.primary ],\r\n\r\n      //   xAxis: [{\r\n      //     type: 'category',\r\n      //     data: d.map(item => item.title),\r\n      //     axisTick: {\r\n      //       alignWithLabel: true\r\n      //     }\r\n      //   }],\r\n      //   yAxis: [{\r\n      //     type: 'value'\r\n      //   }],\r\n\r\n      //   series: [{\r\n      //     type: 'line',\r\n      //     showSymbol: true,\r\n      //     step: \"middle\",\r\n      //     data: d.map(item => item.value),\r\n      //     areaStyle: {\r\n      //       opacity: 0.25\r\n      //     }\r\n      //   }]\r\n      // }\r\n    }\r\n\r\n\r\n\r\n  },\r\n\r\n\r\n\r\n\r\n  props: [\"config\"],\r\n\r\n  watch: {},\r\n\r\n\r\n  created() {\r\n    this.loadFormList().then(res => this.formList = res)\r\n  },\r\n\r\n  mounted() { this.$emit(\"init\") },\r\n\r\n  data: () => ({\r\n    formList: [],\r\n    formConfig: null,\r\n    formStat: null,\r\n    moment,\r\n    Date,\r\n    chartOptions: {},\r\n    i18n: {\r\n      en: {\r\n        \"Last_update\": \"Last update:\",\r\n        \"Application\": \"Application:\",\r\n        \"Access_for\": \"Access for:\",\r\n        \"Any_respondents\": \"Any respondents\",\r\n        \"Logged_user\": \"Logged user\",\r\n        \"Invited_respondents\": \"Invited respondents\",\r\n        \"Opened\": \"was opened\",\r\n        \"Closed\": \"was closed\",\r\n        \"Question\": \"Question\",\r\n        \"Required\": \"required\",\r\n        \"Responses\": \"Responses\",\r\n        \"Respondent_activity\": \"Respondent activity:\",\r\n        \"Total\": \"Total\",\r\n        \"Response_type\": \"Response type:\",\r\n        \"One of many selection\": \"one of many selection\",\r\n        \"Many of many selection\": \"many of many selection\",\r\n        \"Rate\": \"rate\",\r\n        \"Range\": \"range\",\r\n        \"Date\": \"date\",\r\n        \"Association\": \"association\",\r\n        \"Influence\": \"influence\",\r\n        \"Statistic\": \"Statistic\",\r\n        \"Entities\": \"Entities:\",\r\n        \"Factors\": \"Factors:\",\r\n        \"Effects\": \"Effects:\",\r\n        \"Scale\": \"Scale:\",\r\n        \"Nominals\": \"Alternatives:\",\r\n\r\n        \"Respondent_can_add_max\": \"Respondent can add max\",\r\n        \"Self_variants\": \"self variants\",\r\n        \"Respondents_collaboration_detected\": \"Respondents collaboration detected\",\r\n        \"Respondent_shuld_select_between\": \"Respondent shuld select between\",\r\n        \"And\": \"and\",\r\n        \"Variants\": \"variants\",\r\n        \"Range_between\": \"Range between\",\r\n        \"By_step\": \"by step\",\r\n        \"Priority\": \"priority\"\r\n\r\n\r\n      },\r\n      uk: {\r\n        \"Last_update\": \"Останнє оновлення:\",\r\n        \"Application\": \"Застосунок:\",\r\n        \"Access_for\": \"Доступ для:\",\r\n        \"Any_respondents\": \"будь-кого\",\r\n        \"Logged_user\": \"зареєстрованих користувачів\",\r\n        \"Invited_respondents\": \"запрошених респондентів\",\r\n        \"Opened\": \"було відкрито\",\r\n        \"Closed\": \"було закрито\",\r\n        \"Question\": \"Запитання\",\r\n        \"Required\": \"обов'язкове\",\r\n        \"Responses\": \"відповідей\",\r\n        \"Respondent_activity\": \"Активність респондентів:\",\r\n        \"Total\": \"Загалом\",\r\n        \"Response_type\": \"Тип відповіді:\",\r\n        \"One of many selection\": \"вибір одного з багатьох варіантів\",\r\n        \"Many of many selection\": \"вибір багатьох з багатьох варіантів\",\r\n        \"Rate\": \"визначення рейтингу\",\r\n        \"Range\": \"визначення діапазону\",\r\n        \"Date\": \"визначення дати\",\r\n        \"Association\": \"оцінювання зв'язків\",\r\n        \"Influence\": \"оцінювання впливів\",\r\n        \"Statistic\": \"Статистика\",\r\n        \"Entities\": \"Сутності:\",\r\n        \"Factors\": \"Фактори:\",\r\n        \"Effects\": \"Ефекти:\",\r\n        \"Scale\": \"Шкала:\",\r\n        \"Nominals\": \"Варіанти:\",\r\n        \"Respondent_can_add_max\": \"Респондент може додати максимум\",\r\n        \"Self_variants\": \"власних варіантів\",\r\n        \"Respondents_collaboration_detected\": \"Респонденти можуть взаємодіяти\",\r\n        \"Respondent_shuld_select_between\": \"Респондент має обрати від\",\r\n        \"And\": \"до\",\r\n        \"Variants\": \"варіантів\",\r\n        \"Range_between\": \"Діапазон від\",\r\n        \"By_step\": \"з кроком\",\r\n        \"Priority\": \"визначення пріоритетів\"\r\n\r\n\r\n      }\r\n    }\r\n  })\r\n\r\n}\r\n\r\n</script>\r\n","import mod from \"-!../../../../build/vuetify-loader/lib/loader.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../build/jace-loader/src/parser.js??ref--20-3!../../../../build/jace-loader/src/parser.js??ref--18-1!../../../../build/jace-loader/src/parser.js??ref--33-1!./form-report.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../build/vuetify-loader/lib/loader.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../build/jace-loader/src/parser.js??ref--20-3!../../../../build/jace-loader/src/parser.js??ref--18-1!../../../../build/jace-loader/src/parser.js??ref--33-1!./form-report.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./form-report.vue?vue&type=template&id=36409e0c&\"\nimport script from \"./form-report.vue?vue&type=script&lang=js&\"\nexport * from \"./form-report.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../build/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCombobox } from 'vuetify/lib/components/VCombobox';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VFlex } from 'vuetify/lib/components/VGrid';\nimport { VLayout } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VCard,VCombobox,VContainer,VDivider,VFlex,VLayout})\n","// Styles\nimport \"../../../src/components/VAutocomplete/VAutocomplete.sass\"; // Extensions\n\nimport VSelect from '../VSelect/VSelect';\nimport VAutocomplete from '../VAutocomplete/VAutocomplete'; // Utils\n\nimport { keyCodes } from '../../util/helpers';\n/* @vue/component */\n\nexport default VAutocomplete.extend({\n  name: 'v-combobox',\n  props: {\n    delimiters: {\n      type: Array,\n      default: () => []\n    },\n    returnObject: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data: () => ({\n    editingIndex: -1\n  }),\n  computed: {\n    computedCounterValue() {\n      return this.multiple ? this.selectedItems.length : (this.internalSearch || '').toString().length;\n    },\n\n    hasSlot() {\n      return VSelect.options.computed.hasSlot.call(this) || this.multiple;\n    },\n\n    isAnyValueAllowed() {\n      return true;\n    },\n\n    menuCanShow() {\n      if (!this.isFocused) return false;\n      return this.hasDisplayedItems || !!this.$slots['no-data'] && !this.hideNoData;\n    },\n\n    searchIsDirty() {\n      return this.internalSearch != null;\n    }\n\n  },\n  methods: {\n    onInternalSearchChanged(val) {\n      if (val && this.multiple && this.delimiters.length) {\n        const delimiter = this.delimiters.find(d => val.endsWith(d));\n\n        if (delimiter != null) {\n          this.internalSearch = val.slice(0, val.length - delimiter.length);\n          this.updateTags();\n        }\n      }\n\n      this.updateMenuDimensions();\n    },\n\n    genInput() {\n      const input = VAutocomplete.options.methods.genInput.call(this);\n      delete input.data.attrs.name;\n      input.data.on.paste = this.onPaste;\n      return input;\n    },\n\n    genChipSelection(item, index) {\n      const chip = VSelect.options.methods.genChipSelection.call(this, item, index); // Allow user to update an existing value\n\n      if (this.multiple) {\n        chip.componentOptions.listeners = { ...chip.componentOptions.listeners,\n          dblclick: () => {\n            this.editingIndex = index;\n            this.internalSearch = this.getText(item);\n            this.selectedIndex = -1;\n          }\n        };\n      }\n\n      return chip;\n    },\n\n    onChipInput(item) {\n      VSelect.options.methods.onChipInput.call(this, item);\n      this.editingIndex = -1;\n    },\n\n    // Requires a manual definition\n    // to overwrite removal in v-autocomplete\n    onEnterDown(e) {\n      e.preventDefault(); // If has menu index, let v-select-list handle\n\n      if (this.getMenuIndex() > -1) return;\n      this.$nextTick(this.updateSelf);\n    },\n\n    onKeyDown(e) {\n      const keyCode = e.keyCode;\n\n      if (e.ctrlKey || ![keyCodes.home, keyCodes.end].includes(keyCode)) {\n        VSelect.options.methods.onKeyDown.call(this, e);\n      } // If user is at selection index of 0\n      // create a new tag\n\n\n      if (this.multiple && keyCode === keyCodes.left && this.$refs.input.selectionStart === 0) {\n        this.updateSelf();\n      } else if (keyCode === keyCodes.enter) {\n        this.onEnterDown(e);\n      } // The ordering is important here\n      // allows new value to be updated\n      // and then moves the index to the\n      // proper location\n\n\n      this.changeSelectedIndex(keyCode);\n    },\n\n    onTabDown(e) {\n      // When adding tags, if searching and\n      // there is not a filtered options,\n      // add the value to the tags list\n      if (this.multiple && this.internalSearch && this.getMenuIndex() === -1) {\n        e.preventDefault();\n        e.stopPropagation();\n        return this.updateTags();\n      }\n\n      VAutocomplete.options.methods.onTabDown.call(this, e);\n    },\n\n    selectItem(item) {\n      // Currently only supports items:<string[]>\n      if (this.editingIndex > -1) {\n        this.updateEditing();\n      } else {\n        VAutocomplete.options.methods.selectItem.call(this, item); // if selected item contains search value,\n        // remove the search string\n\n        if (this.internalSearch && this.multiple && this.getText(item).toLocaleLowerCase().includes(this.internalSearch.toLocaleLowerCase())) {\n          this.internalSearch = null;\n        }\n      }\n    },\n\n    setSelectedItems() {\n      if (this.internalValue == null || this.internalValue === '') {\n        this.selectedItems = [];\n      } else {\n        this.selectedItems = this.multiple ? this.internalValue : [this.internalValue];\n      }\n    },\n\n    setValue(value) {\n      VSelect.options.methods.setValue.call(this, value === undefined ? this.internalSearch : value);\n    },\n\n    updateEditing() {\n      const value = this.internalValue.slice();\n      const index = this.selectedItems.findIndex(item => this.getText(item) === this.internalSearch); // If user enters a duplicate text on chip edit,\n      // don't add it, move it to the end of the list\n\n      if (index > -1) {\n        const item = typeof value[index] === 'object' ? Object.assign({}, value[index]) : value[index];\n        value.splice(index, 1);\n        value.push(item);\n      } else {\n        value[this.editingIndex] = this.internalSearch;\n      }\n\n      this.setValue(value);\n      this.editingIndex = -1;\n      this.internalSearch = null;\n    },\n\n    updateCombobox() {\n      // If search is not dirty, do nothing\n      if (!this.searchIsDirty) return; // The internal search is not matching\n      // the internal value, update the input\n\n      if (this.internalSearch !== this.getText(this.internalValue)) this.setValue(); // Reset search if using slot to avoid a double input\n\n      const isUsingSlot = Boolean(this.$scopedSlots.selection) || this.hasChips;\n      if (isUsingSlot) this.internalSearch = null;\n    },\n\n    updateSelf() {\n      this.multiple ? this.updateTags() : this.updateCombobox();\n    },\n\n    updateTags() {\n      const menuIndex = this.getMenuIndex(); // If the user is not searching\n      // and no menu item is selected\n      // or if the search is empty\n      // do nothing\n\n      if (menuIndex < 0 && !this.searchIsDirty || !this.internalSearch) return;\n\n      if (this.editingIndex > -1) {\n        return this.updateEditing();\n      }\n\n      const index = this.selectedItems.findIndex(item => this.internalSearch === this.getText(item)); // If the duplicate item is an object,\n      // copy it, so that it can be added again later\n\n      const itemToSelect = index > -1 && typeof this.selectedItems[index] === 'object' ? Object.assign({}, this.selectedItems[index]) : this.internalSearch; // If it already exists, do nothing\n      // this might need to change to bring\n      // the duplicated item to the last entered\n\n      if (index > -1) {\n        const internalValue = this.internalValue.slice();\n        internalValue.splice(index, 1);\n        this.setValue(internalValue);\n      } // If menu index is greater than 1\n      // the selection is handled elsewhere\n      // TODO: find out where\n\n\n      if (menuIndex > -1) return this.internalSearch = null;\n      this.selectItem(itemToSelect);\n      this.internalSearch = null;\n    },\n\n    onPaste(event) {\n      var _a;\n\n      this.$emit('paste', event);\n      if (!this.multiple || this.searchIsDirty) return;\n      const pastedItemText = (_a = event.clipboardData) === null || _a === void 0 ? void 0 : _a.getData('text/vnd.vuetify.autocomplete.item+plain');\n\n      if (pastedItemText && this.findExistingIndex(pastedItemText) === -1) {\n        event.preventDefault();\n        VSelect.options.methods.selectItem.call(this, pastedItemText);\n      }\n    },\n\n    clearableCallback() {\n      this.editingIndex = -1;\n      VAutocomplete.options.methods.clearableCallback.call(this);\n    }\n\n  }\n});\n//# sourceMappingURL=VCombobox.js.map","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../build/vuetify-loader/lib/loader.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../build/jace-loader/src/parser.js??ref--20-3!../../../../build/jace-loader/src/parser.js??ref--33-1!./echart.vue?vue&type=style&index=0&id=7d96c1a5&prod&scoped=true&lang=css&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"echart\",style:(_vm.style)})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"echart\" :style=\"style\"></div>\r\n</template>\r\n<script>\r\n\r\nimport * as echarts from 'echarts'\r\n\r\n// import echarts from \"echarts/dist/echarts.esm\"//\"echarts/dist/echarts-en\"\r\n\r\n// import registerWordCloud from \"@/modules/echarts-wordcloud\"\r\n// registerWordCloud(echarts)\r\n\r\nimport listenerMixin from \"@/mixins/core/listener.mixin.js\"\r\n\r\nexport default {\r\n\r\n  name: \"echart\",\r\n\r\n  mixins: [listenerMixin],\r\n\r\n  computed: {\r\n    style() {\r\n      return {\r\n        height: (this.height || 250) + \"px\"\r\n      }\r\n    }\r\n  },\r\n\r\n  methods:{\r\n\r\n    initChart(options){\r\n      \r\n      this.chart = echarts.init(this.$el, null, { height: this.height,  width: \"auto\" })\r\n      \r\n      this.resizeHandler = () => {\r\n        this.width = this.$el.clientWidth\r\n        this.chart.resize()\r\n      }  \r\n\r\n      if (window.attachEvent) {\r\n        window.attachEvent('onresize', this.resizeHandler);\r\n      } else {\r\n        window.addEventListener('resize', this.resizeHandler);\r\n      }\r\n\r\n      if (options) {\r\n       setTimeout(()=>{\r\n          this.chart.setOption(options)\r\n          this.chart.on('click', params => { \r\n            // console.log(\"echart component\", params)\r\n            this.$emit(\"chart-event\", params)\r\n          })\r\n\r\n        },10)  \r\n      }\r\n\r\n      this.on({\r\n        event: \"slide-start\",\r\n        callback: () => {\r\n          // console.log(this._uid, \"SLIDE START\",this.$el.clientWidth)\r\n         setTimeout(()=>{\r\n         // this.$nextTick(()=>{ \r\n            // console.log(\"Slide start\",this._uid)\r\n            // if(!this.chart && this.$el.clientWidth > 0){\r\n            //   this.initChart(this.options)\r\n            //   return\r\n            //   console.log(\"Create chart\", _uid)\r\n            //   // this.chart = echarts.init(this.$el, null, { height: this.height,  width: \"auto\" })\r\n\r\n            // }\r\n            if (this.chart && this.options)\r\n              // console.log(\"Slide start\", this._uid, this.options) \r\n              this.chart.setOption(this.options, true)\r\n              this.chart.resize()\r\n              // console.log(this._uid, \"RESIZE\",this.$el.clientWidth)\r\n          }, 10)   \r\n        },\r\n        rule: () => true\r\n      })\r\n\r\n     this.on({\r\n        event: \"update-dialog-view\",\r\n        callback: () => {\r\n          // console.log(this._uid, \"UPDATE-DIALOG-VIEW\")\r\n         setTimeout(()=>{\r\n         // this.$nextTick(()=>{ \r\n            // console.log(\"Slide start\",this._uid)\r\n            // if(!this.chart && this.$el.clientWidth > 0){\r\n            //   this.initChart(this.options)\r\n            //   return\r\n            //   console.log(\"Create chart\", _uid)\r\n            //   // this.chart = echarts.init(this.$el, null, { height: this.height,  width: \"auto\" })\r\n\r\n            // }\r\n            if (this.chart && this.options)\r\n              // console.log(\"Slide start\", this._uid, this.options) \r\n              this.chart.setOption(this.options, true)\r\n              this.chart.resize()\r\n              // console.log(this._uid, \"RESIZE\",this.$el.clientWidth)\r\n          }, 10)   \r\n        },\r\n        rule: () => true\r\n      })\r\n\r\n    }\r\n  },\r\n\r\n\r\n  props: [\"options\", \"height\"],\r\n\r\n  watch: {\r\n    options: {\r\n      handler: function(value) {\r\n\r\n        if (value) {\r\n          // // this.$nextTick(() => {\r\n          // if(!this.chart && this.$el.clientWidth > 0){\r\n          //   this.initChart()\r\n          //   return\r\n          //   // console.log(\"Create chart\")\r\n          //   // this.chart = echarts.init(this.$el, null, { height: this.height,  width: \"auto\" })\r\n          // }\r\n          if (this.chart) {\r\n            setTimeout(()=>{\r\n              // console.log(\"set options\", this._uid, value)\r\n              this.chart.setOption(value, true)\r\n              this.chart.resize()\r\n            },10)\r\n            // this.chart.resize()\r\n          }  \r\n        // })\r\n        }\r\n      },\r\n      deep: true\r\n    },\r\n\r\n   \r\n    height(value) {\r\n      // this.$nextTick(() => {\r\n     // if(!this.chart && this.$el.clientWidth > 0){\r\n     //    this.initChart()\r\n     //    return\r\n     //    // console.log(\"Create chart\")\r\n     //    // this.chart = echarts.init(this.$el, null, { height: this.height,  width: \"auto\" })\r\n     //  }\r\n      setTimeout(()=>{\r\n        this.chart.resize({\r\n          height: value\r\n        },10)\r\n      })\r\n      \r\n      // })\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n\r\n    // console.log(\"MOUNTED\", this)\r\n    \r\n    // if( this.$el.clientWidth > 0 ) {\r\n      this.initChart(this.options)  \r\n      // this.chart = echarts.init(this.$el, null, { height: this.height,  width: \"auto\" })\r\n      \r\n      // this.resizeHandler = () => {\r\n      //   this.width = this.$el.clientWidth\r\n      //   this.chart.resize()\r\n      // }  \r\n\r\n      // if (window.attachEvent) {\r\n      //   window.attachEvent('onresize', this.resizeHandler);\r\n      // } else {\r\n      //   window.addEventListener('resize', this.resizeHandler);\r\n      // }\r\n\r\n      // if (this.options) {\r\n      //   this.chart.setOption(this.options)\r\n      // }\r\n\r\n      // this.on({\r\n      //   event: \"slide-start\",\r\n      //   callback: () => {\r\n      //     // console.log(this._uid, \"SLIDE START\",this.$el.clientWidth)\r\n      //    setTimeout(()=>{\r\n      //    // this.$nextTick(()=>{ \r\n      //       // console.log(\"Slide start\",this.$el.clientWidth)\r\n      //       if(!this.chart && this.$el.clientWidth > 0){\r\n      //         // console.log(\"Create chart\")\r\n      //         this.chart = echarts.init(this.$el, null, { height: this.height,  width: \"auto\" })\r\n\r\n      //       }\r\n      //       if (this.chart && this.options) \r\n      //           this.chart.setOption(value, true)\r\n      //         // this.chart.resize()\r\n      //         // console.log(this._uid, \"RESIZE\",this.$el.clientWidth)\r\n      //     }, 10)   \r\n      //   },\r\n      //   rule: () => true\r\n      // })\r\n    // }  \r\n\r\n  },\r\n\r\n  beforeDestroy() {\r\n    if (window.attachEvent) {\r\n      window.detachEvent('onresize', this.resizeHandler);\r\n    } else {\r\n      window.removeEventListener('resize', this.resizeHandler, false);\r\n    }\r\n    this.off()\r\n  },\r\n\r\n\r\n  data: () => ({\r\n    chart: null,\r\n    resizeHandler: null\r\n  })\r\n}\r\n\r\n</script>\r\n<style scoped>\r\n.echart {\r\n  width: 100% !important;\r\n}\r\n\r\n</style>\r\n","import mod from \"-!../../../../build/vuetify-loader/lib/loader.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../build/jace-loader/src/parser.js??ref--20-3!../../../../build/jace-loader/src/parser.js??ref--18-1!../../../../build/jace-loader/src/parser.js??ref--33-1!./echart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../build/vuetify-loader/lib/loader.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../build/jace-loader/src/parser.js??ref--20-3!../../../../build/jace-loader/src/parser.js??ref--18-1!../../../../build/jace-loader/src/parser.js??ref--33-1!./echart.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./echart.vue?vue&type=template&id=7d96c1a5&scoped=true&\"\nimport script from \"./echart.vue?vue&type=script&lang=js&\"\nexport * from \"./echart.vue?vue&type=script&lang=js&\"\nimport style0 from \"./echart.vue?vue&type=style&index=0&id=7d96c1a5&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7d96c1a5\",\n  null\n  \n)\n\nexport default component.exports","import { mapKeys } from \"lodash\"\r\n\r\nexport default {\r\n  methods: {\r\n    translate(key) {\r\n      return this.$t(`${this.id}_${key}`)\r\n    },\r\n\r\n    _initI18n() {\r\n      if (!this.i18n) return;\r\n\r\n      this.$i18n_id = this.$djvue.randomName()\r\n\r\n      let messages = {\r\n        en: mapKeys(this.i18n.en, (value, key) => `${this.id}_${key}`),\r\n        uk: mapKeys(this.i18n.uk, (value, key) => `${this.id}_${key}`)\r\n      };\r\n\r\n      this.$i18n.mergeLocaleMessage(\"en\", messages.en);\r\n      this.$i18n.mergeLocaleMessage(\"uk\", messages.uk);\r\n\r\n    },\r\n\r\n    _destroyI18n() {\r\n      // if(!this.i18n) return\r\n\r\n      // let messages = {\r\n      // \ten:  this.$i18n.getLocaleMessage(\"en\"),\r\n      // \tuk:  this.$i18n.getLocaleMessage(\"uk\")\r\n      // };\r\n\r\n      // messages.en = _.pick(messages.en, _.keys(messages.en).filter((key => !key.startsWith(this.id))))\r\n      // messages.uk = _.pick(messages.uk, _.keys(messages.uk).filter((key => !key.startsWith(this.id))))\r\n\r\n      // this.$i18n.setLocaleMessage(\"en\", messages.en);\r\n      //    \t\tthis.$i18n.setLocaleMessage(\"uk\", messages.uk);\r\n      //    \t\tthis.app.config.i18n = messages \r\n\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this._initI18n()\r\n  },\r\n\r\n  beforeDestroy() {\r\n    this._destroyI18n()\r\n  }\r\n}\r\n","import \"../../../src/components/VGrid/_grid.sass\";\nimport \"../../../src/components/VGrid/VGrid.sass\";\nimport Grid from './grid';\nimport mergeData from '../../util/mergeData';\n/* @vue/component */\n\nexport default Grid('container').extend({\n  name: 'v-container',\n  functional: true,\n  props: {\n    id: String,\n    tag: {\n      type: String,\n      default: 'div'\n    },\n    fluid: {\n      type: Boolean,\n      default: false\n    }\n  },\n\n  render(h, {\n    props,\n    data,\n    children\n  }) {\n    let classes;\n    const {\n      attrs\n    } = data;\n\n    if (attrs) {\n      // reset attrs to extract utility clases like pa-3\n      data.attrs = {};\n      classes = Object.keys(attrs).filter(key => {\n        // TODO: Remove once resolved\n        // https://github.com/vuejs/vue/issues/7841\n        if (key === 'slot') return false;\n        const value = attrs[key]; // add back data attributes like data-test=\"foo\" but do not\n        // add them as classes\n\n        if (key.startsWith('data-')) {\n          data.attrs[key] = value;\n          return false;\n        }\n\n        return value || typeof value === 'string';\n      });\n    }\n\n    if (props.id) {\n      data.domProps = data.domProps || {};\n      data.domProps.id = props.id;\n    }\n\n    return h(props.tag, mergeData(data, {\n      staticClass: 'container',\n      class: Array({\n        'container--fluid': props.fluid\n      }).concat(classes || [])\n    }), children);\n  }\n\n});\n//# sourceMappingURL=VContainer.js.map"],"sourceRoot":""}