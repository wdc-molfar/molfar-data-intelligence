{"version":3,"sources":["webpack:///./src/components/core/ext/nlp/sentence-extractor/src/raw_tokenizer_uk.js","webpack:///./src/components/core/ext/nlp/sentence-extractor/src/scanner.js","webpack:///./src/components/core/ext/nlp/sentence-extractor/src/parser.js","webpack:///./src/components/core/ext/nlp/sentence-extractor/src/rules.js","webpack:///./src/components/core/ext/nlp/sentence-extractor/src/grammar.js","webpack:///./src/components/core/ext/nlp/sentence-extractor/src/lexer.js","webpack:///./src/components/core/ext/nlp/utils.js","webpack:///./node_modules/@netilon/differify/index.js","webpack:///./src/components/core/ext/nlp/annotator.vue?ebdb","webpack:///./src/components/core/ext/nlp/tom.vue?b2c0","webpack:///src/components/core/ext/nlp/tom.vue","webpack:///./src/components/core/ext/nlp/tom.vue?d74a","webpack:///./src/components/core/ext/nlp/tom.vue?ec40","webpack:///src/components/core/ext/nlp/annotator.vue","webpack:///./src/components/core/ext/nlp/annotator.vue?35c8","webpack:///./src/components/core/ext/nlp/annotator.vue","webpack:///./src/components/core/ext/nlp/tom.vue?566e","webpack:///./node_modules/uuid/dist/esm-browser/rng.js","webpack:///./node_modules/uuid/dist/esm-browser/regex.js","webpack:///./node_modules/uuid/dist/esm-browser/validate.js","webpack:///./node_modules/uuid/dist/esm-browser/stringify.js","webpack:///./node_modules/uuid/dist/esm-browser/v4.js","webpack:///./src/components/core/ext/nlp/tinycolor.js"],"names":["input","options","fn","TypeError","value","node","isWordSeparator","test","separator","ast","type","nodes","stash","stack","state","string","i","bos","eos","length","prev","next","quotes","openers","brackets","returns","closers","invert","keep","block","peek","append","closeIndex","startIdx","idx","indexOf","index","includes","pos","slice","parent","push","pop","join","filter","item","obj","inverted","key","Object","keys","Token","data","scanner","this","_index","count","atLeft","atRight","token","arroundLeft","arroundRight","arround","tokens","map","t","start","stop","parse","grammar","result","current","first","changed","res","r","apply","shift","rIndex","d","scan","skip","concat","nextIteration","limit","parsed","resolve","reject","Rule","cb","cond","thenCb","forEach","temp","OptionalRule","rule","NotRule","window","rules","NextRule","PrevRule","CursorRule","w","RepeatRule","e","firstPos","lastPos","last","not","or","some","any","and","all","every","anyData","AnyData","allData","AllData","cursor","sequence","repeat","option","optional","abbreviations","monthAbbr","labelRules","label","toUpperCase","hasEveryLabels","labels","l","hasSomeLabels","notHasEveryLabels","notHasSomeLabels","hasLabels","notHasLabels","hasSomeValues","values","stage","s","LABELS","then","DOTTED_ABBR","FLOAT","SIGNED","NN","PERCENTS","NUMBERS","DATE_NNN","TIME_NNN","TIME_NN","COMPLEX_WORD","TIME","DATE","INITIAL","TEXT_START","TEXT_STOP","DOTTED_ABBR_EOSENTENCE","SUBSENTENCE_START","SENTENCE_START","PARAGRAPH_START","DUBLE_EOP","sentences","emptyTom","sample","Promise","replace","split","createStructure","text","p","ss","startOfText","id","childs","startOfParagraph","startOfSentence","startOfSubSentence","word","number","date","time","endOfSubSentence","trim","splice","endOfSentence","endOfParagraph","endOfText","whitespace","forEachNode","beforeAction","afterAction","n","findNode","selectNodes","selection","replaceNode","tom","f","getParent","replaceNodeByContent","root","getSiblings","getStyle","element","property","getComputedStyle","getPropertyValue","style","g","diff","mode","object","array","originalBranchName","currentBranchName","tom2Plain","syntaxNode","versionNode","concept","action","name","terminalIndex","plain2Tom","parentStack","isAnnotationOpened","branch","c","takeSegment","fragment","stopped","source","segmentBranches","original","compare","status","suffix","diffSequence","getDifferenceTom","d1","d2","l1","l2","b1","b2","tres","f1","f2","EQUAL_STARTEGY","src","dest","OVERRIDE_STRATEGY","UNION_STRATEGY","mergeDiff","strategy","destination","mergeTom","merged","resolveStrategies","EQUAL","OVERRIDE","UNION","tokenize","extractSentences","outer","inner","nestedIn","nesting","createAnnotation","annotation","newAnnotation","buildTom","opts","entities","buildText","module","exports","o","call","m","defineProperty","enumerable","get","Symbol","toStringTag","__esModule","create","bind","default","prototype","hasOwnProperty","REFERENCE","DIFF","STRING","u","iterator","constructor","Array","isArray","a","changes","_","compareArraysInOrder","function","find","ADDED","DELETED","MODIFIED","y","E","getTime","h","toString","b","D","boolean","multipleComparatorSelector","deepComparatorSelector","getComparatorByType","configure","JSON","stringify","unshift","assign","arguments","v","I","O","S","F","A","j","L","compSelector","config","setConfig","getConfig","applyLeftChanges","applyRightChanges","filterDiffByStatus","DIFF_MODES","PROPERTY_STATUS","render","_vm","_c","_self","attrs","on","showTooltip","hideTooltip","displayMenu","onSelect","_e","tt_x","tt_y","showTooltipModel","staticClass","staticStyle","domProps","_s","tooltipText","menu_x","menu_y","model","callback","$$v","showMenu","expression","_l","$event","icon","tinycolor","color","darken","toHexString","title","staticRenderFns","tag","class","classes","mouseEnter","mouseLeave","preventDefault","contextMenu","stopPropagation","select","_v","propagateShowTooltip","propagateHideTooltip","propagateShowMenu","propagateSelect","props","components","TextNode","ParagraphNode","Node","Diff","Branch","computed","selectable","selected","base","tc","bdc","tooltip","methods","$emit","sender","msg","el","position","x","clientX","clientY","emitMessage","component","selectionMode","_selectionOrigin","menu","tt_stack","watch","document","getElementById","classList","remove","add","availableSelectionMode","siblings","originIndex","selectionIndex","selectionPos","_selectionFrom","$el","getBoundingClientRect","bottom","$nextTick","$keyController","keydown","keyup","VIcon","VList","VListItem","VListItemContent","VListItemGroup","VListItemIcon","VListItemTitle","VMenu","VTooltip","getRandomValues","rnds8","Uint8Array","rng","crypto","msCrypto","Error","validate","uuid","byteToHex","substr","arr","offset","undefined","toLowerCase","v4","buf","rnds","random","trimLeft","trimRight","tinyCounter","mathRound","Math","round","mathMin","min","mathMax","max","mathRandom","rgb","inputToRGB","_originalInput","_r","_g","_b","_a","_roundA","_format","format","_gradientType","gradientType","_ok","ok","_tc_id","stringInputToObject","isValidCSSUnit","rgbToRgb","String","convertToPercentage","hsvToRgb","hslToRgb","boundAlpha","bound01","rgbToHsl","hue2rgb","q","rgbToHsv","floor","mod","rgbToHex","allow3Char","hex","pad2","charAt","rgbaToHex","allow4Char","convertDecimalToHex","rgbaToArgbHex","desaturate","amount","hsl","toHsl","clamp01","saturate","greyscale","lighten","brighten","toRgb","spin","hue","complement","triad","tetrad","splitcomplement","analogous","results","slices","part","ret","monochromatic","hsv","toHsv","modification","isDark","getBrightness","isLight","isValid","getOriginalInput","getFormat","getAlpha","getLuminance","RsRGB","GsRGB","BsRGB","R","G","B","pow","setAlpha","toHsvString","toHslString","toHex","toHex8","toHex8String","toRgbString","toPercentageRgb","toPercentageRgbString","toName","hexNames","toFilter","secondColor","hex8String","secondHex8String","formatSet","formattedString","hasAlpha","needsAlphaFormat","clone","_applyModification","args","_applyCombination","fromRatio","newColor","equals","color1","color2","mix","rgb1","rgb2","rgba","readability","c1","c2","isReadable","wcag2","wcag2Parms","out","validateWCAG2Parms","level","size","mostReadable","baseColor","colorList","includeFallbackColors","bestColor","bestScore","names","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","burntsienna","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","flip","flipped","parseFloat","isNaN","isOnePointZero","processPercent","isPercentage","parseInt","abs","val","parseIntFromHex","convertHexToDecimal","matchers","CSS_INTEGER","CSS_NUMBER","CSS_UNIT","PERMISSIVE_MATCH3","PERMISSIVE_MATCH4","RegExp","hsla","hsva","hex3","hex6","hex4","hex8","exec","match","named","parms"],"mappings":"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","file":"js/chunk-ea7cd3c0.44ccd604.js","sourcesContent":["\r\nconst res =  (input, options = {}, fn) => {\r\n    if (typeof input !== 'string') throw new TypeError('expected a string');\r\n\r\n    if (typeof options === 'function') {\r\n        fn = options;\r\n        options = {};\r\n    }\r\n\r\n    let isWordSeparator = value => /[^a-zа-яёїіґє\\`\\'0-9]/gi.test(value)\r\n    let isSentenceSeparator = value => /[.\\!\\?]/gi.test(value)\r\n    let isSubSentenceSeparator = value => /[,\\-\\:\\;]/gi.test(value)\r\n    let isWord = value => /[a-zа-яёїіґє\\`\\']+/gi.test(value)\r\n    let isNumber = value => /[0-9]+/gi.test(value)\r\n\r\n\r\n    let separator = options.separator || ['.', ',', ' ', '-', '=', ':', ';', '!', '?', '#'];\r\n    let ast = { type: 'root', nodes: [], stash: [''] };\r\n    let stack = [ast];\r\n    let state = { input, separator, stack };\r\n    let string = input;\r\n    let value, node;\r\n    let i = -1;\r\n\r\n    state.bos = () => i === 0;\r\n    state.eos = () => i === string.length;\r\n    state.prev = () => string[i - 1];\r\n    state.next = () => string[i + 1];\r\n\r\n    let quotes = options.quotes || [];\r\n    let openers = options.brackets || {};\r\n\r\n    options.returns = options.returns || \"stash\"\r\n\r\n\r\n    if (options.brackets === true) {\r\n        openers = { '[': ']', '(': ')', '{': '}', '<': '>' };\r\n    }\r\n    if (options.quotes === true) {\r\n        quotes = ['\"', '`'];\r\n    }\r\n\r\n    let closers = invert(openers);\r\n    let keep = options.keep || (value => value !== '\\\\');\r\n\r\n    const block = () => (state.block = stack[stack.length - 1]);\r\n    const peek = () => string[i + 1];\r\n    const next = () => string[++i];\r\n    const append = value => {\r\n        // console.log(`append \"${value}\"`)\r\n        state.value = value;\r\n        // if (value && keep(value, state) !== false) {\r\n        state.block.stash[state.block.stash.length - 1] += value;\r\n        // }\r\n    };\r\n\r\n    const closeIndex = (value, startIdx) => {\r\n        let idx = string.indexOf(value, startIdx);\r\n        if (idx > -1 && string[idx - 1] === '\\\\') {\r\n            idx = closeIndex(value, idx + 1);\r\n        }\r\n        return idx;\r\n    };\r\n\r\n    for (; i < string.length - 1;) {\r\n        state.value = value = next();\r\n        state.index = i;\r\n        block();\r\n\r\n        // console.log(`## \"${value}\"`)\r\n        // console.log(state.block.stash)\r\n\r\n        // handle escaped characters\r\n        if (value === '\\\\') {\r\n            if (peek() === '\\\\') {\r\n                append(value + next());\r\n            } else {\r\n                // if the next char is not '\\\\', allow the \"append\" function\r\n                // to determine if the backslashes should be added\r\n                append(value);\r\n                append(next());\r\n            }\r\n            continue;\r\n        }\r\n\r\n        // handle quoted strings\r\n        if (quotes.includes(value)) {\r\n            let pos = i + 1;\r\n            let idx = closeIndex(value, pos);\r\n\r\n            if (idx > -1) {\r\n                append(value); // append opening quote\r\n                append(string.slice(pos, idx)); // append quoted string\r\n                append(string[idx]); // append closing quote\r\n                i = idx;\r\n                continue;\r\n            }\r\n\r\n            append(value);\r\n            continue;\r\n        }\r\n\r\n        // handle opening brackets, if not disabled\r\n        if (options.brackets !== false && openers[value]) {\r\n            node = { type: 'bracket', nodes: [] };\r\n            node.stash = keep(value) !== false ? [value] : [''];\r\n            node.parent = state.block;\r\n            state.block.nodes.push(node);\r\n            stack.push(node);\r\n            continue;\r\n        }\r\n\r\n        // handle closing brackets, if not disabled\r\n        if (options.brackets !== false && closers[value]) {\r\n            if (stack.length === 1) {\r\n                append(value);\r\n                continue;\r\n            }\r\n\r\n            append(value);\r\n            node = stack.pop();\r\n            block();\r\n            append(node.stash.join(''));\r\n            continue;\r\n        }\r\n\r\n        // push separator onto stash\r\n        if ( /*(separator.indexOf(value)>=0 || value === \" \")*/ isWordSeparator(value) && state.block.type === 'root') {\r\n            if (typeof fn === 'function' && fn(state) === false) {\r\n                append(value);\r\n                continue;\r\n            }\r\n            // console.log(`v=\"${value}\"`)\r\n            state.block.stash.push(value);\r\n            // console.log(state.block.stash)\r\n            state.block.stash.push('');\r\n\r\n            continue;\r\n        }\r\n\r\n        // append value onto the last string on the stash\r\n        append(value);\r\n    }\r\n\r\n    node = stack.pop();\r\n\r\n    // while (node !== ast) {\r\n    //   if (options.strict === true) {\r\n    //     let column = i - node.stash.length + 1;\r\n    //     throw new SyntaxError(`Unmatched: \"${node.stash[0]}\", at column ${column}`);\r\n    //   }\r\n\r\n    //   value = (node.parent.stash.pop() + node.stash.join('.'));\r\n    //   node.parent.stash = node.parent.stash.concat(value.split('.'));\r\n    //   node = stack.pop();\r\n    // }\r\n\r\n    return node.stash.filter(item => item)\r\n    // .map(item => ({\r\n    //   value: item\r\n    // }));\r\n\r\n}\r\n\r\nfunction invert(obj) {\r\n    let inverted = {};\r\n    for (const key of Object.keys(obj)) inverted[obj[key]] = key;\r\n    return inverted;\r\n}\r\n\r\nexport default res","import { isArray, slice, flatten } from 'lodash';\r\n\r\n\r\n/** Клас тега */\r\nclass Token {\r\n\t/**\r\n     * Створює примірник тега. \r\n     * @param {int} index - Позиція в масиві.\r\n     * @param {*} data - Значення тега.\r\n     * @param {Scanner} scanner - Посилання на {@link Scanner}.\r\n    */\r\n\tconstructor(index, data, scanner){\r\n\t\tthis._index = index\r\n\t\tthis.data = data\r\n\t\tthis.scanner = scanner\r\n\t}\r\n\r\n\t/**\r\n     * Повертає тег ліворуч\r\n     * @param {int}  count - зміщення.\r\n     \r\n     * @return {token} -  Примірник {@link token} ліворуч від поточного на {count} позиції.\r\n    */\r\n\t\t\r\n\tatLeft(count){\r\n\t\treturn this.scanner.atLeft(this, count)\r\n\t}\t\r\n\r\n\t/**\r\n     * Повертає тег праворуч\r\n     * @param {int}  count - зміщення.\r\n     \r\n     * @return {token} -  Примірник {@link token} праворуч від поточного на {count} позиції.\r\n    */\r\n\t\r\n\tatRight(count){\r\n\t\treturn this.scanner.atRight(this, count)\r\n\t}\r\n\r\n\t/**\r\n     * Повертає тег на вказаній позиції\r\n     * @param {int}  pos - позиція.\r\n     \r\n     * @return {token} -  Примірник {@link token} на позиції {pos}.\r\n    */\r\n\r\n\tatIndex(pos){\r\n\t\treturn this.scanner.token(pos)\t\r\n\t}\t\t\r\n\t\r\n\t/**\r\n     * Повертає наступний тег\r\n     * @return {token} -  Примірник {@link token}.\r\n    */\r\n\r\n\tnext(token){ \r\n\t\treturn this.scanner.next(this)\r\n\t}\t\r\n\r\n\t/**\r\n     * Повертає попередній тег\r\n     * @return {token} -  Примірник {@link token}.\r\n    */\r\n\r\n\tprev(token){\r\n\t\treturn this.scanner.prev(this)\r\n\t}\t\r\n\t\r\n\t/**\r\n     * Повертає масив тегів ліворуч\r\n     * @param {int} count - Розмір вікна.\r\n     * @return {token} -  Масив {@link token}.\r\n    */\r\n\t\r\n\tarroundLeft(count){\r\n\t\treturn this.scanner.arroundLeft(this, count)\r\n\t}\r\n\t\r\n\t/**\r\n     * Повертає масив тегів праворуч\r\n     * @param {int} count - Розмір вікна.\r\n     * @return {token} -  Масив {@link token}.\r\n    */\r\n\t\r\n\tarroundRight(count){\r\n\t\treturn this.scanner.arroundRight(this, count)\r\n\t}\r\n\r\n\t/**\r\n     * Повертає масив тегів навколо\r\n     * @param {int} count - Розмір вікна.\r\n     * @return {token} -  Масив {@link token}.\r\n    */\r\n\t\r\n\tarround(count){\r\n\t\treturn this.scanner.arround(this, count)\r\n\t}\r\n\r\n}\r\n\r\n/** Клас сканера */\r\nclass Scanner {\r\n\t/**\r\n     * Створює примірник сканера. \r\n     * @param {Array.<*>} tokens - Вхідний масив тегів.\r\n    */\r\n\tconstructor(tokens){\r\n\t\ttokens = tokens || []\r\n\t\ttokens = isArray(tokens) ? tokens : [tokens]\r\n\t\tthis.tokens = tokens.map( (t, index) => new Token(index, t, this))\r\n\t}\r\n\r\n\t/**\r\n     * Повертає тег \r\n     * @param {int}  - Порядковий номер тега в масиві (індекс).\r\n     * @return {token} -  Примірник {@link token}.\r\n    */\r\n\r\n\ttoken(pos){\r\n\t\tpos = pos || 0\r\n\t\treturn this.tokens[pos]\r\n\t}\r\n\t\r\n\t/**\r\n     * Повертає перший тег масива \r\n     * @return {token} -  Примірник {@link token}.\r\n    */\r\n\t\r\n\tfirst(){\r\n\t\treturn (this.tokens.length > 0) ? this.token(0) : null\r\n\t}\r\n\r\n\t/**\r\n     * Повертає останній тег масива \r\n     * @return {token} -  Примірник {@link token}.\r\n    */\r\n\t\r\n\tlast(){\r\n\t\treturn (this.tokens.length > 0) ? this.token(this.tokens.length-1) : null\r\n\t}\r\n\r\n\t/**\r\n     * Повертає тег ліворуч від поточного тега\r\n     * @param {token} token - поточний {@link token}.\r\n     * @param {int}  count - зміщення.\r\n     \r\n     * @return {token} -  Примірник {@link token} ліворуч від поточного на {count} позиції.\r\n    */\r\n\t\r\n\tatLeft(token, count){\r\n\t\treturn ((token._index - count) < 0 ) ? null : this.tokens[token._index - count]\r\n\t}\t\r\n\r\n\t/**\r\n     * Повертає тег праворуч від поточного тега\r\n     * @param {token} token - поточний {@link token}.\r\n     * @param {int}  count - зміщення.\r\n     \r\n     * @return {token} -  Примірник {@link token} праворуч від поточного на {count} позиції.\r\n    */\r\n\t\r\n\tatRight(token, count){\r\n\t\treturn ((token._index + count) > this.tokens.length - 1 ) ? null : this.tokens[token._index + count]\r\n\t}\t\t\r\n\t\r\n\t/**\r\n     * Повертає наступний від поточного тег\r\n     * @param {token} token - поточний {@link token}.\r\n     \r\n     * @return {token} -  Примірник {@link token}, наступний за поточним.\r\n    */\r\n\t\r\n\tnext(token){ \r\n\t\treturn this.atRight(token, 1)\r\n\t}\t\r\n\r\n\t/**\r\n     * Повертає попередній від поточного тег\r\n     * @param {token} token - поточний {@link token}.\r\n     \r\n     * @return {token} -  Примірник {@link token}, попередній від поточного.\r\n    */\r\n\r\n\tprev(token){\r\n\t\treturn this.atLeft(token, 1)\r\n\t}\t\r\n\t\r\n\t/**\r\n     * Повертає масив тегів ліворуч від поточного\r\n     * @param {token} token - поточний {@link token}.\r\n     * @param {int} count - Розмір вікна.\r\n     * @return {token} -  Масив {@link token}, ліворуч від поточного.\r\n    */\r\n\t\r\n\tarroundLeft(token, count){\r\n\t\tlet start = token._index - count\r\n\t\tstart = (start < 0 ) ? 0 : start\r\n\t\treturn slice(this.tokens, start, token._index)\r\n\t}\r\n\t\r\n\t/**\r\n     * Повертає масив тегів праворуч від поточного\r\n     * @param {token} token - поточний {@link token}.\r\n     * @param {int} count - Розмір вікна.\r\n     * @return {token} -  Масив {@link token}, праворуч від поточного.\r\n    */\r\n\tarroundRight(token, count){\r\n\t\tlet stop = token._index + count + 1\r\n\t\tstop = (stop > this.tokens.length + 1 ) ? this.tokens.length + 1 : stop\r\n\t\treturn slice(this.tokens, token._index+1, stop)\r\n\t}\r\n\r\n\t/**\r\n     * Повертає масив тегів навколо від поточного\r\n     * @param {token} token - поточний {@link token}.\r\n     * @param {int} count - Розмір вікна.\r\n     * @return {token} -  Масив {@link token}, навколо від поточного.\r\n    */\r\n\r\n\tarround(token, count){\r\n\t\treturn flatten([this.arroundLeft(token, count), this.arroundRight(token, count)])\r\n\t} \r\n\r\n}\r\n\r\n/**\r\n * Сканер масиву тегів.\r\n * Забезпечує двосторонню навігацію в масиві тегів\r\n * @module scanner\r\n */\r\n\r\n/**\r\n * Повертає примірник {@link Scanner}.\r\n * @param {Array.<*>} tokens - Вхідний масив тегів.\r\n * @return {Scanner} примірник {@link Scanner}\r\n*/\r\n\r\nexport default tokens => {\r\n\treturn new Scanner(tokens)\r\n};\t\r\n\r\n","import cursor from './scanner';\r\nimport { findIndex, isArray } from 'lodash';\r\n\r\nlet parse = (data, grammar) => {\r\n\t\t\t\t\r\n\tlet result = []\r\n\tlet current = cursor(data).first()\r\n\tlet changed = false\r\n\r\n\twhile (current) {\r\n\t\tlet res = grammar.map( r => r.apply(current))\r\n\t\tlet shift = 0\r\n\t\r\n\t\tlet rIndex = findIndex(res, d => d)\r\n\r\n\t\tif( rIndex >= 0 ) {\r\n\t\t\tchanged = true\r\n\t\t\tshift = grammar[rIndex].scan(current) //_.max(grammar.map( r => r.window || 1)) \r\n\t\t\tif( !res[rIndex].skip ) result = result.concat((isArray(res[rIndex])) ? res[rIndex] : [res[rIndex]]) \r\n\t\t} else {\r\n\t\t\tresult.push(current.data)\r\n\t\t}\t \r\n\r\n\t\tshift = (shift) ? shift : 1\r\n\t\tcurrent = current.atRight(shift)\r\n\t\t\r\n\t}\r\n\t\r\n\treturn {\r\n\t\tnextIteration: changed,\r\n\t\tdata: result\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * Парсер текстів на українській мові.\r\n * Перетворює вхідний масив тегів у вихідний масив тегів з використанням граматичних правил.\r\n * @module parser\r\n */\r\n\r\n/**\r\n * Повертає масив тегів, отриманих в результаті перетворення на основі граматичних правил.\r\n \r\n * @param {Array.<*>} data - Вхідний масив тегів.\r\n * @param {Array.<Rule>} grammar - Граматика (масив правил).\r\n \r\n * @return {Promise} Проміс, який буде повертати масив тегів.\r\n\r\n * @exception {ParserException} \"Iteration limit unbounded\", якщо кількість ітерацій перевищує довжину вхідного масиву тегів\r\n */\r\n\r\nexport default (data, grammar) => ( new Promise (( resolve, reject ) => \r\n\r\n\t{\r\n\t\t\r\n\t\tlet limit = data.length * 2 + 5\r\n\t\tlet parsed = {\r\n\t  \t\t\tnextIteration: true,\r\n\t  \t\t\tdata\r\n\t  \t};\r\n\t  \tlet i = 0\r\n\t  \twhile(parsed.nextIteration && i <= limit) { \r\n\t  \t\ti++\r\n\t  \t\tparsed = parse(parsed.data, grammar)\r\n\t  \t\t// console.log(i, parsed)\r\n\t  \t}\r\n\t  \tif(i <= limit){\r\n\t  \t\tresolve(parsed.data)\t\r\n\t  \t} else {\r\n\t  \t\treject(\"Iteration limit unbounded\")\r\n\t  \t}\r\n\r\n\t}));  \t\t\r\n\r\n\r\n  \t\t","import { find, max, extend } from 'lodash';\r\n\r\nclass Rule {\r\n\t\r\n\tconstructor(cb){\r\n\t\tthis.cond = cb;\r\n\t\tthis.thenCb = [d => d]\r\n\t}\r\n\r\n\ttest(token){\r\n\t\treturn this.cond(token)\r\n\t}\r\n\r\n\tthen(cb){\r\n\t\tthis.thenCb.push(cb)\r\n\t\treturn this\r\n\t}\r\n\r\n\tscan(token){\r\n\t\treturn (this.cond(token)) ? 1 : 0\t\t\r\n\t}\r\n\r\n\tmap(token){\r\n\t\tlet res = token\r\n\t\tthis.thenCb.forEach( cb => {\r\n\t\t\tlet temp = cb(res) \r\n\t\t\tres = (temp) ? temp : res\r\n\t\t})\r\n\t\treturn res\t\r\n\t}\r\n\r\n\tapply(token){\r\n\t\tif (this.test(token)) return this.map(token)\r\n\t}\r\n}\r\n\r\nclass PosRule {\r\n\t\r\n\tconstructor(cb){\r\n\t\tthis.cond = cb;\r\n\t\tthis.thenCb = [d => d]\r\n\t}\r\n\r\n\ttest(token){\r\n\t\treturn this.cond(token)\r\n\t}\r\n\r\n\tthen(cb){\r\n\t\tthis.thenCb.push(cb)\r\n\t\treturn this\r\n\t}\r\n\r\n\tscan(token){\r\n\t\treturn 0\t\t\r\n\t}\r\n\r\n\tmap(token){\r\n\t\tlet res = token\r\n\t\tthis.thenCb.forEach( cb => {\r\n\t\t\tlet temp = cb(res) \r\n\t\t\tres = (temp) ? temp : res\r\n\t\t})\r\n\t\treturn res\t\r\n\t}\r\n\r\n\tapply(token){\r\n\t\tif (this.test(token)) return this.map(token)\r\n\t}\r\n}\r\n\r\nclass OptionalRule {\r\n\r\n\tconstructor(rule){\r\n\t\tthis.rule = rule;\r\n\t\tthis.thenCb = [d => d]\r\n\t}\r\n\r\n\ttest(){\r\n\t\treturn true\r\n\t}\r\n\r\n\tscan(token){\r\n\t\treturn (this.rule.test(token)) ? this.rule.scan(token) : 0\r\n\t}\r\n\r\n\tthen(cb){\r\n\t\tthis.thenCb.push(cb)\r\n\t\treturn this\r\n\t}\r\n\r\n\tmap(token){\r\n\t\tif( this.rule.test(token) ){\r\n\t\t\tlet res = this.rule.map(token)\r\n\t\t\tthis.thenCb.forEach( cb => {\r\n\t\t\t\tlet temp = cb(res) \r\n\t\t\t\tres = (temp) ? temp : res\r\n\t\t\t})\r\n\t\t\treturn res\t\r\n\t\t}\r\n\t}\r\n\r\n\tapply(token){\r\n\t\tif (this.test(token)) return this.map(token)\r\n\t}\r\n\r\n}\r\n\r\nclass NotRule {\r\n\t\r\n\tconstructor(rule){\r\n\t\tthis.rule = rule;\r\n\t\tthis.thenCb = [d => d]\r\n\t\tthis.window = 0\r\n\t}\r\n\r\n\ttest(token){\r\n\t\treturn !this.rule.test(token) \r\n\t}\r\n\r\n\tscan(token){\r\n\t\treturn (this.test(token)) ? 1 : 0\r\n\t}\r\n\r\n\tthen(cb){\r\n\t\tthis.thenCb.push(cb)\r\n\t\treturn this\r\n\t}\r\n\r\n\tmap(token){\r\n\t\t\tlet res = this.rule.map(token)\r\n\t\t\tthis.thenCb.forEach( cb => {\r\n\t\t\t\tlet temp = cb(res) \r\n\t\t\t\tres = (temp) ? temp : res\r\n\t\t\t})\r\n\t\t\t// console.log(res)\r\n\t\t\treturn res\t\r\n\t}\r\n\r\n\tapply(token){\r\n\t\tif (this.test(token)) return this.map(token)\r\n\t}\r\n}\r\n\r\n\r\n\r\nclass AnyRule {\r\n\t\r\n\tconstructor(...rules){\r\n\t\tthis.rules = rules[0]\r\n\t\tthis.thenCb = [d => d]\r\n\t}\r\n\r\n\ttest(token){\r\n\t\treturn this.rules.map( r => r.test(token)).filter( r => r).length > 0\r\n\t}\r\n\r\n\tthen(cb){\r\n\t\tthis.thenCb.push(cb)\r\n\t\treturn this\r\n\t}\r\n\r\n\tmap(token){\r\n\t\tlet r = find(this.rules, r => r.test(token))\r\n\t\tif (r) {\r\n\t\t\tlet res = r.map(token)\r\n\t\t\tthis.window = r.window || 1\r\n\r\n\t\t\tthis.thenCb.forEach( cb => {\r\n\t\t\t\tlet temp = cb(res) \r\n\t\t\t\tres = (temp) ? temp : res\r\n\t\t\t})\r\n\r\n\t\t\treturn res\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\tscan(token){\r\n\t\tlet r = find(this.rules, r => r.test(token))\r\n\t\treturn (r) ? r.scan(token) : 0\r\n\t}\r\n\r\n\tapply(token){\r\n\t\tlet r = find(this.rules, r => r.test(token))\r\n\t\tif (r) return this.map(token)\r\n\t}\r\n}\r\n\r\n\r\n\r\nclass NextRule {\r\n\t\r\n\tconstructor(rule){\r\n\t\tthis.rule = rule\r\n\t\tthis.thenCb = [d => d]\r\n\t}\r\n\r\n\ttest(token){\r\n\t\tlet d = token.next()\r\n\t\tif(d) return this.rule.test(d)\r\n\t}\r\n\r\n\tthen(cb){\r\n\t\tthis.thenCb.push(cb)\r\n\t\treturn this\r\n\t}\r\n\r\n\tscan(token){\r\n\t\tlet d = token.next()\r\n\t\tif(d) return this.rule.scan(d)\r\n\t}\r\n\r\n\tmap(token){\r\n\t\tlet d = token.next()\r\n\t\t\r\n\t\tif( d ) {\r\n\t\t\tlet res = this.rule.map(d)\r\n\t\t\tthis.thenCb.forEach( cb => {\r\n\t\t\t\tlet temp = cb(res) \r\n\t\t\t\tres = (temp) ? temp : res\r\n\t\t\t})\r\n\t\t\treturn res\r\n\t\t}\t\t\r\n\t}\r\n\r\n\tapply(token){\r\n\t\tif (this.test(token)) return this.map(token)\r\n\t}\r\n}\r\n\r\nclass PrevRule {\r\n\t\r\n\tconstructor(rule){\r\n\t\tthis.rule = rule\r\n\t\tthis.thenCb = [d => d]\r\n\t}\r\n\r\n\ttest(token){\r\n\t\tlet d = token.prev()\r\n\t\tif(d) return this.rule.test(d)\r\n\t}\r\n\r\n\tthen(cb){\r\n\t\tthis.thenCb.push(cb)\r\n\t\treturn this\r\n\t}\r\n\r\n\tscan(token){\r\n\t\tlet d = token.prev()\r\n\t\tif(d) return this.rule.scan(d)\r\n\t}\r\n\r\n\tmap(token){\r\n\t\tlet d = token.prev()\r\n\t\t\r\n\t\tif( d ) {\r\n\t\t\tlet res = this.rule.map(d)\r\n\t\t\tthis.thenCb.forEach( cb => {\r\n\t\t\t\tlet temp = cb(res) \r\n\t\t\t\tres = (temp) ? temp : res\r\n\t\t\t})\r\n\t\t\treturn res\r\n\t\t}\t\t\r\n\t}\r\n\r\n\tapply(token){\r\n\t\tif (this.test(token)) return this.map(token)\r\n\t}\r\n}\r\n\r\nclass CursorRule {\r\n\t\r\n\tconstructor(...rules){\r\n\t\tthis.rules = rules[0]\r\n\t\tthis.thenCb = [d => d]\r\n\t}\r\n\r\n\ttest(token){\r\n\t\tlet res = []\r\n\t\tlet d = token\r\n\t\t\r\n\t\tthis.rules.forEach(r => {\r\n\t\t\tif(d){\r\n\t\t\t\tlet t = r.test(d)\r\n\t\t\t\tt = (t) ? t : false\r\n\t\t\t\tres.push(t)\r\n\t\t\t\tif(t) d = (d) ? d.atRight(r.scan(d)) : d\r\n\t\t\t} else {\r\n\t\t\t\tres.push(false)\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t})\r\n\r\n\t\treturn res.filter( r => r).length  == this.rules.length\r\n\t}\r\n\r\n\tthen(cb){\r\n\t\tthis.thenCb.push(cb)\r\n\t\treturn this\r\n\t}\r\n\r\n\tscan(token){\r\n\t\tlet res = []\r\n\t\tlet d = token\r\n\t\tlet w = 0\r\n\t\tthis.rules.forEach(r => {\r\n\t\t\tif(d){\r\n\t\t\t\t// console.log(\"--\", w, \"--\", d.item.value)\r\n\t\t\t\tlet t = r.test(d)\r\n\t\t\t\tt = (t) ? t : false\r\n\t\t\t\tres.push(t)\r\n\t\t\t\tif(t){\r\n\t\t\t\t\tw += r.scan(d)\r\n\t\t\t\t\td = token.atRight(w)\t\r\n\t\t\t\t} \t\t\r\n\t\t\t} else {\r\n\t\t\t\tres.push(false)\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t})\r\n\t\t// console.log(res)\r\n\t\treturn w //(res.filter( r => r).length  == this.rules.length) ? w : 0\r\n\t}\r\n\r\n\tmap(token){\r\n\t\tlet res = []\r\n\t\tlet d = token\r\n\t\tthis.rules.forEach( r => {\r\n\t\t\tres.push((d) ? r.map(d) : null)\r\n\t\t\td = (d) ? d.atRight(r.scan(d)) : d\t\r\n\t\t})\r\n\t\t\r\n\t\tthis.thenCb.forEach( cb => {\r\n\t\t\tlet temp = cb(res) \r\n\t\t\tres = (temp) ? temp : res\r\n\t\t})\r\n\t\treturn res\r\n\t}\r\n\r\n\tapply(token){\r\n\t\tif (this.test(token)) return this.map(token)\r\n\t}\r\n}\r\n\r\n\r\nclass RepeatRule {\r\n\t\r\n\tconstructor(rule){\r\n\t\tthis.rule = rule\r\n\t\tthis.thenCb = [d => d]\r\n\t}\r\n\r\n\ttest(token){\r\n\t\tlet res = false\r\n\t\tlet d = token\r\n\t\twhile(d && this.rule.test(d)){\r\n\t\t\tres = true\r\n\t\t\td = d.atRight(this.rule.scan(d))\r\n\t\t}\r\n\t\treturn res\r\n\t}\r\n\r\n\tthen(cb){\r\n\t\tthis.thenCb.push(cb)\r\n\t\treturn this\r\n\t}\r\n\r\n\tscan(token){\r\n\t\tlet d = token\r\n\t\tlet w = 0\r\n\t\twhile(d && this.rule.test(d)){\r\n\t\t\tw += this.rule.scan(d)\r\n\t\t\td = token.atRight(w)\r\n\t\t}\r\n\t\treturn w\r\n\t}\r\n\r\n\tmap(token){\r\n\t\tlet res = []\r\n\t\tlet d = token\r\n\t\t\r\n\t\twhile(d && this.rule.test(d)){\r\n\t\t\tres.push(this.rule.map(d))\r\n\t\t\td = d.atRight(this.rule.scan(d))\r\n\t\t}\r\n\t\tthis.thenCb.forEach( cb => {\r\n\t\t\tlet temp = cb(res) \r\n\t\t\tres = (temp) ? temp : res\r\n\t\t})\r\n\t\t\r\n\t\treturn res\r\n\t}\r\n\r\n\tapply(token){\r\n\t\tif (this.test(token)) return this.map(token)\r\n\t}\r\n}\r\n\r\nclass AllRule {\r\n\t\r\n\tconstructor(...rules){\r\n\t\tthis.rules = rules[0]\r\n\t\tthis.thenCb = [d => d]\r\n\t}\r\n\r\n\ttest(token){\r\n\t\treturn this.rules.map( r => r.test(token)).filter( r => r).length  == this.rules.length\r\n\t}\r\n\r\n\tthen(cb){\r\n\t\tthis.thenCb.push(cb)\r\n\t\treturn this\r\n\t}\r\n\r\n\tmap(token){\r\n\t\tlet res = this.rules.map( r => r.map(token))\r\n\t\tthis.thenCb.forEach( cb => {\r\n\t\t\tlet temp = cb(res) \r\n\t\t\tres = (temp) ? temp : res\r\n\t\t})\r\n\t\treturn res\r\n\t}\r\n\r\n\tscan(token){\r\n\t\treturn (this.test(token)) ? max(this.rules.map( r => r.scan(token))) : 0\r\n\t}\r\n\r\n\tapply(token){\r\n\t\tif (this.test(token)) return this.map(token)\r\n\t}\r\n}\r\n\r\n// class AnyData {\r\n\r\n// \tconstructor(rule){\r\n// \t\tthis.rule = rule\r\n// \t\tthis.thenCb = [d => d]\r\n// \t\tthis.window = 0\r\n// \t}\r\n\r\n// \ttest(token){\r\n// \t\tthis.window = 0\r\n// \t\ttoken = _.isArray(token) ? token : [token]\r\n// \t\treturn token.map( d => this.rule.test(d)).filter( d => d).length > 0\r\n// \t}\r\n\r\n// \tthen(cb){\r\n// \t\tthis.thenCb.push(cb)\r\n// \t\treturn this\r\n// \t}\r\n\r\n// \tmap(token){\r\n// \t\tthis.window = 1\r\n// \t\tlet res = this.rule.map(token)\r\n// \t\tthis.thenCb.forEach( cb => {\r\n// \t\t\tlet temp = cb(res) \r\n// \t\t\tres = (temp) ? temp : res\r\n// \t\t})\r\n// \t\treturn res\r\n// \t}\r\n\r\n// \tapply(token){\r\n// \t\ttoken = _.isArray(token) ? token : [token]\r\n// \t\tlet d = _.find( token, d => this.rule.test(d)) \t\r\n// \t\tif (d) return this.map(d)\r\n// \t}\r\n// }\r\n\r\n// class AllData {\r\n\r\n// \tconstructor(rule){\r\n// \t\tthis.rule = rule\r\n// \t\tthis.thenCb = [d => d]\r\n// \t\tthis.window = 0\r\n// \t}\r\n\r\n// \ttest(token){\r\n// \t\tthis.window = 0\r\n// \t\ttoken = _.isArray(token) ? token : [token]\r\n// \t\treturn token.map( d => this.rule.test(d)).filter( d => d).length  == token.length\r\n// \t}\r\n\r\n// \tthen(cb){\r\n// \t\tthis.thenCb.push(cb)\r\n// \t\treturn this\r\n// \t}\r\n\r\n// \tmap(token){\r\n// \t\tthis.window = 1\r\n// \t\tlet res = token.map( d => this.rule.map(d))\r\n// \t\tthis.thenCb.forEach( cb => {\r\n// \t\t\tlet temp = cb(res) \r\n// \t\t\tres = (temp) ? temp : res\r\n// \t\t})\r\n// \t\treturn res\r\n// \t}\r\n\r\n// \tapply(token){\r\n// \t\ttoken = _.isArray(token) ? token : [token]\r\n// \t\tif (this.test(token)) return this.map(token)\r\n// \t}\r\n// }\r\n\r\nlet e = cb => new Rule(cb)\r\ne = extend(e, {\r\n\t// \"true\": new Rule(token => true),\r\n\t\r\n\t\"ignore\": token => {\r\n\t\ttoken.skip = true\r\n\t\treturn token\r\n\t},\r\n\r\n\t\"skip\": token => {\r\n\t\ttoken.skip = true\r\n\t\treturn token\r\n\t},\r\n\r\n\t// \"shift\": new Rule(token => true),\r\n\tfirstPos: () => new Rule(token => token._index == 0),\r\n\tlastPos: () => new Rule(token => token.scanner.last()._index == token._index),\r\n\tnot: rule => new NotRule(rule),\r\n\tor: (...rules) => new AnyRule(rules),\r\n\tsome: (...rules) => new AnyRule(rules),\r\n\tany: (...rules) => new AnyRule(rules),\r\n\tand: (...rules) => new AnyRule(rules),\r\n\tall: (...rules) => new AllRule(rules),\r\n\tevery: (...rules) => new AllRule(rules),\r\n\tanyData: (rule) => new AnyData(rule),\r\n\tallData: (rule) => new AllData(rule),\r\n\tcursor: (...rules) => new CursorRule(rules),\r\n\tsequence: (...rules) => new CursorRule(rules),\r\n\trepeat: (rule) => new RepeatRule(rule),\r\n\toption: (rule) => new OptionalRule(rule),\r\n\toptional: (rule) => new OptionalRule(rule),\r\n\tnext: (rule) => new NextRule(rule),\r\n\tprev: (rule) => new PrevRule(rule)\r\n\r\n})\r\n\r\nexport default e;\r\n","import $ from './rules';\r\nimport { capitalize, uniq } from 'lodash';\r\n\r\nlet abbreviations = [\r\n        \"ім\",\r\n        \"в\",\r\n        \"о\",\r\n        \"обл\",\r\n        \"вул\", \r\n        \"просп\",\r\n        \"бул\",\r\n        \"пров\",\r\n        \"пл\",\r\n        \"г\",\r\n        \"р\",\r\n        \"див\",\r\n        \"п\",\r\n        \"с\",\r\n        \"м\"\r\n    ]\r\n\r\n    let monthAbbr = [\r\n        \"січ\", \r\n        \"лип\",\r\n        \"лют\",\r\n        \"серп\",\r\n        \"берез\",\r\n        \"верес\",\r\n        \"квіт\", \r\n        \"жовт\",\r\n        \"трав\",\r\n        \"листоп\",\r\n        \"черв\",\r\n        \"груд\"\r\n    ]\r\n\r\n    let labelRules = [\r\n        {\r\n            label:\"whitespace\",\r\n            test: value => /[^a-zа-яёїіґє\\`\\'0-9]/gi.test(value)\r\n        },\r\n        {\r\n            label:\"endOfSubSentence\",\r\n            test: value => /[\\,\\-\\:\\;\\.\\!\\?\\n\\(\\)\\[\\]\\{\\}\\\"]/gi.test(value)\r\n        },\r\n        // {\r\n        //     label:\"endOfSubSentence\",\r\n        //     test: value => /[\\,\\;\\.\\!\\?\\n\"]/gi.test(value)\r\n        // },\r\n        {\r\n            label:\"endOfSentence\",\r\n            test: value => /[\\.\\!\\?\\n]/gi.test(value)\r\n        },\r\n        \r\n        {\r\n            label:\"punctuation\",\r\n            test: value => /[\\,\\-\\:\\;\\.\\!\\?\\(\\)\\[\\]\\\"\\n]/gi.test(value)\r\n        },\r\n        {\r\n            label:\"word\",\r\n            test: value => /[a-zа-яёїіґє\\`]+/gi.test(value)\r\n        },\r\n        {\r\n            label:\"abbreviation\",\r\n            test: value => (abbreviations.indexOf(value)>=0) \r\n                || (monthAbbr.indexOf(value)>=0)\r\n                ||  (\r\n                        value.length >= 2 &&\r\n                        /[a-zа-яёїіґє\\`]+/gi.test(value) &&\r\n                        value.toUpperCase() == value\r\n                    ) \r\n            //^[A-ZА-ЯЁЇІҐЄ]{2,}/\r\n        },\r\n\r\n        {\r\n            label:\"withDot\",\r\n            test: value => (abbreviations.indexOf(value)>=0) || (monthAbbr.indexOf(value) >=0)\r\n        },\r\n\r\n        {\r\n            label:\"initial\",\r\n            test: value => (\r\n                value.length == 1 &&\r\n                /[a-zа-яёїіґє]+/gi.test(value) &&      \r\n                value.toUpperCase() == value\r\n            )\r\n            //^[A-ZА-ЯЁЇІҐЄ]{1}$/\r\n        },\r\n\r\n        {\r\n            label:\"number\",\r\n            test: value => /[0-9]+/gi.test(value)\r\n        },\r\n        {\r\n            label:\"endOfParagraph\",\r\n            test: value => /[\\n]+/gi.test(value)\r\n        },\r\n    \r\n    ]\r\n\r\n \r\nlet hasEveryLabels = (...labels) => ( token => token.data && token.data.labels && labels.every(l => token.data.labels.indexOf(l)>=0))\r\nlet hasSomeLabels = (...labels) => ( token => token.data && token.data.labels && labels.some(l => token.data.labels.indexOf(l)>=0))\r\n\r\nlet notHasEveryLabels = (...labels) => ( token => token.data && token.data.labels && labels.every(l => token.data.labels.indexOf(l)<0))\r\nlet notHasSomeLabels = (...labels) => ( token => token.data && token.data.labels && labels.some(l => token.data.labels.indexOf(l)<0))\r\n\r\n\r\nlet hasLabels = token => token.data.labels \r\nlet notHasLabels = token => !token.data.labels \r\n\r\nlet hasSomeValues = (...values) => ( token => token.data && token.data.value && values.some(l => token.data.value == l))\r\n\r\n\r\nlet stage = s => (token => token.data && token.data.stage >= s)\r\n\r\nlet pos = p => (token => token._index == p)\r\n\r\nlet LABELS = \r\n    $(notHasLabels).then(token => {\r\n        return {\r\n            labels:  labelRules.filter( l => l.test(token.data)).map( l => l.label),\r\n            value: token.data,\r\n            stage: 1\r\n        }\r\n    })\r\n\r\nlet DOTTED_ABBR = \r\n    $.every(\r\n        $.repeat(\r\n            $.sequence(\r\n                $(hasEveryLabels(\"abbreviation\",\"withDot\")),\r\n                $( token => token.data.value == \".\")\r\n            ).then(res => ({\r\n                labels: res[0].data.labels,\r\n                value: res[0].data.value+\".\"\r\n            }))\r\n        ).then( res => ({\r\n            labels: res[0].labels,\r\n            value: res.map( r => r.value).join(\"\"),\r\n            stage:2\r\n        })),\r\n        $(stage(1))\r\n    ).then( res => res[0])\r\n\r\n\r\nlet FLOAT = \r\n    $.every(\r\n        $.sequence(\r\n            $.optional(\r\n                $(hasEveryLabels(\"number\"))\r\n            ),\r\n            $(token => ( token.data.value == \".\" || token.data.value == \",\")),\r\n            $(hasEveryLabels(\"number\"))\r\n        ).then(res => ({\r\n            labels:[\"number\"],\r\n            value: res.filter(r => r).map(r => r.data.value).join(\"\"),\r\n            stage: 2\r\n        })),\r\n        $(stage(1))\r\n    ).then( res => res[0])\r\n\r\nlet SIGNED = \r\n    $.every(\r\n        $.sequence(\r\n            $(hasSomeValues(\"+\",\"-\")),\r\n            $(hasEveryLabels(\"number\"))\r\n        ).then( res => ({\r\n            labels:[\"number\"],\r\n            value: res.filter(r => r).map(r => r.data.value).join(\"\"),\r\n            stage: 2\r\n        })),\r\n        $(stage(1))\r\n    ).then(res => res[0])\r\n\r\nlet NN = \r\n    $.every(\r\n        $.sequence(\r\n            $(hasEveryLabels(\"number\")),\r\n            $(hasEveryLabels(\"number\"))\r\n        ).then( res => ({\r\n            labels:[\"number\"],\r\n            value: res.map(r => r.data.value).join(\"\"),\r\n            stage: 3\r\n        })),\r\n        $(stage(2))\r\n    ).then(res => res[0])\r\n\r\nlet PERCENTS = $.every(\r\n        $.sequence(\r\n            $(hasEveryLabels(\"number\")),\r\n            $(hasSomeValues(\"%\"))\r\n        ).then( res => ({\r\n            labels:[\"number\"],\r\n            value: res.map(r => r.data.value).join(\"\")\r\n        })),\r\n        $(stage(2))\r\n    ).then(res => res[0])        \r\n\r\nlet NUMBERS = \r\n    $.some(\r\n        FLOAT,\r\n        SIGNED,\r\n        NN,\r\n        PERCENTS\r\n    ) \r\n\r\n\r\nlet DATE_NNN = \r\n    $.every(\r\n        $.sequence(\r\n            $(hasEveryLabels(\"number\")),\r\n            $(hasSomeValues(\"-\",\".\",\"/\")),\r\n            $(hasEveryLabels(\"number\")),\r\n            $(hasSomeValues(\"-\",\".\",\"/\")),\r\n            $(hasEveryLabels(\"number\")),\r\n        ).then( res =>({\r\n            labels:[\"date\"],\r\n            value: res.filter(r => r).map(r => r.data.value).join(\"\"),\r\n            stage: 3\r\n        })),\r\n        $(stage(1))\r\n    ).then( res => res[0])\r\n\r\nlet TIME_NNN =              \r\n    $.every(\r\n        $.sequence(\r\n            $(hasEveryLabels(\"number\")),\r\n            $(hasSomeValues(\":\")),\r\n            $(hasEveryLabels(\"number\")),\r\n            $(hasSomeValues(\":\")),\r\n            $(hasEveryLabels(\"number\")),\r\n        ).then( res =>({\r\n            labels:[\"time\"],\r\n            value: res.filter(r => r).map(r => r.data.value).join(\"\"),\r\n            stage: 3\r\n        })),\r\n        $(stage(1))\r\n    ).then( res => res[0])\r\n\r\nlet TIME_NN =              \r\n    $.every(\r\n        $.sequence(\r\n            $(hasEveryLabels(\"number\")),\r\n            $(hasSomeValues(\":\")),\r\n            $(hasEveryLabels(\"number\")),\r\n        ).then( res =>({\r\n            labels:[\"time\"],\r\n            value: res.filter(r => r).map(r => r.data.value).join(\"\"),\r\n            stage: 3\r\n        })),\r\n        $(stage(1))\r\n    ).then( res => res[0])\r\n\r\nlet COMPLEX_WORD = \r\n    $.every(\r\n        $.sequence(\r\n            $(hasSomeLabels(\"number\",\"word\")),\r\n            $(hasSomeValues(\"-\")),\r\n            $(hasSomeLabels(\"word\"))\r\n        ).then( res => ({\r\n            labels:[\"word\",\"complex\"],\r\n            value: res.map( r => r.data.value).join(\"\")\r\n        })),\r\n        $(stage(1))\r\n    ).then( res => res[0])    \r\n\r\n\r\nlet TIME = $.some(\r\n    TIME_NNN,\r\n    TIME_NN\r\n)\r\n\r\nlet DATE = $.some(\r\n    DATE_NNN,\r\n    TIME\r\n)\r\n\r\n\r\nlet INITIAL = \r\n    $.every(\r\n        $.repeat(\r\n            $.sequence(\r\n                $(hasEveryLabels(\"initial\")),\r\n                $(hasSomeValues(\".\"))\r\n            ).then( res => res[0].data.value + \".\")\r\n        ).then(res =>({\r\n            labels:[\"initial\"],\r\n            value: res.join(\"\"),\r\n            stage:2\r\n        })),\r\n        $(stage(1))\r\n    ).then( res => res[0])\r\n\r\n\r\n\r\nlet TEXT_START = \r\n    $.every(\r\n        $.firstPos().then(res => [\r\n        {\r\n            labels:(res.data.labels || []).concat([\"startOfText\",\"startOfParagraph\",\"startOfSentence\",\"startOfSubSentence\"]),\r\n            value: res.data.value\r\n        }\r\n        ]),\r\n        $(hasLabels),\r\n        $(notHasEveryLabels(\"startOfText\",\"startOfSentence\",\"startOfSubSentence\"))\r\n    ).then(res => res[0])\r\n\r\nlet TEXT_STOP =  \r\n    $.every(\r\n        $.lastPos().then(res => [\r\n        {\r\n            labels:uniq((res.data.labels || []).concat([\"endOfSubSentence\",\"endOfSentence\",\"endOfParagraph\",\"endOfText\"])),\r\n            value: res.data.value\r\n        }\r\n        ]),\r\n        $(hasLabels),\r\n        $(notHasSomeLabels(\"endOfText\",\"endOfParagraph\",\"endOfSentence\",\"endOfSubSentence\"))\r\n    ).then(res => res[0])\r\n\r\nlet DOTTED_ABBR_EOSENTENCE = \r\n    $.every(\r\n        $.sequence(\r\n            $(hasEveryLabels(\"abbreviation\",\"withDot\")),\r\n            $(hasSomeValues(\" \")),\r\n            $.every(\r\n                $(notHasEveryLabels(\"abbreviation\")),\r\n                $(hasEveryLabels(\"word\")),\r\n                $(token => token.data.value == capitalize(token.data.value))\r\n            ).then(res => res[0])\r\n        ).then( res => [\r\n            {\r\n                labels: res[0].data.labels.concat([\"endOfSubSentence\",\"endOfSentence\"]),\r\n                value: res[0].data.value\r\n            },\r\n            res[1].data,\r\n            res[2].data\r\n        ]),\r\n        $(stage(2))\r\n    ).then( res => res[0])\r\n\r\nlet SUBSENTENCE_START = \r\n        $.sequence(\r\n            $(hasEveryLabels(\"endOfSubSentence\")),\r\n            $(notHasEveryLabels(\"startOfSubSentence\",\"endOfParagraph\")),\r\n        ).then( res => [\r\n            res[0].data,\r\n            {\r\n                labels:res[1].data.labels.concat([\"startOfSubSentence\"]),\r\n                value:res[1].data.value\r\n            }\r\n        ])\r\n\r\nlet SENTENCE_START = \r\n        $.sequence(\r\n            $(hasEveryLabels(\"endOfSentence\")),\r\n            $(notHasEveryLabels(\"startOfSentence\",\"endOfParagraph\")),\r\n        ).then( res => [\r\n            res[0].data,\r\n            {\r\n                labels:res[1].data.labels.concat([\"startOfSentence\"]),\r\n                value:res[1].data.value\r\n            }\r\n        ])\r\n\r\nlet PARAGRAPH_START = \r\n        $.sequence(\r\n            $(hasEveryLabels(\"endOfParagraph\")),\r\n            $(notHasSomeLabels(\"startOfParagraph\")),\r\n        ).then( res => [\r\n            res[0].data,\r\n            {\r\n                labels:res[1].data.labels.concat([\"startOfParagraph\"]),\r\n                value:res[1].data.value\r\n            }\r\n        ])\r\n\r\nlet DUBLE_EOP = \r\n    $.sequence(\r\n        $(hasEveryLabels(\"endOfSubSentence\",\"endOfSentence\")),\r\n        $(hasEveryLabels(\"endOfSubSentence\",\"endOfSentence\",\"endOfParagraph\"))\r\n    ).then( res => [\r\n        {\r\n            labels:res[0].data.labels.filter(l => (l != \"endOfSubSentence\") && (l != \"endOfSentence\")),\r\n            value:res[0].data.value\r\n        },\r\n        res[1].data\r\n    ])\r\n\r\nlet SHIFT_EOSS = \r\n    $.sequence(\r\n        $.every(\r\n            $(hasSomeLabels(\"word\",\"abbreviation\")),\r\n            $.not($(hasSomeLabels(\"endOfSubSentence\")))\r\n        ).then( res => {\r\n           return res[0]\r\n        }),\r\n        $(hasEveryLabels(\"endOfSubSentence\"))\r\n    ).then(res => {\r\n        return [\r\n            {\r\n                labels: res[0].data.labels.concat([\"endOfSubSentence\"]),\r\n                value: res[0].data.value\r\n            },\r\n            {\r\n                labels: res[1].data.labels.slice(res[1].data.labels.indexOf(\"endOfSubSentence\"),1),\r\n                value: res[1].data.value\r\n            }\r\n        ]\r\n    })\r\n\r\n\r\n\r\nexport default {\r\n    tokens:[\r\n        LABELS,\r\n    \tDOTTED_ABBR,\r\n        DATE,\r\n        NUMBERS,\r\n        COMPLEX_WORD,\r\n        INITIAL,\r\n        DOTTED_ABBR_EOSENTENCE\r\n    ],\r\n    sentences:[\r\n        TEXT_START,\r\n        PARAGRAPH_START,\r\n        SENTENCE_START,\r\n        SUBSENTENCE_START,\r\n        DUBLE_EOP,\r\n        TEXT_STOP\r\n    ]\r\n};","import { keys } from 'lodash';\r\nimport t from './raw_tokenizer_uk';\r\nimport parse from './parser';\r\nimport grammar from './grammar';\r\nimport { v4 as uuid } from 'uuid';\r\n\r\nconst emptyTom = {\r\n    \"id\": uuid(),\r\n    \"type\": \"text\",\r\n    \"childs\": [],\r\n    \"value\": \"\",\r\n    \"concept\": \"SYNTAX\"\r\n}\r\n\r\n\r\nconst res = sample => {\r\n\r\n    if (!sample) return new Promise(resolve => {\r\n        resolve(emptyTom)\r\n    })\r\n\r\n    sample = sample\r\n        .replace(/(\\r\\n)+/gm,\"\\n\")\r\n        .split(/\\n/gm)\r\n        .filter(l => l)\r\n        //.map(l => l.trim().replace(/\\ {2,}/gm, \" \"))\r\n        // .filter(l => l)\r\n        .join(\"\\n\")\r\n        // .replace(/\\s{2,}/gm, \" \")\r\n// console.log(sample)   \r\n\r\n    let createStructure = tokens => {\r\n\r\n        let text, p, s, ss\r\n\r\n        let start = 0\r\n\r\n        let rules = {\r\n\r\n            startOfText: item => {\r\n                text = {\r\n                    id: uuid(),\r\n                    type: \"text\",\r\n                    childs: [],\r\n                    pos: [start]\r\n                }\r\n            },\r\n\r\n            startOfParagraph: item => {\r\n                p = {\r\n                    id: uuid(),\r\n                    type: \"paragraph\",\r\n                    childs: [],\r\n                    pos: [start]\r\n                }\r\n            },\r\n\r\n            startOfSentence: item => {\r\n                s = {\r\n                    id: uuid(),\r\n                    type: \"sentence\",\r\n                    childs: [],\r\n                    pos: [start]\r\n                }\r\n                p.childs.push(s)\r\n            },\r\n\r\n            startOfSubSentence: item => {\r\n                ss = {\r\n                    id: uuid(),\r\n                    type: \"subSentence\",\r\n                    childs: [],\r\n                    pos: [start]\r\n                }\r\n                s.childs.push(ss)\r\n            },\r\n\r\n            word: item => {\r\n\r\n                ss.childs.push({\r\n                    id: uuid(),\r\n                    type: \"word\",\r\n                    value: item.value,\r\n                    pos: [start, start + item.value.length - 1]\r\n                })\r\n\r\n                start += item.value.length\r\n\r\n            },\r\n\r\n            number: item => {\r\n                ss.childs.push({\r\n                    id: uuid(),\r\n                    type: \"number\",\r\n                    value: item.value,\r\n                    pos: [start, start + item.value.length - 1]\r\n                })\r\n\r\n                start += item.value.length\r\n\r\n            },\r\n\r\n            date: item => {\r\n                ss.childs.push({\r\n                    id: uuid(),\r\n                    type: \"date\",\r\n                    value: item.value,\r\n                    pos: [start, start + item.value.length - 1]\r\n                })\r\n\r\n                start += item.value.length\r\n\r\n            },\r\n\r\n            time: item => {\r\n                ss.childs.push({\r\n                    id: uuid(),\r\n                    type: \"time\",\r\n                    value: item.value,\r\n                    pos: [start, start + item.value.length - 1]\r\n                })\r\n\r\n                start += item.value.length\r\n\r\n            },\r\n\r\n            endOfSubSentence: item => {\r\n                ss.value = ss.childs.map(item => item.value).join(\"\")\r\n                ss.pos.push(ss.pos[0] + ss.value.length - 1)\r\n                start = 0\r\n                if (ss.value.trim() == \"\") {\r\n                    s.childs.splice(s.childs.length - 1, 1)\r\n                    s.childs = s.childs.concat(ss.childs)\r\n                }\r\n            },\r\n\r\n            endOfSentence: item => {\r\n                s.value = s.childs.map(item => item.value).join(\"\")\r\n                s.pos.push(s.pos[0] + s.value.length - 1)\r\n\r\n            },\r\n\r\n            endOfParagraph: item => {\r\n                p.value = p.childs.map(item => item.value).join(\"\")\r\n                text.childs.push(p)\r\n                p.pos.push(p.pos[0] + p.value.length - 1)\r\n\r\n            },\r\n\r\n            endOfText: item => {\r\n                text.value = text.childs.map(item => item.value).join(\"\")\r\n                text.pos.push(text.pos[0] + text.value.length - 1)\r\n\r\n            },\r\n\r\n            whitespace: item => {\r\n                if (item.labels.indexOf(\"punctuation\") >= 0) {\r\n                    s.childs.push({\r\n                        id: uuid(),\r\n                        type: \"punctuation\",\r\n                        value: item.value,\r\n                        pos: [start, start + item.value.length - 1]\r\n                    })\r\n                    start += item.value.length\r\n                } else {\r\n                    ss.childs.push({\r\n                        id: uuid(),\r\n                        type: \"whitespace\",\r\n                        value: item.value,\r\n                        pos: [start, start + item.value.length - 1]\r\n                    })\r\n                    start += item.value.length\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n\r\n        tokens.forEach(token => {\r\n            keys(rules).forEach(r => {\r\n                if (token.labels.indexOf(r) >= 0) {\r\n                    rules[r](token)\r\n                }\r\n            })\r\n        })\r\n\r\n        return text\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    let tokens = t(sample)\r\n\r\n    if (tokens.length == 0) {\r\n        return new Promise(resolve => {\r\n            resolve(emptyTom)\r\n        })\r\n    } else {\r\n        return parse(tokens, grammar.tokens)\r\n            .then(tokens => {\r\n                return parse(tokens, grammar.sentences)\r\n            })\r\n            .then(tokens => {\r\n                return createStructure(tokens)\r\n            })\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default res","import { isFunction, isArray, find, last, drop, findIndex, take, flatten } from \"lodash\"\r\nimport Diff from \"@netilon/differify\"\r\nimport * as se from \"./sentence-extractor/index.js\"\r\nimport { v4 as uuid } from 'uuid';\r\nimport tinycolor from \"./tinycolor.js\"\r\n\r\n\r\nlet forEachNode = (node, beforeAction, afterAction) => {\r\n    if (beforeAction && isFunction(beforeAction)) beforeAction(node)\r\n    if (node.childs && isArray(node.childs)) node.childs.forEach(n => {\r\n        forEachNode(n, beforeAction, afterAction)\r\n    })\r\n    if (afterAction && isFunction(afterAction)) afterAction(node)\r\n}\r\n\r\n\r\n\r\nlet findNode = (node, test) => {\r\n    if (test(node)) return node\r\n    if (node.childs && isArray(node.childs))\r\n        for (let index in node.childs) {\r\n            let res = findNode(node.childs[index], test)\r\n            if (res) return res\r\n        }\r\n    return null\r\n}\r\n\r\nlet selectNodes = (node, test, selection) => {\r\n    selection = selection || []\r\n    if (test(node)) selection.push(node)\r\n    if (node.childs && isArray(node.childs))\r\n        for (let index in node.childs) {\r\n            selectNodes(node.childs[index], test, selection)\r\n        }\r\n    return selection\r\n}\r\n\r\nlet replaceNode = (tom, id, node) => {\r\n    let f = findNode(tom, n => n.id == id)\r\n    if (!f) return\r\n    let parent = getParent(f, tom)\r\n    let index = findIndex(parent.childs, node => node.id == f.id)\r\n    let childs = parent.childs.splice(index, 1, node)\r\n}\r\n\r\nlet replaceNodeByContent = (tom, node) => {\r\n    let f = findNode(tom, n => n.value == node.value)\r\n    if (!f) return\r\n    let parent = getParent(f, tom)\r\n    let index = findIndex(parent.childs, node => node.id == f.id)\r\n    let childs = parent.childs.splice(index, 1, node)\r\n}\r\n\r\nlet getParent = (node, root) => {\r\n    // return findNode(root, n => n.childs && find(n.childs, item => diff.compare(item, node).status == \"EQUAL\"))\r\n    return findNode(root, n => n.childs && find(n.childs, item => item.id == node.id))\r\n    \r\n\r\n\r\n    // if(root){\r\n    // return findNode(root, n => n.childs && find(n.childs, item => diff.compare(item, node).status == \"EQUAL\"))\r\n    // } else {\r\n    //   return node._tom_parent\r\n    // }\r\n\r\n} //item => item.id == node.id))\r\n\r\nlet getSiblings = (node, root) => {\r\n    let parent = getParent(node, root)\r\n    return (parent) ? parent.childs : []\r\n}\r\n\r\nlet getStyle = (element, property) => {\r\n    return window.getComputedStyle ?\r\n        window.getComputedStyle(element, null).getPropertyValue(property) :\r\n        element.style[property.replace(/-([a-z])/g, function(g) { return g[1].toUpperCase(); })];\r\n}\r\n\r\n\r\n\r\n//--------------------------------- diff -----------------------------------------------\r\n\r\n\r\nlet diff = new Diff({ mode: { object: \"DIFF\", array: \"DIFF\" } })\r\n\r\nlet originalBranchName = \"original\"\r\nlet currentBranchName = \"current\"\r\n\r\n\r\nlet tom2Plain = node => {\r\n\r\n    let syntaxNode = [\"word\", \"text\", \"paragraph\", \"sentence\", \"subSentence\", \"number\", \"whitespace\", \"punctuation\"]\r\n    let versionNode = [\"DIFF\", \"BRANCH\"]\r\n\r\n    forEachNode(node, n => {\r\n        n.concept = (syntaxNode.includes(n.type)) ? \"SYNTAX\" : (versionNode.includes(n.type)) ? \"VERSION\" : \"SEMANTIC\"\r\n    })\r\n\r\n\r\n    let res = []\r\n    let i = 0;\r\n    forEachNode(node, n => {\r\n        if (n.childs) {\r\n            res.push({ action: \"START\", concept: n.concept, type: n.type, value: n.value, name: n.name })\r\n        } else {\r\n            res.push({ action: \"TERMINAL\", concept: n.concept, type: n.type, value: n.value, terminalIndex: i++ })\r\n        }\r\n    }, n => {\r\n        if (n.childs) {\r\n            res.push({ action: \"STOP\", concept: n.concept, type: n.type, name: n.name })\r\n        }\r\n    })\r\n    return res\r\n}\r\n\r\nlet plain2Tom = (data, parentStack) => {\r\n\r\n    if (data.length == 0) return\r\n\r\n    parentStack = parentStack || []\r\n\r\n    let node = data[0]\r\n\r\n    if (node.terminalIndex) {\r\n        delete node.terminalIndex\r\n    }\r\n\r\n    let parent = last(parentStack)\r\n\r\n    switch (node.action) {\r\n\r\n        case \"START\":\r\n            node.childs = []\r\n            parentStack.push(node)\r\n            if (parent) {\r\n                parent.childs.push(node)\r\n            }\r\n            plain2Tom(drop(data), parentStack)\r\n            break\r\n\r\n        case \"TERMINAL\":\r\n            if (parent) {\r\n                parent.childs.push(node)\r\n            }\r\n            plain2Tom(drop(data), parentStack)\r\n            break\r\n\r\n        case \"STOP\":\r\n            parentStack.pop()\r\n            plain2Tom(drop(data), parentStack)\r\n            break\r\n\r\n    }\r\n\r\n    // markParents(node)\r\n    return node\r\n}\r\n\r\n\r\nlet isAnnotationOpened = branch => {\r\n    let c = 0\r\n    branch.forEach((item, index) => {\r\n        if (item.action == \"START\" && item.concept == \"SEMANTIC\") {\r\n            c++\r\n            return\r\n        }\r\n        if (item.action == \"STOP\" && item.concept == \"SEMANTIC\") {\r\n            c--\r\n            return\r\n        }\r\n    })\r\n    return c > 0\r\n}\r\n\r\nlet takeSegment = (fragment, stopped) => {\r\n    let i = findIndex(fragment.source, stopped)\r\n    let slice = take(fragment.source, i + 1)\r\n    fragment.source = drop(fragment.source, slice.length)\r\n    fragment.branch = fragment.branch.concat(slice)\r\n    return fragment\r\n}\r\n\r\nlet segmentBranches = (original, current) => {\r\n\r\n    if (isAnnotationOpened(original.branch)) {\r\n        original = takeSegment(original, item => item.action == \"STOP\" && item.concept == \"SEMANTIC\")\r\n        current = takeSegment(current, item => diff.compare(original.branch[original.branch.length - 2], item).status == \"EQUAL\")\r\n        let res = segmentBranches(current, original)\r\n        return {\r\n            current: res.original,\r\n            original: res.current\r\n        }\r\n    }\r\n\r\n    if (isAnnotationOpened(current.branch)) {\r\n        let res = segmentBranches(current, original)\r\n        return {\r\n            current: res.original,\r\n            original: res.current\r\n        }\r\n    }\r\n\r\n\r\n    if (original.branch[0].concept == \"SEMANTIC\" && current.branch[0].concept == \"SEMANTIC\") {\r\n\r\n        if (diff.compare(original.source[0], current.source[0]).status == \"EQUAL\" &&\r\n            !isAnnotationOpened(original.branch) &&\r\n            !isAnnotationOpened(current.branch)\r\n        ) {\r\n\r\n            return {\r\n                current,\r\n                original\r\n            }\r\n\r\n        }\r\n\r\n\r\n        if (original.branch.length > current.branch.length) {\r\n            let suffix = takeSegment(current, item => diff.compare(original.branch[original.branch.length - 2], item).status == \"EQUAL\")\r\n\r\n            let res = segmentBranches(original, suffix)\r\n            return {\r\n                current: res.current,\r\n                original: res.original\r\n            }\r\n\r\n        }\r\n\r\n        if (original.branch.length < current.branch.length) {\r\n            let res = segmentBranches(current, original)\r\n            return {\r\n                current: res.original,\r\n                original: res.current\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n    return {\r\n        original,\r\n        current\r\n    }\r\n\r\n}\r\n\r\nlet diffSequence = data => [{ action: \"START\", type: \"DIFF\" }, { action: \"START\", type: \"BRANCH\", name: originalBranchName }]\r\n    .concat(data.original.branch)\r\n    .concat([{ action: \"STOP\", type: \"BRANCH\", name: originalBranchName }, { action: \"START\", type: \"BRANCH\", name: currentBranchName }])\r\n    .concat(data.current.branch)\r\n    .concat([{ action: \"STOP\", type: \"BRANCH\", name: currentBranchName }, { action: \"STOP\", type: \"DIFF\" }])\r\n\r\n\r\n\r\nlet getDifferenceTom = (d1, d2) => {\r\n    originalBranchName = d1.branch || \"original\"\r\n    currentBranchName = d2.branch || \"current\"\r\n\r\n\r\n    let l1 = tom2Plain(d1)\r\n    let l2 = tom2Plain(d2)\r\n\r\n    let res = []\r\n    let c = true\r\n    for (; l2.length > 0 && l1.length > 0 && c;) {\r\n\r\n\r\n        if (l1[0].concept == \"SYNTAX\" && diff.compare(l1[0], l2[0]).status == \"EQUAL\") {\r\n            res.push(l1[0])\r\n            l1 = drop(l1)\r\n            l2 = drop(l2)\r\n            continue\r\n        }\r\n\r\n        if (\r\n            (l1[0].concept == \"SYNTAX\" && l2[0].concept == \"SEMANTIC\") ||\r\n            (l2[0].concept == \"SYNTAX\" && l1[0].concept == \"SEMANTIC\")\r\n        ) {\r\n\r\n            let b1 = [l1[0]]\r\n            let b2 = [l2[0]]\r\n            let tres = segmentBranches({\r\n                source: drop(l1),\r\n                branch: b1\r\n            }, {\r\n                source: drop(l2),\r\n                branch: b2\r\n            })\r\n            l1 = tres.original.source\r\n            l2 = tres.current.source\r\n\r\n            res = res.concat(diffSequence(tres))\r\n            continue\r\n        }\r\n\r\n        if (l1[0].concept == \"SEMANTIC\" && l2[0].concept == \"SEMANTIC\") {\r\n            let f1 = takeSegment({ source: l1, branch: [] }, item => item.action == \"STOP\" && item.concept == \"SEMANTIC\")\r\n            let f2 = takeSegment({ source: l2, branch: [] }, item => item.action == \"STOP\" && item.concept == \"SEMANTIC\")\r\n\r\n            if (diff.compare(f1.branch, f2.branch).status == \"EQUAL\") {\r\n                res = res.concat(f1.branch)\r\n                l1 = drop(l1, f1.branch.length)\r\n                l2 = drop(l2, f1.branch.length)\r\n            } else {\r\n\r\n                let tres = segmentBranches(f1, f2)\r\n\r\n                l1 = tres.original.source\r\n                l2 = tres.current.source\r\n\r\n                res = res.concat(diffSequence(tres))\r\n\r\n            }\r\n            continue\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n    return plain2Tom(res)\r\n}\r\n\r\nlet EQUAL_STARTEGY = (src, dest) => null\r\n\r\nlet OVERRIDE_STRATEGY = (src, dest) => src.childs\r\n\r\nlet UNION_STRATEGY = (src, dest) => {\r\n    if (src.childs.length == 1 &&\r\n        src.childs[0].concept == \"SEMANTIC\" &&\r\n        dest.childs.length == src.childs[0].childs.length &&\r\n        !find(dest.childs, n => n.concept == \"SEMANTIC\")\r\n    ) return src.childs\r\n\r\n    if (dest.childs.length == 1 &&\r\n        dest.childs[0].concept == \"SEMANTIC\" &&\r\n        src.childs.length == dest.childs[0].childs.length &&\r\n        !find(src.childs, n => n.concept == \"SEMANTIC\")\r\n    ) return dest.childs\r\n\r\n    return null\r\n\r\n}\r\n\r\n\r\n\r\nlet mergeDiff = (diff, strategy) => {\r\n    // diff must be DIFF node\r\n    let destination = diff.childs[0]\r\n    let source = diff.childs[1]\r\n    strategy = strategy || EQUAL_STARTEGY\r\n    // strategy returns array of TOM nodes\r\n    return strategy(source, destination)\r\n}\r\n\r\nlet mergeTom = (tom, strategy) => {\r\n    forEachNode(tom, node => {\r\n        if (node.type == \"DIFF\") {\r\n            let merged = mergeDiff(node, strategy)\r\n            if (merged) {\r\n                let parent = getParent(node, tom)\r\n                parent.childs.splice(\r\n                    findIndex(parent.childs, n => diff.compare(node, n).status == \"EQUAL\"),\r\n                    1,\r\n                    merged\r\n                )\r\n\r\n                parent.childs = flatten(parent.childs)\r\n            }\r\n        }\r\n    })\r\n    return tom\r\n}\r\n\r\nlet resolveStrategies = {\r\n    EQUAL: EQUAL_STARTEGY,\r\n    OVERRIDE: OVERRIDE_STRATEGY,\r\n    UNION: UNION_STRATEGY\r\n}\r\n\r\nlet tokenize = se.tokenize\r\n\r\nlet extractSentences = text => se.extractSentences(text)\r\n    .then(res => {\r\n        // console.log(\"TOM\", res)\r\n        forEachNode(res, node => {\r\n            node.concept = \"SYNTAX\"\r\n        })\r\n        return res\r\n    })\r\n\r\n\r\nlet markParents = (node, parent) => {\r\n    // console.log(\"!!!\",node, parent)\r\n    node._tom_parent = parent\r\n    if (node.childs && isArray(node.childs)) node.childs.forEach(n => {\r\n        markParents(n, node)\r\n    })\r\n}\r\n\r\n\r\n// let createAnnotation = (tom, annotation) => {\r\n//       annotation.text = tom.value.substring(annotation.pos[0],annotation.pos[1]+1)\r\n//       if(!annotation.text) return tom\r\n//       let selection = findNode(tom, node => node.value == annotation.text)\r\n//       if(!selection) return tom\r\n//       let parent = getParent(selection, tom)\r\n//       let index = findIndex(parent.childs, node => node.id == selection.id)\r\n//       let childs = parent.childs.splice(index,1)\r\n\r\n\r\n//       let newAnnotation = {\r\n//         type: annotation.type,\r\n//         childs,\r\n//         id: uuid(),\r\n//         concept:\"SEMANTIC\",\r\n//         value: childs.map(node => node.value).join(\"\"),\r\n//         pos:[childs[0].pos[0],childs[childs.length-1].pos[1]] \r\n//       }\r\n\r\n//       parent.childs.splice(index, 0, newAnnotation)\r\n//       // markParents(tom)\r\n//       return tom\r\n// }\r\n\r\n\r\nlet includes = (outer, inner) => outer[0] <= inner[0] && inner[1] <= outer[1]\r\n\r\nlet nestedIn = (tom, node, nesting) => {\r\n  let p = getParent(node,tom)\r\n  if(!p) return false\r\n  return nesting.includes(p.type)  \r\n}  \r\n\r\nlet createAnnotation = (tom, annotation) => {\r\n    let selection = selectNodes(tom, node => includes(annotation.pos, node.pos) && nestedIn(tom,node,annotation.nestedIn))\r\n    \r\n    if (selection.length == 0) return\r\n\r\n    let parent = getParent(selection[0], tom)\r\n    let start = findIndex(parent.childs, node => node.id == selection[0].id)\r\n    let stop = findIndex(parent.childs, node => node.id == selection[selection.length - 1].id)\r\n    let childs = parent.childs.splice(start, stop - start + 1)\r\n\r\n\r\n    let newAnnotation = {\r\n        id: uuid(),\r\n        type: annotation.type,\r\n        childs,\r\n        concept: \"SEMANTIC\",\r\n        pos: [childs[0].pos[0], childs[childs.length - 1].pos[1]],\r\n        value: childs.map(node => node.value).join(\"\")\r\n    }\r\n\r\n    parent.childs.splice(start, 0, newAnnotation)\r\n\r\n\r\n}\r\n\r\n\r\n\r\nlet buildTom = opts => extractSentences(opts.text)\r\n    .then(tom => {\r\n        // console.log(JSON.stringify(tom, null,\" \"))\r\n        if (opts.entities) {\r\n            opts.entities.forEach(e => {\r\n                createAnnotation(tom, e)\r\n            })\r\n        }\r\n\r\n        // markParents(tom)\r\n\r\n        return tom\r\n    })\r\n\r\n\r\nlet buildText = root => {\r\n    let entities = selectNodes(root, node => node.concept == \"SEMANTIC\")\r\n    return {\r\n        id: root.id,\r\n        node: root.type,\r\n        concept: root.concept,\r\n        text: root.value,\r\n        entities: entities.map(e => ({\r\n            type: e.type,\r\n            pos: [e.pos[0] - root.pos[0], e.pos[1] - root.pos[0]]\r\n        }))\r\n    }\r\n}\r\n\r\n\r\nexport {\r\n\r\n    forEachNode,\r\n    findNode,\r\n    replaceNode,\r\n    replaceNodeByContent,\r\n    selectNodes,\r\n    getParent,\r\n    getSiblings,\r\n    getStyle,\r\n    getDifferenceTom,\r\n    plain2Tom,\r\n    tom2Plain,\r\n    mergeTom,\r\n    EQUAL_STARTEGY,\r\n    OVERRIDE_STRATEGY,\r\n    UNION_STRATEGY,\r\n    resolveStrategies,\r\n    tokenize,\r\n    extractSentences,\r\n    buildTom,\r\n    buildText,\r\n    tinycolor\r\n\r\n}","!function(n,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"Differify\",[],t):\"object\"==typeof exports?exports.Differify=t():n.Differify=t()}(this,(function(){return function(n){var t={};function r(e){if(t[e])return t[e].exports;var o=t[e]={i:e,l:!1,exports:{}};return n[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=n,r.c=t,r.d=function(n,t,e){r.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:e})},r.r=function(n){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(n,\"__esModule\",{value:!0})},r.t=function(n,t){if(1&t&&(n=r(n)),8&t)return n;if(4&t&&\"object\"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,\"default\",{enumerable:!0,value:n}),2&t&&\"string\"!=typeof n)for(var o in n)r.d(e,o,function(t){return n[t]}.bind(null,o));return e},r.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(t,\"a\",t),t},r.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},r.p=\"\",r(r.s=0)}([function(n,t,r){\"use strict\";var e;r.r(t),function(n){n.REFERENCE=\"REFERENCE\",n.DIFF=\"DIFF\",n.STRING=\"STRING\"}(e||(e={}));var o,u=e;function i(n){return(i=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&\"function\"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?\"symbol\":typeof n})(n)}function f(n){return n&&!Array.isArray(n)&&\"object\"===i(n)}function c(n){return n&&\"string\"==typeof n&&n.length>0}function a(n,t){return n.hasOwnProperty?n.hasOwnProperty(t):void 0!==n[t]}function l(n,t,r,e){return void 0===e&&(e=0),{original:n,current:t,status:r,changes:e}}function s(n,t,r){return void 0===r&&(r=0),{_:n,status:t,changes:r}}function p(n){if(this.compareArraysInOrder=!0,this.mode={array:u.DIFF,object:u.DIFF,function:u.REFERENCE},f(n)&&(\"boolean\"==typeof n.compareArraysInOrder&&(this.compareArraysInOrder=n.compareArraysInOrder),f(n.mode))){var t=Object.values(u);if(c(n.mode.array)){var r=n.mode.array.toUpperCase();void 0!==t.find((function(n){return n===r}))&&(this.mode.array=r)}if(c(n.mode.object)){var e=n.mode.object.toUpperCase();void 0!==t.find((function(n){return n===e}))&&(this.mode.object=e)}if(c(n.mode.function)){var o=n.mode.function.toUpperCase();o!==u.REFERENCE&&o!==u.STRING||(this.mode.function=o)}}}!function(n){n.ADDED=\"ADDED\",n.DELETED=\"DELETED\",n.MODIFIED=\"MODIFIED\",n.EQUAL=\"EQUAL\"}(o||(o={}));var y=o;function g(n,t){return n===t?l(n,t,y.EQUAL):l(n,t,y.MODIFIED,1)}function E(n,t){return n.getTime()===t.getTime()?l(n,t,y.EQUAL):l(n,t,y.MODIFIED,1)}function h(n,t){return n.toString()===t.toString()?l(n,t,y.EQUAL):l(n,t,y.MODIFIED,1)}function b(n){return(b=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&\"function\"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?\"symbol\":typeof n})(n)}function D(){var n={string:null,number:null,boolean:null,function:null,object:null},t={};function r(t,r){if(t===r)return l(t,r,y.EQUAL);var e=b(t);if(e!==b(r))return l(t,r,y.MODIFIED,1);var o=n[e];return o?o(t,r):g(t,r)}function e(n,r){var e=Object.prototype.toString.call(n);if(e===Object.prototype.toString.call(r)){var o=t[e];return o?o(n,r):g(n,r)}return l(n,r,y.MODIFIED,1)}return{multipleComparatorSelector:r,deepComparatorSelector:e,getComparatorByType:function(t){return n[t]},configure:function(o){var i,f={};f[u.DIFF]=(i=r,function(n,t){var r={},e=0,o=0,u=0;for(var f in n)a(n,f)&&(++e,a(t,f)?r[f]=i(n[f],t[f]):r[f]=l(n[f],null,y.DELETED,1),u+=r[f].changes);for(var c in t)a(t,c)&&(++o,a(n,c)||(r[c]=l(null,t[c],y.ADDED,1),u+=r[c].changes));return 0===e&&0===o?s(null,y.EQUAL,u):s(r,u>0?y.MODIFIED:y.EQUAL,u)}),f[u.REFERENCE]=function(n,t){var r=g(n,t);return s(null,r.status,r.changes)},f[u.STRING]=function(n,t){var r=function(n,t){return JSON.stringify(n)===JSON.stringify(t)?l(n,t,y.EQUAL):l(n,t,y.MODIFIED,1)}(n,t);return s(null,r.status,r.changes)};var c={};c[u.DIFF]=o.compareArraysInOrder?function(n){return function(t,r){var e,o,u=0;t.length>r.length||t.length===r.length?(e=t,o=r,u=-1):(e=r,o=t,u=1);var i,f=[],c=0;for(i=0;i<o.length;++i)f.push(n(t[i],r[i])),c+=f[i].changes||0;if(-1===u)for(;i<e.length;++i)f.push(l(t[i],null,y.DELETED,1)),++c;else if(1===u)for(;i<e.length;++i)f.push(l(null,r[i],y.ADDED,1)),++c;return s(f,c>0?y.MODIFIED:y.EQUAL,c)}}(r):function(n){return function(t,r){var e;e=t.length>=r.length?t:r;var o,u,i,f,c,a,p=0,g=[],E=Object.create(null);for(o=0;o<e.length;++o)o<t.length&&(f=t[o],void 0!==(a=E[u=JSON.stringify(f)])&&a.length>0?null!==(c=a[a.length-1]).b?(i=n(f,c.b),g.push(i),a.pop(),0===a.length&&delete E[u]):a.unshift({a:f,b:null}):E[u]=[{a:f,b:null}]),o<r.length&&(f=r[o],void 0!==(a=E[u=JSON.stringify(f)])&&a.length>0?null!==(c=a[a.length-1]).a?(i=n(c.a,f),g.push(i),a.pop(),0===a.length&&delete E[u]):a.unshift({a:null,b:f}):E[u]=[{a:null,b:f}]);var h=Object.create(null);for(var b in h.a=[],h.b=[],E){a=E[b];for(var D=0;D<a.length;++D)(c=a[D]).a?h.b.length>0?(p+=(i=n(c.a,h.b.pop())).changes,g.push(i)):h.a.unshift(c.a):c.b&&(h.a.length>0?(p+=(i=n(h.a.pop(),c.b)).changes,g.push(i)):h.b.unshift(c.b))}for(var m=h.a.length-1;m>-1;--m)g.push(l(h.a[m],null,y.DELETED,1)),++p;for(var d=h.b.length-1;d>-1;--d)g.push(l(null,h.b[d],y.ADDED,1)),++p;return s(g,p>0?y.MODIFIED:y.EQUAL,p)}}(r),c[u.REFERENCE]=function(n,t){var r=g(n,t);return s(null,r.status,r.changes)},c[u.STRING]=function(n,t){var r,e,o=(e=t,(r=n).length===e.length&&JSON.stringify(r)===JSON.stringify(e)?l(r,e,y.EQUAL):l(r,e,y.MODIFIED,1));return s(null,o.status,o.changes)};var p={};p[u.REFERENCE]=g,p[u.STRING]=h,n.string=g,n.number=g,n.boolean=g,n.function=p[o.mode.function],n.object=e,t[\"[object Array]\"]=c[o.mode.array],t[\"[object Date]\"]=E,t[\"[object Object]\"]=f[o.mode.object]}}}function m(n){return(m=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&\"function\"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?\"symbol\":typeof n})(n)}var d=function(){return(d=Object.assign||function(n){for(var t,r=1,e=arguments.length;r<e;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)},v=Symbol(\"invalid\");function I(n,t){return t===v?Array.isArray(n)?[]:{}:t}var O=function(n,t){if((u=n)&&Array.isArray(u)){for(var r=[],e=void 0,o=0;o<n.length;o++)(e=t(n[o]))!==v&&r.push(e);return 0===r.length?v:r}var u;if(\"object\"===m(n)){var i={},f=(e=void 0,!1);for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e=t(n[o]))!==v&&(i[o]=e,f=!0);return f?i:v}return t(n)},S=function n(t){return t._?O(t._,n):t.status===y.DELETED?t.original:t.current},F=function n(t){return t._?O(t._,n):t.status===y.ADDED?t.current:t.original},A=function(n){return function t(r){return r._&&r.changes>0?O(r._,t):r.status===y.EQUAL?v:n(r)}},j=function(n){return n.mode.object===u.DIFF&&n.mode.array===u.DIFF},_=function(n){return n&&\"original\"in n&&\"current\"in n&&\"status\"in n},L=function(){function n(n){var t=this;this.compSelector=D(),this.config=null,this.setConfig=function(n){t.config=new p(n),t.compSelector.configure(t.config)},this.getConfig=function(){return{compareArraysInOrder:t.config.compareArraysInOrder,mode:d({},t.config.mode)}},this.compare=function(n,r){return function(n,t,r){var e=m(t);if(e!==m(r))return l(t,r,y.MODIFIED,1);var o=n.getComparatorByType(e);return o?o(t,r):g(t,r)}(t.compSelector,n,r)},this.applyLeftChanges=function(n,r){return void 0===r&&(r=!1),n&&n._&&j(t.config)?I(n._,O(n._,r?A(F):F)):_(n)?n.original:null},this.applyRightChanges=function(n,r){return void 0===r&&(r=!1),n&&n._&&j(t.config)?I(n._,O(n._,r?A(S):S)):_(n)?n.current:null},this.filterDiffByStatus=function(n,r,e){void 0===r&&(r=y.MODIFIED),void 0===e&&(e=!1);var o=function(n){if(\"string\"==typeof n){var t=n.toUpperCase().trim();return void 0!==Object.keys(y).find((function(n){return t===n}))?t:null}return null}(r);if(o&&n){if(n._&&j(t.config))return I(n._,O(n._,e?function(n){var t=n===y.EQUAL;return function r(e){return e._&&(t||e.changes>0)?O(e._,r):e.status===n?{current:e.current,original:e.original}:v}}(r):function(n){var t=n===y.DELETED?\"original\":\"current\",r=n===y.EQUAL;return function e(o){return o._&&(r||o.changes>0)?O(o._,e):o.status===n?o[t]:v}}(r)));if(_(n)&&n.status===o)return n}return null},this.config=new p(n),this.compSelector.configure(this.config)}return n.DIFF_MODES=u,n.PROPERTY_STATUS=y,n}();t.default=L}]).default}));","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[(_vm.data)?_c('tom',{attrs:{\"node\":_vm.data,\"options\":_vm.options},on:{\"show-tooltip\":_vm.showTooltip,\"hide-tooltip\":_vm.hideTooltip,\"show-menu\":_vm.displayMenu,\"select\":_vm.onSelect}}):_vm._e(),_c('v-tooltip',{attrs:{\"top\":\"\",\"position-x\":_vm.tt_x,\"position-y\":_vm.tt_y,\"value\":_vm.showTooltipModel,\"color\":\"rgba(0,0,0,0)\",\"open-delay\":\"500\",\"transition\":\"fade-transition\"}},[_c('div',{staticClass:\"caption pa-2 secondary--text\",staticStyle:{\"border-radius\":\"5px\",\"background\":\"#fff9c4\",\"box-shadow\":\"0 3px 3px -1px rgba(0,0,0,.2),0 6px 5px 0 rgba(0,0,0,.14),0 1px 9px 0 rgba(0,0,0,.12)!important\"},domProps:{\"innerHTML\":_vm._s(_vm.tooltipText)}})]),_c('v-menu',{attrs:{\"position-x\":_vm.menu_x,\"position-y\":_vm.menu_y,\"absolute\":\"\",\"offset-y\":\"\",\"dense\":\"\"},model:{value:(_vm.showMenu),callback:function ($$v) {_vm.showMenu=$$v},expression:\"showMenu\"}},[_c('v-list',{attrs:{\"dense\":\"\"}},[_c('v-list-item-group',{attrs:{\"color\":\"primary\"}},_vm._l((_vm.menu),function(item,i){return _c('v-list-item',{key:i,on:{\"click\":function($event){return item.action(_vm.selection)}}},[(!!item.icon)?_c('v-list-item-icon',{staticClass:\"mr-1\"},[_c('v-icon',{style:(`color:${_vm.tinycolor(item.color || '#aaaaaa').darken(30).toHexString()}`),domProps:{\"textContent\":_vm._s(item.icon)}})],1):_vm._e(),_c('v-list-item-content',[_c('v-list-item-title',{domProps:{\"textContent\":_vm._s(item.title)}})],1)],1)}),1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c((_vm.node.type == 'text') ? 'text-node' : (_vm.node.type == 'paragraph') ? 'paragraph-node' : (_vm.node.type == 'DIFF') ? 'diff': (_vm.node.type == 'BRANCH') ? 'branch' : 'node',{tag:\"component\",staticClass:\"tom no-select\",class:`${_vm.node.type} ${(_vm.selectable) ? 'selectable' : ''} ${(!!_vm.node.childs) ? 'node-container': ''} ${(_vm.selected) ? 'selected' : ''} ${_vm.classes}`,style:(_vm.nodeStyle),attrs:{\"id\":_vm.node.id}},[_c('span',{on:{\"mouseenter\":_vm.mouseEnter,\"mouseleave\":_vm.mouseLeave,\"contextmenu\":function($event){$event.preventDefault();return _vm.contextMenu.apply(null, arguments)},\"click\":function($event){$event.stopPropagation();return _vm.select.apply(null, arguments)}}},[(_vm.labeled)?_c('span',{staticClass:\"annotation\",style:(_vm.labelStyle)},[_vm._v(\"\\n        \"+_vm._s(_vm.label)+\"\\n      \")]):_vm._e(),_vm._l((_vm.node.childs),function(c){return (_vm.node.childs)?_c('tom',{attrs:{\"node\":c,\"parent\":_vm.node,\"options\":_vm.options},on:{\"show-tooltip\":_vm.propagateShowTooltip,\"hide-tooltip\":_vm.propagateHideTooltip,\"show-menu\":_vm.propagateShowMenu,\"select\":_vm.propagateSelect}}):_vm._e()}),_vm._v(\"\\n      \"+_vm._s(!(_vm.node.childs) ? (_vm.node.value == ' ') ? ' ' : _vm.node.value : '')+\"\\n    \")],2)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n      <component \r\n        :id=\"node.id\" \r\n        :is=\"(node.type == 'text') ? 'text-node' : (node.type == 'paragraph') ? 'paragraph-node' : (node.type == 'DIFF') ? 'diff': (node.type == 'BRANCH') ? 'branch' : 'node'\" \r\n        class=\"tom no-select\" \r\n        :class=\"`${node.type} ${(selectable) ? 'selectable' : ''} ${(!!node.childs) ? 'node-container': ''} ${(selected) ? 'selected' : ''} ${classes}`\"\r\n        :style=\"nodeStyle\"\r\n      >\r\n          <span\r\n            @mouseenter = \"mouseEnter\"\r\n            @mouseleave = \"mouseLeave\"\r\n            @contextmenu.prevent=\"contextMenu\"\r\n            @click.stop = \"select\" \r\n          >\r\n            <span \r\n              v-if=\"labeled\"\r\n              class=\"annotation\"\r\n              :style=\"labelStyle\"\r\n            >\r\n              {{label}}\r\n            </span>\r\n          \r\n        \r\n            <tom \r\n              v-if=\"node.childs\" \r\n              v-for=\"c in node.childs\" \r\n              :node=\"c\"\r\n              :parent=\"node\" \r\n              :options=\"options\"\r\n              @show-tooltip = \"propagateShowTooltip\"\r\n              @hide-tooltip = \"propagateHideTooltip\"\r\n              @show-menu = \"propagateShowMenu\"\r\n              @select = \"propagateSelect\"\r\n            ></tom>\r\n            {{!(node.childs) ? (node.value == ' ') ? '&nbsp;' : node.value : ''}}\r\n          </span>\r\n      </component>\r\n    \r\n</template>\r\n\r\n<script>\r\n\r\nimport tinycolor from \"./tinycolor.js\"\r\n\r\nexport default {\r\n\r\n  name: \"tom\",\r\n\r\n  props: [\"options\", \"node\", \"parent\"],\r\n\r\n  components: {\r\n    TextNode : () => import(\"./text-node.vue\"),\r\n    ParagraphNode : () => import(\"./paragraph-node.vue\"),\r\n    Node : () => import(\"./node.vue\"),\r\n    Diff: () => import(\"./diff.vue\"),\r\n    Branch: () => import(\"./branch.vue\")\r\n  },\r\n\r\n  computed: {\r\n    selectable(){\r\n      if(!this.options) return null\r\n      let options = this.options()\r\n      if (!options.selectable) return null\r\n      // if( this.parent &&  !!options.selectable(this.parent) && options.selectable(this.parent).includes(\"wrap\") ) return null  \r\n      return options.selectable(this.node)\r\n    },\r\n\r\n    selected(){\r\n      return this.node.selected\r\n    },\r\n\r\n    labeled(){\r\n      if(!this.options) return null\r\n      let options = this.options()\r\n      return options.label && !!options.label(this.node)\r\n    },\r\n\r\n    label(){\r\n      if(!this.options) return null\r\n      let options = this.options()\r\n      return (options.label) ? options.label(this.node) : \"\"\r\n    },\r\n\r\n    classes(){\r\n      if(!this.options) return null\r\n      let options = this.options()\r\n      return (options.classes) ? options.classes(this.node) : \"\" \r\n    },\r\n\r\n    labelStyle() {\r\n      if(!this.options) return null\r\n      let options = this.options()\r\n      let base = (options.color) ? options.color(this.node) : \"#ffffff\"\r\n      let tc = tinycolor(base).darken(50).toHexString()\r\n      let bdc = tinycolor(base).darken(10).toHexString()\r\n      return `color:${tc}; border-color:${bdc};`\r\n    },\r\n\r\n    nodeStyle() {\r\n      if(!this.options) return null\r\n      let options = this.options()\r\n      let base = (options.color) ? options.color(this.node) : \"#ffffff\"\r\n      return `background: ${(this.node.type ==\"DIFF\") ? base : base}; border-color:${tinycolor(base).darken(50).toHexString()};`\r\n    }\r\n    \r\n\r\n  },  \r\n  \r\n   data() {\r\n      return {\r\n          tooltip:true,\r\n      }\r\n  },\r\n  methods: {\r\n    \r\n    propagateShowTooltip(e){\r\n      this.$emit(\"show-tooltip\", e)\r\n    },\r\n\r\n    propagateHideTooltip(e){\r\n      this.$emit(\"hide-tooltip\", e)\r\n    },\r\n\r\n    propagateShowMenu(e){\r\n      this.$emit(\"show-menu\", e)\r\n    },\r\n\r\n    propagateSelect(e){\r\n      let options = this.options()\r\n      \r\n      if( options.selectable \r\n          && options.selectable(this.node) \r\n          && options.selectable(this.node).includes(\"wrap\")\r\n      ){\r\n        this.$emit(\"select\", {sender: this})  \r\n      } else {\r\n        this.$emit(\"select\", e)  \r\n      }\r\n      \r\n    },\r\n\r\n    emitMessage(msg, el){\r\n      this.$emit(msg, {\r\n        sender: this,\r\n        position: {\r\n          x: el.clientX,\r\n          y: el.clientY\r\n        }\r\n      })\r\n    },\r\n\r\n    contextMenu(e) {\r\n      this.emitMessage(\"show-menu\", e)\r\n    },\r\n\r\n    mouseEnter(e) {\r\n      this.emitMessage(\"show-tooltip\", e)\r\n    },\r\n    \r\n    mouseLeave(e) {\r\n      this.emitMessage(\"hide-tooltip\", e)\r\n    },\r\n\r\n    select(){\r\n      this.emitMessage(\"select\", this)\r\n    }\r\n    \r\n\r\n  }\r\n  \r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n  .selectable.selected {\r\n    /*border:2px solid !important;\r\n    margin: 0 0.25em 0 0;\r\n    padding:0 0.25em;\r\n*/\r\n    border: 2px solid #607D8B !important;\r\n    margin: 0 0.25em 0 0;\r\n    padding: 0 0.25em;\r\n    background: #cfd8dc;\r\n  }\r\n\r\n  .selectable {\r\n      cursor:pointer;\r\n      /*background:#ffffff;*/\r\n      /*border: solid 1px;*/\r\n  }\r\n\r\n  .annotation {\r\n      border: 2px solid;\r\n      border-radius: 5px;\r\n      font-size: 0.6em;\r\n      font-weight: 900;\r\n      padding: 0em 0.5em;\r\n      margin: 0em 0.5em 0.1em 0.5em;\r\n      background: white;\r\n      vertical-align: middle;\r\n      display: inline-block;\r\n      line-height: 1.2;\r\n  }\r\n\r\n  .tom {\r\n    /*margin: 0 0.25em 0 0;*/\r\n    /*padding:0 0.25em;*/\r\n  }\r\n\r\n  .node-container {\r\n    /*padding: 0.3em;*/\r\n    /*line-height: 2;*/\r\n  }\r\n\r\n  .no-select,\r\n  .no-select:focus {\r\n      -webkit-touch-callout: none;\r\n      -webkit-user-select: none;\r\n      -khtml-user-select: none;\r\n      -moz-user-select: none;\r\n      -ms-user-select: none;\r\n      user-select: none;\r\n      outline-style: none; /* Internet Explorer  */\r\n  }\r\n\r\n</style>\r\n","import mod from \"-!../../../../../build/vuetify-loader/lib/loader.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../build/jace-loader/src/parser.js??ref--20-3!../../../../../build/jace-loader/src/parser.js??ref--18-1!../../../../../build/jace-loader/src/parser.js??ref--33-1!./tom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../build/vuetify-loader/lib/loader.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../build/jace-loader/src/parser.js??ref--20-3!../../../../../build/jace-loader/src/parser.js??ref--18-1!../../../../../build/jace-loader/src/parser.js??ref--33-1!./tom.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./tom.vue?vue&type=template&id=19914148&scoped=true&\"\nimport script from \"./tom.vue?vue&type=script&lang=js&\"\nexport * from \"./tom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./tom.vue?vue&type=style&index=0&id=19914148&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"19914148\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div>\r\n      <tom \r\n        v-if=\"data\"\r\n        :node=\"data\"\r\n        :options = \"options\"\r\n        @show-tooltip = \"showTooltip\"\r\n        @hide-tooltip = \"hideTooltip\"\r\n        @show-menu = \"displayMenu\"\r\n        @select=\"onSelect\"\r\n      ></tom>\r\n      \r\n      <v-tooltip\r\n        top \r\n        :position-x=\"tt_x\"\r\n        :position-y=\"tt_y\"\r\n        :value=\"showTooltipModel\"\r\n        color=\"rgba(0,0,0,0)\"\r\n        open-delay=500\r\n        transition=\"fade-transition\"\r\n      >\r\n        <div \r\n          class=\"caption pa-2 secondary--text\" \r\n          style=\"\r\n            border-radius:5px; \r\n            background:#fff9c4; \r\n            background-opacity=0.75;\r\n            box-shadow: 0 3px 3px -1px rgba(0,0,0,.2),0 6px 5px 0 rgba(0,0,0,.14),0 1px 9px 0 rgba(0,0,0,.12)!important;\r\n          \"\r\n            v-html=\"tooltipText\"\r\n          >\r\n        </div>\r\n      </v-tooltip>\r\n\r\n      <v-menu\r\n        v-model=\"showMenu\"\r\n        :position-x=\"menu_x\"\r\n        :position-y=\"menu_y\"\r\n        absolute\r\n        offset-y\r\n        dense\r\n      >\r\n       \r\n      <v-list dense>\r\n            <v-list-item-group\r\n              color=\"primary\"\r\n            >\r\n              <v-list-item\r\n                v-for=\"(item, i) in menu\"\r\n                :key=\"i\"\r\n                @click=\"item.action(selection)\"\r\n                \r\n              >\r\n                <v-list-item-icon v-if=\"!!item.icon\" class=\"mr-1\">\r\n                  <v-icon :style=\"`color:${tinycolor(item.color || '#aaaaaa').darken(30).toHexString()}`\" v-text=\"item.icon\"></v-icon>\r\n                </v-list-item-icon>\r\n                <v-list-item-content>\r\n                  <v-list-item-title v-text=\"item.title\"></v-list-item-title>\r\n                </v-list-item-content>\r\n              </v-list-item>\r\n            </v-list-item-group>\r\n          </v-list>\r\n        </v-menu>\r\n            \r\n          \r\n  </div>    \r\n</template>\r\n\r\n<script>\r\nimport { find, findIndex, extend, first, last, slice, sortBy, isFunction, isArray } from \"lodash\"\r\nimport tom from \"./tom.vue\"\r\nimport { v4 } from \"uuid/dist\"\r\nimport { forEachNode, findNode, getSiblings, getParent } from \"./utils.js\"\r\nimport tinycolor from \"./tinycolor.js\"\r\n\r\n\r\n\r\nexport default {\r\n\r\n  name: \"annotator\",\r\n\r\n  props: [\"data\",\"options\", \"id\"],\r\n\r\n  components: {\r\n    tom\r\n  },\r\n\r\n\r\n  data() {\r\n      return {\r\n          \r\n          selection: [],\r\n          selectionMode:\"singly\",\r\n          _selectionOrigin:null,\r\n          \r\n          showMenu: false,\r\n          menu: [],\r\n          menu_x: 0,\r\n          menu_y: 0,\r\n\r\n          showTooltipModel: false,\r\n          tooltipText:\"\",\r\n          tt_x:0,\r\n          tt_y:0,\r\n          tt_stack:[],\r\n          tinycolor\r\n          \r\n      }\r\n  },\r\n\r\n  watch:{\r\n\r\n    data(value){\r\n      if(value) \r\n        forEachNode(value, node => {\r\n          node.id = `${this.id}-${v4()}`\r\n        })\r\n    },\r\n    \r\n\r\n    selection(value){\r\n      \r\n      if(!value) return\r\n      \r\n      forEachNode(this.data, node => {\r\n       let e = document.getElementById(node.id) \r\n       if(e) e.classList.remove(\"selected\")\r\n       node.selected = false\r\n      })\r\n\r\n\r\n      value.forEach( node => {\r\n        let e = document.getElementById(node.id) \r\n        if(e) e.classList.add(\"selected\")\r\n        node.selected = true\r\n      })\r\n\r\n      this.$emit(\"select\", value)\r\n    }\r\n\r\n  },\r\n  \r\n  methods: {\r\n    \r\n    select(selection){\r\n      this.selection = isArray(selection) ? selection : [selection]\r\n    },\r\n    \r\n    onSelect(e) {\r\n      \r\n      let options = this.options()\r\n      if(!options.availableSelectionMode) return\r\n      if( !options.availableSelectionMode().includes(this.selectionMode) ) return\r\n\r\n      if (this.selectionMode == \"bundly\"){\r\n         if (!this._selectionOrigin) {\r\n            this._selectionOrigin = e.sender.node\r\n            this.selection = [e.sender.node]\r\n            return\r\n         }\r\n         \r\n        let siblings = getSiblings(e.sender.node, this.data)\r\n        this.selection = this.selection.filter( node => find(siblings, item => item.id == node.id))\r\n        this.selection.push(e.sender.node)\r\n        \r\n        if(this.selection.length == 1){\r\n          this._selectionOrigin = e.sender.node\r\n          return\r\n        }\r\n\r\n        let originIndex = findIndex(siblings, item => item.id == this._selectionOrigin.id)\r\n        let selectionIndex = findIndex(siblings, item => item.id == e.sender.node.id)\r\n        \r\n        this.selection = []\r\n        \r\n        \r\n        if( originIndex <= selectionIndex) {\r\n          for(let i=originIndex; i <= selectionIndex; i++) {\r\n            if( options.selectable(siblings[i]) && options.selectable(siblings[i]).includes(\"singly\") ){\r\n              this.selection = []\r\n            } else {\r\n              this.selection.push(siblings[i])\r\n            }\r\n          }  \r\n        } else {\r\n          for(let i=originIndex; i >= selectionIndex; i--) {\r\n            if( options.selectable(siblings[i]) && options.selectable(siblings[i]).includes(\"singly\") ){\r\n              this.selection = []\r\n            } else {\r\n              this.selection.unshift(siblings[i])\r\n            }\r\n          }\r\n        }\r\n        return\r\n      }\r\n\r\n      this._selectionOrigin = e.sender.node\r\n\r\n      let selectionPos = findIndex(this.selection, node => node.id == e.sender.node.id) \r\n      if( selectionPos >= 0){\r\n        this.selection.splice(selectionPos, 1)\r\n        this._selectionFrom = last(this.selection)\r\n\r\n      } else {\r\n        switch (this.selectionMode) {\r\n          \r\n          case \"singly\":\r\n            this.selection = [e.sender.node]\r\n            break\r\n\r\n          case \"selectively\":\r\n            this.selection.push(e.sender.node)\r\n            break            \r\n        }  \r\n      }\r\n\r\n    },\r\n\r\n\r\n    displayMenu(e) {\r\n      \r\n      let options = this.options()\r\n    \r\n      if(!options.menu || !e.sender.node.selected) return\r\n      let menu = options.menu(e.sender.node)  \r\n      \r\n      if(!!menu) {\r\n        this.menu_x= e.position.x\r\n        this.menu_y = e.sender.$el.getBoundingClientRect().bottom+5\r\n        this.menu = menu\r\n        this.$nextTick(() => {this.showMenu = true})\r\n        return  \r\n      }\r\n      \r\n    },\r\n\r\n    \r\n\r\n    showTooltip(e){\r\n      let options = this.options()\r\n     \r\n      if(options.tooltip && !!options.tooltip(e.sender.node)){\r\n        this.tt_stack.push(e.sender)\r\n        this.tt_x= e.position.x\r\n        this.tt_y = e.position.y \r\n        this.tooltipText = options.tooltip(e.sender.node)\r\n        this.showTooltipModel = true  \r\n      }\r\n      \r\n    },\r\n\r\n    hideTooltip(e){\r\n      let options = this.options()\r\n      \r\n      if(options.tooltip && !!options.tooltip(e.sender.node)){\r\n        if(this.tt_stack.length == 1 ) {\r\n          this.tt_stack = []\r\n          this.showTooltipModel = false  \r\n        } else {\r\n          this.tt_stack.pop()\r\n          let component = this.tt_stack[this.tt_stack.length-1]\r\n          this.tt_x = e.position.x\r\n          this.tt_y = e.position.y \r\n          this.tooltipText = options.tooltip(component.node)\r\n          this.showTooltipModel = true  \r\n        }\r\n      }  \r\n      \r\n    }\r\n    \r\n  },\r\n  \r\n  \r\n  created(){\r\n    if(this.data)\r\n    forEachNode(this.data, node => {\r\n      node.id = node.id || `${this.id}-${v4()}`\r\n    })\r\n    \r\n    this.$keyController.keydown([\"shift\"], e  => {\r\n      this.selectionMode = \"bundly\"\r\n    })\r\n\r\n    this.$keyController.keyup([\"shift\"], e  => {\r\n      this.selectionMode = \"singly\"\r\n    })\r\n\r\n    this.$keyController.keydown([\"ctrl\"], e  => {\r\n        this.selectionMode = \"selectively\"\r\n    })\r\n\r\n    this.$keyController.keyup([\"ctrl\"], e  => {\r\n      this.selectionMode = \"singly\"\r\n    })\r\n  }\r\n  \r\n}\r\n\r\n</script>\r\n\r\n","import mod from \"-!../../../../../build/vuetify-loader/lib/loader.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../build/jace-loader/src/parser.js??ref--20-3!../../../../../build/jace-loader/src/parser.js??ref--18-1!../../../../../build/jace-loader/src/parser.js??ref--33-1!./annotator.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../build/vuetify-loader/lib/loader.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../build/jace-loader/src/parser.js??ref--20-3!../../../../../build/jace-loader/src/parser.js??ref--18-1!../../../../../build/jace-loader/src/parser.js??ref--33-1!./annotator.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./annotator.vue?vue&type=template&id=242f1d0a&\"\nimport script from \"./annotator.vue?vue&type=script&lang=js&\"\nexport * from \"./annotator.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../../build/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VList } from 'vuetify/lib/components/VList';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VListItemGroup } from 'vuetify/lib/components/VList';\nimport { VListItemIcon } from 'vuetify/lib/components/VList';\nimport { VListItemTitle } from 'vuetify/lib/components/VList';\nimport { VMenu } from 'vuetify/lib/components/VMenu';\nimport { VTooltip } from 'vuetify/lib/components/VTooltip';\ninstallComponents(component, {VIcon,VList,VListItem,VListItemContent,VListItemGroup,VListItemIcon,VListItemTitle,VMenu,VTooltip})\n","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../../build/vuetify-loader/lib/loader.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../build/jace-loader/src/parser.js??ref--20-3!../../../../../build/jace-loader/src/parser.js??ref--33-1!./tom.vue?vue&type=style&index=0&id=19914148&prod&scoped=true&lang=css&\"","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","// TinyColor v1.4.1\r\n// https://github.com/bgrins/TinyColor\r\n// Brian Grinstead, MIT License\r\n\r\n// (function(Math) {\r\n\r\nvar trimLeft = /^\\s+/,\r\n    trimRight = /\\s+$/,\r\n    tinyCounter = 0,\r\n    mathRound = Math.round,\r\n    mathMin = Math.min,\r\n    mathMax = Math.max,\r\n    mathRandom = Math.random;\r\n\r\nfunction tinycolor (color, opts) {\r\n\r\n    color = (color) ? color : '';\r\n    opts = opts || { };\r\n\r\n    // If input is already a tinycolor, return itself\r\n    if (color instanceof tinycolor) {\r\n       return color;\r\n    }\r\n    // If we are called as a function, call using new instead\r\n    if (!(this instanceof tinycolor)) {\r\n        return new tinycolor(color, opts);\r\n    }\r\n\r\n    var rgb = inputToRGB(color);\r\n    this._originalInput = color,\r\n    this._r = rgb.r,\r\n    this._g = rgb.g,\r\n    this._b = rgb.b,\r\n    this._a = rgb.a,\r\n    this._roundA = mathRound(100*this._a) / 100,\r\n    this._format = opts.format || rgb.format;\r\n    this._gradientType = opts.gradientType;\r\n\r\n    // Don't let the range of [0,255] come back in [0,1].\r\n    // Potentially lose a little bit of precision here, but will fix issues where\r\n    // .5 gets interpreted as half of the total, instead of half of 1\r\n    // If it was supposed to be 128, this was already taken care of by `inputToRgb`\r\n    if (this._r < 1) { this._r = mathRound(this._r); }\r\n    if (this._g < 1) { this._g = mathRound(this._g); }\r\n    if (this._b < 1) { this._b = mathRound(this._b); }\r\n\r\n    this._ok = rgb.ok;\r\n    this._tc_id = tinyCounter++;\r\n}\r\n\r\ntinycolor.prototype = {\r\n    isDark: function() {\r\n        return this.getBrightness() < 128;\r\n    },\r\n    isLight: function() {\r\n        return !this.isDark();\r\n    },\r\n    isValid: function() {\r\n        return this._ok;\r\n    },\r\n    getOriginalInput: function() {\r\n      return this._originalInput;\r\n    },\r\n    getFormat: function() {\r\n        return this._format;\r\n    },\r\n    getAlpha: function() {\r\n        return this._a;\r\n    },\r\n    getBrightness: function() {\r\n        //http://www.w3.org/TR/AERT#color-contrast\r\n        var rgb = this.toRgb();\r\n        return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\r\n    },\r\n    getLuminance: function() {\r\n        //http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\r\n        var rgb = this.toRgb();\r\n        var RsRGB, GsRGB, BsRGB, R, G, B;\r\n        RsRGB = rgb.r/255;\r\n        GsRGB = rgb.g/255;\r\n        BsRGB = rgb.b/255;\r\n\r\n        if (RsRGB <= 0.03928) {R = RsRGB / 12.92;} else {R = Math.pow(((RsRGB + 0.055) / 1.055), 2.4);}\r\n        if (GsRGB <= 0.03928) {G = GsRGB / 12.92;} else {G = Math.pow(((GsRGB + 0.055) / 1.055), 2.4);}\r\n        if (BsRGB <= 0.03928) {B = BsRGB / 12.92;} else {B = Math.pow(((BsRGB + 0.055) / 1.055), 2.4);}\r\n        return (0.2126 * R) + (0.7152 * G) + (0.0722 * B);\r\n    },\r\n    setAlpha: function(value) {\r\n        this._a = boundAlpha(value);\r\n        this._roundA = mathRound(100*this._a) / 100;\r\n        return this;\r\n    },\r\n    toHsv: function() {\r\n        var hsv = rgbToHsv(this._r, this._g, this._b);\r\n        return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };\r\n    },\r\n    toHsvString: function() {\r\n        var hsv = rgbToHsv(this._r, this._g, this._b);\r\n        var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);\r\n        return (this._a == 1) ?\r\n          \"hsv(\"  + h + \", \" + s + \"%, \" + v + \"%)\" :\r\n          \"hsva(\" + h + \", \" + s + \"%, \" + v + \"%, \"+ this._roundA + \")\";\r\n    },\r\n    toHsl: function() {\r\n        var hsl = rgbToHsl(this._r, this._g, this._b);\r\n        return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };\r\n    },\r\n    toHslString: function() {\r\n        var hsl = rgbToHsl(this._r, this._g, this._b);\r\n        var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);\r\n        return (this._a == 1) ?\r\n          \"hsl(\"  + h + \", \" + s + \"%, \" + l + \"%)\" :\r\n          \"hsla(\" + h + \", \" + s + \"%, \" + l + \"%, \"+ this._roundA + \")\";\r\n    },\r\n    toHex: function(allow3Char) {\r\n        return rgbToHex(this._r, this._g, this._b, allow3Char);\r\n    },\r\n    toHexString: function(allow3Char) {\r\n        return '#' + this.toHex(allow3Char);\r\n    },\r\n    toHex8: function(allow4Char) {\r\n        return rgbaToHex(this._r, this._g, this._b, this._a, allow4Char);\r\n    },\r\n    toHex8String: function(allow4Char) {\r\n        return '#' + this.toHex8(allow4Char);\r\n    },\r\n    toRgb: function() {\r\n        return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };\r\n    },\r\n    toRgbString: function() {\r\n        return (this._a == 1) ?\r\n          \"rgb(\"  + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \")\" :\r\n          \"rgba(\" + mathRound(this._r) + \", \" + mathRound(this._g) + \", \" + mathRound(this._b) + \", \" + this._roundA + \")\";\r\n    },\r\n    toPercentageRgb: function() {\r\n        return { r: mathRound(bound01(this._r, 255) * 100) + \"%\", g: mathRound(bound01(this._g, 255) * 100) + \"%\", b: mathRound(bound01(this._b, 255) * 100) + \"%\", a: this._a };\r\n    },\r\n    toPercentageRgbString: function() {\r\n        return (this._a == 1) ?\r\n          \"rgb(\"  + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%)\" :\r\n          \"rgba(\" + mathRound(bound01(this._r, 255) * 100) + \"%, \" + mathRound(bound01(this._g, 255) * 100) + \"%, \" + mathRound(bound01(this._b, 255) * 100) + \"%, \" + this._roundA + \")\";\r\n    },\r\n    toName: function() {\r\n        if (this._a === 0) {\r\n            return \"transparent\";\r\n        }\r\n\r\n        if (this._a < 1) {\r\n            return false;\r\n        }\r\n\r\n        return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\r\n    },\r\n    toFilter: function(secondColor) {\r\n        var hex8String = '#' + rgbaToArgbHex(this._r, this._g, this._b, this._a);\r\n        var secondHex8String = hex8String;\r\n        var gradientType = this._gradientType ? \"GradientType = 1, \" : \"\";\r\n\r\n        if (secondColor) {\r\n            var s = tinycolor(secondColor);\r\n            secondHex8String = '#' + rgbaToArgbHex(s._r, s._g, s._b, s._a);\r\n        }\r\n\r\n        return \"progid:DXImageTransform.Microsoft.gradient(\"+gradientType+\"startColorstr=\"+hex8String+\",endColorstr=\"+secondHex8String+\")\";\r\n    },\r\n    toString: function(format) {\r\n        var formatSet = !!format;\r\n        format = format || this._format;\r\n\r\n        var formattedString = false;\r\n        var hasAlpha = this._a < 1 && this._a >= 0;\r\n        var needsAlphaFormat = !formatSet && hasAlpha && (format === \"hex\" || format === \"hex6\" || format === \"hex3\" || format === \"hex4\" || format === \"hex8\" || format === \"name\");\r\n\r\n        if (needsAlphaFormat) {\r\n            // Special case for \"transparent\", all other non-alpha formats\r\n            // will return rgba when there is transparency.\r\n            if (format === \"name\" && this._a === 0) {\r\n                return this.toName();\r\n            }\r\n            return this.toRgbString();\r\n        }\r\n        if (format === \"rgb\") {\r\n            formattedString = this.toRgbString();\r\n        }\r\n        if (format === \"prgb\") {\r\n            formattedString = this.toPercentageRgbString();\r\n        }\r\n        if (format === \"hex\" || format === \"hex6\") {\r\n            formattedString = this.toHexString();\r\n        }\r\n        if (format === \"hex3\") {\r\n            formattedString = this.toHexString(true);\r\n        }\r\n        if (format === \"hex4\") {\r\n            formattedString = this.toHex8String(true);\r\n        }\r\n        if (format === \"hex8\") {\r\n            formattedString = this.toHex8String();\r\n        }\r\n        if (format === \"name\") {\r\n            formattedString = this.toName();\r\n        }\r\n        if (format === \"hsl\") {\r\n            formattedString = this.toHslString();\r\n        }\r\n        if (format === \"hsv\") {\r\n            formattedString = this.toHsvString();\r\n        }\r\n\r\n        return formattedString || this.toHexString();\r\n    },\r\n    clone: function() {\r\n        return tinycolor(this.toString());\r\n    },\r\n\r\n    _applyModification: function(fn, args) {\r\n        var color = fn.apply(null, [this].concat([].slice.call(args)));\r\n        this._r = color._r;\r\n        this._g = color._g;\r\n        this._b = color._b;\r\n        this.setAlpha(color._a);\r\n        return this;\r\n    },\r\n    lighten: function() {\r\n        return this._applyModification(lighten, arguments);\r\n    },\r\n    brighten: function() {\r\n        return this._applyModification(brighten, arguments);\r\n    },\r\n    darken: function() {\r\n        return this._applyModification(darken, arguments);\r\n    },\r\n    desaturate: function() {\r\n        return this._applyModification(desaturate, arguments);\r\n    },\r\n    saturate: function() {\r\n        return this._applyModification(saturate, arguments);\r\n    },\r\n    greyscale: function() {\r\n        return this._applyModification(greyscale, arguments);\r\n    },\r\n    spin: function() {\r\n        return this._applyModification(spin, arguments);\r\n    },\r\n\r\n    _applyCombination: function(fn, args) {\r\n        return fn.apply(null, [this].concat([].slice.call(args)));\r\n    },\r\n    analogous: function() {\r\n        return this._applyCombination(analogous, arguments);\r\n    },\r\n    complement: function() {\r\n        return this._applyCombination(complement, arguments);\r\n    },\r\n    monochromatic: function() {\r\n        return this._applyCombination(monochromatic, arguments);\r\n    },\r\n    splitcomplement: function() {\r\n        return this._applyCombination(splitcomplement, arguments);\r\n    },\r\n    triad: function() {\r\n        return this._applyCombination(triad, arguments);\r\n    },\r\n    tetrad: function() {\r\n        return this._applyCombination(tetrad, arguments);\r\n    }\r\n};\r\n\r\n// If input is an object, force 1 into \"1.0\" to handle ratios properly\r\n// String input requires \"1.0\" as input, so 1 will be treated as 1\r\ntinycolor.fromRatio = function(color, opts) {\r\n    if (typeof color == \"object\") {\r\n        var newColor = {};\r\n        for (var i in color) {\r\n            if (color.hasOwnProperty(i)) {\r\n                if (i === \"a\") {\r\n                    newColor[i] = color[i];\r\n                }\r\n                else {\r\n                    newColor[i] = convertToPercentage(color[i]);\r\n                }\r\n            }\r\n        }\r\n        color = newColor;\r\n    }\r\n\r\n    return tinycolor(color, opts);\r\n};\r\n\r\n// Given a string or object, convert that input to RGB\r\n// Possible string inputs:\r\n//\r\n//     \"red\"\r\n//     \"#f00\" or \"f00\"\r\n//     \"#ff0000\" or \"ff0000\"\r\n//     \"#ff000000\" or \"ff000000\"\r\n//     \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\r\n//     \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\r\n//     \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\r\n//     \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\r\n//     \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\r\n//     \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\r\n//     \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\r\n//\r\nfunction inputToRGB(color) {\r\n\r\n    var rgb = { r: 0, g: 0, b: 0 };\r\n    var a = 1;\r\n    var s = null;\r\n    var v = null;\r\n    var l = null;\r\n    var ok = false;\r\n    var format = false;\r\n\r\n    if (typeof color == \"string\") {\r\n        color = stringInputToObject(color);\r\n    }\r\n\r\n    if (typeof color == \"object\") {\r\n        if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\r\n            rgb = rgbToRgb(color.r, color.g, color.b);\r\n            ok = true;\r\n            format = String(color.r).substr(-1) === \"%\" ? \"prgb\" : \"rgb\";\r\n        }\r\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\r\n            s = convertToPercentage(color.s);\r\n            v = convertToPercentage(color.v);\r\n            rgb = hsvToRgb(color.h, s, v);\r\n            ok = true;\r\n            format = \"hsv\";\r\n        }\r\n        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\r\n            s = convertToPercentage(color.s);\r\n            l = convertToPercentage(color.l);\r\n            rgb = hslToRgb(color.h, s, l);\r\n            ok = true;\r\n            format = \"hsl\";\r\n        }\r\n\r\n        if (color.hasOwnProperty(\"a\")) {\r\n            a = color.a;\r\n        }\r\n    }\r\n\r\n    a = boundAlpha(a);\r\n\r\n    return {\r\n        ok: ok,\r\n        format: color.format || format,\r\n        r: mathMin(255, mathMax(rgb.r, 0)),\r\n        g: mathMin(255, mathMax(rgb.g, 0)),\r\n        b: mathMin(255, mathMax(rgb.b, 0)),\r\n        a: a\r\n    };\r\n}\r\n\r\n\r\n// Conversion Functions\r\n// --------------------\r\n\r\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\r\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\r\n\r\n// `rgbToRgb`\r\n// Handle bounds / percentage checking to conform to CSS color spec\r\n// <http://www.w3.org/TR/css3-color/>\r\n// *Assumes:* r, g, b in [0, 255] or [0, 1]\r\n// *Returns:* { r, g, b } in [0, 255]\r\nfunction rgbToRgb(r, g, b){\r\n    return {\r\n        r: bound01(r, 255) * 255,\r\n        g: bound01(g, 255) * 255,\r\n        b: bound01(b, 255) * 255\r\n    };\r\n}\r\n\r\n// `rgbToHsl`\r\n// Converts an RGB color value to HSL.\r\n// *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\r\n// *Returns:* { h, s, l } in [0,1]\r\nfunction rgbToHsl(r, g, b) {\r\n\r\n    r = bound01(r, 255);\r\n    g = bound01(g, 255);\r\n    b = bound01(b, 255);\r\n\r\n    var max = mathMax(r, g, b), min = mathMin(r, g, b);\r\n    var h, s, l = (max + min) / 2;\r\n\r\n    if(max == min) {\r\n        h = s = 0; // achromatic\r\n    }\r\n    else {\r\n        var d = max - min;\r\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n        switch(max) {\r\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\r\n            case g: h = (b - r) / d + 2; break;\r\n            case b: h = (r - g) / d + 4; break;\r\n        }\r\n\r\n        h /= 6;\r\n    }\r\n\r\n    return { h: h, s: s, l: l };\r\n}\r\n\r\n// `hslToRgb`\r\n// Converts an HSL color value to RGB.\r\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\r\n// *Returns:* { r, g, b } in the set [0, 255]\r\nfunction hslToRgb(h, s, l) {\r\n    var r, g, b;\r\n\r\n    h = bound01(h, 360);\r\n    s = bound01(s, 100);\r\n    l = bound01(l, 100);\r\n\r\n    function hue2rgb(p, q, t) {\r\n        if(t < 0) t += 1;\r\n        if(t > 1) t -= 1;\r\n        if(t < 1/6) return p + (q - p) * 6 * t;\r\n        if(t < 1/2) return q;\r\n        if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\r\n        return p;\r\n    }\r\n\r\n    if(s === 0) {\r\n        r = g = b = l; // achromatic\r\n    }\r\n    else {\r\n        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n        var p = 2 * l - q;\r\n        r = hue2rgb(p, q, h + 1/3);\r\n        g = hue2rgb(p, q, h);\r\n        b = hue2rgb(p, q, h - 1/3);\r\n    }\r\n\r\n    return { r: r * 255, g: g * 255, b: b * 255 };\r\n}\r\n\r\n// `rgbToHsv`\r\n// Converts an RGB color value to HSV\r\n// *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\r\n// *Returns:* { h, s, v } in [0,1]\r\nfunction rgbToHsv(r, g, b) {\r\n\r\n    r = bound01(r, 255);\r\n    g = bound01(g, 255);\r\n    b = bound01(b, 255);\r\n\r\n    var max = mathMax(r, g, b), min = mathMin(r, g, b);\r\n    var h, s, v = max;\r\n\r\n    var d = max - min;\r\n    s = max === 0 ? 0 : d / max;\r\n\r\n    if(max == min) {\r\n        h = 0; // achromatic\r\n    }\r\n    else {\r\n        switch(max) {\r\n            case r: h = (g - b) / d + (g < b ? 6 : 0); break;\r\n            case g: h = (b - r) / d + 2; break;\r\n            case b: h = (r - g) / d + 4; break;\r\n        }\r\n        h /= 6;\r\n    }\r\n    return { h: h, s: s, v: v };\r\n}\r\n\r\n// `hsvToRgb`\r\n// Converts an HSV color value to RGB.\r\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\r\n// *Returns:* { r, g, b } in the set [0, 255]\r\n function hsvToRgb(h, s, v) {\r\n\r\n    h = bound01(h, 360) * 6;\r\n    s = bound01(s, 100);\r\n    v = bound01(v, 100);\r\n\r\n    var i = Math.floor(h),\r\n        f = h - i,\r\n        p = v * (1 - s),\r\n        q = v * (1 - f * s),\r\n        t = v * (1 - (1 - f) * s),\r\n        mod = i % 6,\r\n        r = [v, q, p, p, t, v][mod],\r\n        g = [t, v, v, q, p, p][mod],\r\n        b = [p, p, t, v, v, q][mod];\r\n\r\n    return { r: r * 255, g: g * 255, b: b * 255 };\r\n}\r\n\r\n// `rgbToHex`\r\n// Converts an RGB color to hex\r\n// Assumes r, g, and b are contained in the set [0, 255]\r\n// Returns a 3 or 6 character hex\r\nfunction rgbToHex(r, g, b, allow3Char) {\r\n\r\n    var hex = [\r\n        pad2(mathRound(r).toString(16)),\r\n        pad2(mathRound(g).toString(16)),\r\n        pad2(mathRound(b).toString(16))\r\n    ];\r\n\r\n    // Return a 3 character hex if possible\r\n    if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\r\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\r\n    }\r\n\r\n    return hex.join(\"\");\r\n}\r\n\r\n// `rgbaToHex`\r\n// Converts an RGBA color plus alpha transparency to hex\r\n// Assumes r, g, b are contained in the set [0, 255] and\r\n// a in [0, 1]. Returns a 4 or 8 character rgba hex\r\nfunction rgbaToHex(r, g, b, a, allow4Char) {\r\n\r\n    var hex = [\r\n        pad2(mathRound(r).toString(16)),\r\n        pad2(mathRound(g).toString(16)),\r\n        pad2(mathRound(b).toString(16)),\r\n        pad2(convertDecimalToHex(a))\r\n    ];\r\n\r\n    // Return a 4 character hex if possible\r\n    if (allow4Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1) && hex[3].charAt(0) == hex[3].charAt(1)) {\r\n        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\r\n    }\r\n\r\n    return hex.join(\"\");\r\n}\r\n\r\n// `rgbaToArgbHex`\r\n// Converts an RGBA color to an ARGB Hex8 string\r\n// Rarely used, but required for \"toFilter()\"\r\nfunction rgbaToArgbHex(r, g, b, a) {\r\n\r\n    var hex = [\r\n        pad2(convertDecimalToHex(a)),\r\n        pad2(mathRound(r).toString(16)),\r\n        pad2(mathRound(g).toString(16)),\r\n        pad2(mathRound(b).toString(16))\r\n    ];\r\n\r\n    return hex.join(\"\");\r\n}\r\n\r\n// `equals`\r\n// Can be called with any tinycolor input\r\ntinycolor.equals = function (color1, color2) {\r\n    if (!color1 || !color2) { return false; }\r\n    return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\r\n};\r\n\r\ntinycolor.random = function() {\r\n    return tinycolor.fromRatio({\r\n        r: mathRandom(),\r\n        g: mathRandom(),\r\n        b: mathRandom()\r\n    });\r\n};\r\n\r\n\r\n// Modification Functions\r\n// ----------------------\r\n// Thanks to less.js for some of the basics here\r\n// <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\r\n\r\nfunction desaturate(color, amount) {\r\n    amount = (amount === 0) ? 0 : (amount || 10);\r\n    var hsl = tinycolor(color).toHsl();\r\n    hsl.s -= amount / 100;\r\n    hsl.s = clamp01(hsl.s);\r\n    return tinycolor(hsl);\r\n}\r\n\r\nfunction saturate(color, amount) {\r\n    amount = (amount === 0) ? 0 : (amount || 10);\r\n    var hsl = tinycolor(color).toHsl();\r\n    hsl.s += amount / 100;\r\n    hsl.s = clamp01(hsl.s);\r\n    return tinycolor(hsl);\r\n}\r\n\r\nfunction greyscale(color) {\r\n    return tinycolor(color).desaturate(100);\r\n}\r\n\r\nfunction lighten (color, amount) {\r\n    amount = (amount === 0) ? 0 : (amount || 10);\r\n    var hsl = tinycolor(color).toHsl();\r\n    hsl.l += amount / 100;\r\n    hsl.l = clamp01(hsl.l);\r\n    return tinycolor(hsl);\r\n}\r\n\r\nfunction brighten(color, amount) {\r\n    amount = (amount === 0) ? 0 : (amount || 10);\r\n    var rgb = tinycolor(color).toRgb();\r\n    rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));\r\n    rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));\r\n    rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));\r\n    return tinycolor(rgb);\r\n}\r\n\r\nfunction darken (color, amount) {\r\n    amount = (amount === 0) ? 0 : (amount || 10);\r\n    var hsl = tinycolor(color).toHsl();\r\n    hsl.l -= amount / 100;\r\n    hsl.l = clamp01(hsl.l);\r\n    return tinycolor(hsl);\r\n}\r\n\r\n// Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\r\n// Values outside of this range will be wrapped into this range.\r\nfunction spin(color, amount) {\r\n    var hsl = tinycolor(color).toHsl();\r\n    var hue = (hsl.h + amount) % 360;\r\n    hsl.h = hue < 0 ? 360 + hue : hue;\r\n    return tinycolor(hsl);\r\n}\r\n\r\n// Combination Functions\r\n// ---------------------\r\n// Thanks to jQuery xColor for some of the ideas behind these\r\n// <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\r\n\r\nfunction complement(color) {\r\n    var hsl = tinycolor(color).toHsl();\r\n    hsl.h = (hsl.h + 180) % 360;\r\n    return tinycolor(hsl);\r\n}\r\n\r\nfunction triad(color) {\r\n    var hsl = tinycolor(color).toHsl();\r\n    var h = hsl.h;\r\n    return [\r\n        tinycolor(color),\r\n        tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),\r\n        tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })\r\n    ];\r\n}\r\n\r\nfunction tetrad(color) {\r\n    var hsl = tinycolor(color).toHsl();\r\n    var h = hsl.h;\r\n    return [\r\n        tinycolor(color),\r\n        tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),\r\n        tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),\r\n        tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })\r\n    ];\r\n}\r\n\r\nfunction splitcomplement(color) {\r\n    var hsl = tinycolor(color).toHsl();\r\n    var h = hsl.h;\r\n    return [\r\n        tinycolor(color),\r\n        tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),\r\n        tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})\r\n    ];\r\n}\r\n\r\nfunction analogous(color, results, slices) {\r\n    results = results || 6;\r\n    slices = slices || 30;\r\n\r\n    var hsl = tinycolor(color).toHsl();\r\n    var part = 360 / slices;\r\n    var ret = [tinycolor(color)];\r\n\r\n    for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {\r\n        hsl.h = (hsl.h + part) % 360;\r\n        ret.push(tinycolor(hsl));\r\n    }\r\n    return ret;\r\n}\r\n\r\nfunction monochromatic(color, results) {\r\n    results = results || 6;\r\n    var hsv = tinycolor(color).toHsv();\r\n    var h = hsv.h, s = hsv.s, v = hsv.v;\r\n    var ret = [];\r\n    var modification = 1 / results;\r\n\r\n    while (results--) {\r\n        ret.push(tinycolor({ h: h, s: s, v: v}));\r\n        v = (v + modification) % 1;\r\n    }\r\n\r\n    return ret;\r\n}\r\n\r\n// Utility Functions\r\n// ---------------------\r\n\r\ntinycolor.mix = function(color1, color2, amount) {\r\n    amount = (amount === 0) ? 0 : (amount || 50);\r\n\r\n    var rgb1 = tinycolor(color1).toRgb();\r\n    var rgb2 = tinycolor(color2).toRgb();\r\n\r\n    var p = amount / 100;\r\n\r\n    var rgba = {\r\n        r: ((rgb2.r - rgb1.r) * p) + rgb1.r,\r\n        g: ((rgb2.g - rgb1.g) * p) + rgb1.g,\r\n        b: ((rgb2.b - rgb1.b) * p) + rgb1.b,\r\n        a: ((rgb2.a - rgb1.a) * p) + rgb1.a\r\n    };\r\n\r\n    return tinycolor(rgba);\r\n};\r\n\r\n\r\n// Readability Functions\r\n// ---------------------\r\n// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)\r\n\r\n// `contrast`\r\n// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)\r\ntinycolor.readability = function(color1, color2) {\r\n    var c1 = tinycolor(color1);\r\n    var c2 = tinycolor(color2);\r\n    return (Math.max(c1.getLuminance(),c2.getLuminance())+0.05) / (Math.min(c1.getLuminance(),c2.getLuminance())+0.05);\r\n};\r\n\r\n// `isReadable`\r\n// Ensure that foreground and background color combinations meet WCAG2 guidelines.\r\n// The third argument is an optional Object.\r\n//      the 'level' property states 'AA' or 'AAA' - if missing or invalid, it defaults to 'AA';\r\n//      the 'size' property states 'large' or 'small' - if missing or invalid, it defaults to 'small'.\r\n// If the entire object is absent, isReadable defaults to {level:\"AA\",size:\"small\"}.\r\n\r\n// *Example*\r\n//    tinycolor.isReadable(\"#000\", \"#111\") => false\r\n//    tinycolor.isReadable(\"#000\", \"#111\",{level:\"AA\",size:\"large\"}) => false\r\ntinycolor.isReadable = function(color1, color2, wcag2) {\r\n    var readability = tinycolor.readability(color1, color2);\r\n    var wcag2Parms, out;\r\n\r\n    out = false;\r\n\r\n    wcag2Parms = validateWCAG2Parms(wcag2);\r\n    switch (wcag2Parms.level + wcag2Parms.size) {\r\n        case \"AAsmall\":\r\n        case \"AAAlarge\":\r\n            out = readability >= 4.5;\r\n            break;\r\n        case \"AAlarge\":\r\n            out = readability >= 3;\r\n            break;\r\n        case \"AAAsmall\":\r\n            out = readability >= 7;\r\n            break;\r\n    }\r\n    return out;\r\n\r\n};\r\n\r\n// `mostReadable`\r\n// Given a base color and a list of possible foreground or background\r\n// colors for that base, returns the most readable color.\r\n// Optionally returns Black or White if the most readable color is unreadable.\r\n// *Example*\r\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:false}).toHexString(); // \"#112255\"\r\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:true}).toHexString();  // \"#ffffff\"\r\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"large\"}).toHexString(); // \"#faf3f3\"\r\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"small\"}).toHexString(); // \"#ffffff\"\r\ntinycolor.mostReadable = function(baseColor, colorList, args) {\r\n    var bestColor = null;\r\n    var bestScore = 0;\r\n    var readability;\r\n    var includeFallbackColors, level, size ;\r\n    args = args || {};\r\n    includeFallbackColors = args.includeFallbackColors ;\r\n    level = args.level;\r\n    size = args.size;\r\n\r\n    for (var i= 0; i < colorList.length ; i++) {\r\n        readability = tinycolor.readability(baseColor, colorList[i]);\r\n        if (readability > bestScore) {\r\n            bestScore = readability;\r\n            bestColor = tinycolor(colorList[i]);\r\n        }\r\n    }\r\n\r\n    if (tinycolor.isReadable(baseColor, bestColor, {\"level\":level,\"size\":size}) || !includeFallbackColors) {\r\n        return bestColor;\r\n    }\r\n    else {\r\n        args.includeFallbackColors=false;\r\n        return tinycolor.mostReadable(baseColor,[\"#fff\", \"#000\"],args);\r\n    }\r\n};\r\n\r\n\r\n// Big List of Colors\r\n// ------------------\r\n// <http://www.w3.org/TR/css3-color/#svg-color>\r\nvar names = tinycolor.names = {\r\n    aliceblue: \"f0f8ff\",\r\n    antiquewhite: \"faebd7\",\r\n    aqua: \"0ff\",\r\n    aquamarine: \"7fffd4\",\r\n    azure: \"f0ffff\",\r\n    beige: \"f5f5dc\",\r\n    bisque: \"ffe4c4\",\r\n    black: \"000\",\r\n    blanchedalmond: \"ffebcd\",\r\n    blue: \"00f\",\r\n    blueviolet: \"8a2be2\",\r\n    brown: \"a52a2a\",\r\n    burlywood: \"deb887\",\r\n    burntsienna: \"ea7e5d\",\r\n    cadetblue: \"5f9ea0\",\r\n    chartreuse: \"7fff00\",\r\n    chocolate: \"d2691e\",\r\n    coral: \"ff7f50\",\r\n    cornflowerblue: \"6495ed\",\r\n    cornsilk: \"fff8dc\",\r\n    crimson: \"dc143c\",\r\n    cyan: \"0ff\",\r\n    darkblue: \"00008b\",\r\n    darkcyan: \"008b8b\",\r\n    darkgoldenrod: \"b8860b\",\r\n    darkgray: \"a9a9a9\",\r\n    darkgreen: \"006400\",\r\n    darkgrey: \"a9a9a9\",\r\n    darkkhaki: \"bdb76b\",\r\n    darkmagenta: \"8b008b\",\r\n    darkolivegreen: \"556b2f\",\r\n    darkorange: \"ff8c00\",\r\n    darkorchid: \"9932cc\",\r\n    darkred: \"8b0000\",\r\n    darksalmon: \"e9967a\",\r\n    darkseagreen: \"8fbc8f\",\r\n    darkslateblue: \"483d8b\",\r\n    darkslategray: \"2f4f4f\",\r\n    darkslategrey: \"2f4f4f\",\r\n    darkturquoise: \"00ced1\",\r\n    darkviolet: \"9400d3\",\r\n    deeppink: \"ff1493\",\r\n    deepskyblue: \"00bfff\",\r\n    dimgray: \"696969\",\r\n    dimgrey: \"696969\",\r\n    dodgerblue: \"1e90ff\",\r\n    firebrick: \"b22222\",\r\n    floralwhite: \"fffaf0\",\r\n    forestgreen: \"228b22\",\r\n    fuchsia: \"f0f\",\r\n    gainsboro: \"dcdcdc\",\r\n    ghostwhite: \"f8f8ff\",\r\n    gold: \"ffd700\",\r\n    goldenrod: \"daa520\",\r\n    gray: \"808080\",\r\n    green: \"008000\",\r\n    greenyellow: \"adff2f\",\r\n    grey: \"808080\",\r\n    honeydew: \"f0fff0\",\r\n    hotpink: \"ff69b4\",\r\n    indianred: \"cd5c5c\",\r\n    indigo: \"4b0082\",\r\n    ivory: \"fffff0\",\r\n    khaki: \"f0e68c\",\r\n    lavender: \"e6e6fa\",\r\n    lavenderblush: \"fff0f5\",\r\n    lawngreen: \"7cfc00\",\r\n    lemonchiffon: \"fffacd\",\r\n    lightblue: \"add8e6\",\r\n    lightcoral: \"f08080\",\r\n    lightcyan: \"e0ffff\",\r\n    lightgoldenrodyellow: \"fafad2\",\r\n    lightgray: \"d3d3d3\",\r\n    lightgreen: \"90ee90\",\r\n    lightgrey: \"d3d3d3\",\r\n    lightpink: \"ffb6c1\",\r\n    lightsalmon: \"ffa07a\",\r\n    lightseagreen: \"20b2aa\",\r\n    lightskyblue: \"87cefa\",\r\n    lightslategray: \"789\",\r\n    lightslategrey: \"789\",\r\n    lightsteelblue: \"b0c4de\",\r\n    lightyellow: \"ffffe0\",\r\n    lime: \"0f0\",\r\n    limegreen: \"32cd32\",\r\n    linen: \"faf0e6\",\r\n    magenta: \"f0f\",\r\n    maroon: \"800000\",\r\n    mediumaquamarine: \"66cdaa\",\r\n    mediumblue: \"0000cd\",\r\n    mediumorchid: \"ba55d3\",\r\n    mediumpurple: \"9370db\",\r\n    mediumseagreen: \"3cb371\",\r\n    mediumslateblue: \"7b68ee\",\r\n    mediumspringgreen: \"00fa9a\",\r\n    mediumturquoise: \"48d1cc\",\r\n    mediumvioletred: \"c71585\",\r\n    midnightblue: \"191970\",\r\n    mintcream: \"f5fffa\",\r\n    mistyrose: \"ffe4e1\",\r\n    moccasin: \"ffe4b5\",\r\n    navajowhite: \"ffdead\",\r\n    navy: \"000080\",\r\n    oldlace: \"fdf5e6\",\r\n    olive: \"808000\",\r\n    olivedrab: \"6b8e23\",\r\n    orange: \"ffa500\",\r\n    orangered: \"ff4500\",\r\n    orchid: \"da70d6\",\r\n    palegoldenrod: \"eee8aa\",\r\n    palegreen: \"98fb98\",\r\n    paleturquoise: \"afeeee\",\r\n    palevioletred: \"db7093\",\r\n    papayawhip: \"ffefd5\",\r\n    peachpuff: \"ffdab9\",\r\n    peru: \"cd853f\",\r\n    pink: \"ffc0cb\",\r\n    plum: \"dda0dd\",\r\n    powderblue: \"b0e0e6\",\r\n    purple: \"800080\",\r\n    rebeccapurple: \"663399\",\r\n    red: \"f00\",\r\n    rosybrown: \"bc8f8f\",\r\n    royalblue: \"4169e1\",\r\n    saddlebrown: \"8b4513\",\r\n    salmon: \"fa8072\",\r\n    sandybrown: \"f4a460\",\r\n    seagreen: \"2e8b57\",\r\n    seashell: \"fff5ee\",\r\n    sienna: \"a0522d\",\r\n    silver: \"c0c0c0\",\r\n    skyblue: \"87ceeb\",\r\n    slateblue: \"6a5acd\",\r\n    slategray: \"708090\",\r\n    slategrey: \"708090\",\r\n    snow: \"fffafa\",\r\n    springgreen: \"00ff7f\",\r\n    steelblue: \"4682b4\",\r\n    tan: \"d2b48c\",\r\n    teal: \"008080\",\r\n    thistle: \"d8bfd8\",\r\n    tomato: \"ff6347\",\r\n    turquoise: \"40e0d0\",\r\n    violet: \"ee82ee\",\r\n    wheat: \"f5deb3\",\r\n    white: \"fff\",\r\n    whitesmoke: \"f5f5f5\",\r\n    yellow: \"ff0\",\r\n    yellowgreen: \"9acd32\"\r\n};\r\n\r\n// Make it easy to access colors via `hexNames[hex]`\r\nvar hexNames = tinycolor.hexNames = flip(names);\r\n\r\n\r\n// Utilities\r\n// ---------\r\n\r\n// `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`\r\nfunction flip(o) {\r\n    var flipped = { };\r\n    for (var i in o) {\r\n        if (o.hasOwnProperty(i)) {\r\n            flipped[o[i]] = i;\r\n        }\r\n    }\r\n    return flipped;\r\n}\r\n\r\n// Return a valid alpha value [0,1] with all invalid values being set to 1\r\nfunction boundAlpha(a) {\r\n    a = parseFloat(a);\r\n\r\n    if (isNaN(a) || a < 0 || a > 1) {\r\n        a = 1;\r\n    }\r\n\r\n    return a;\r\n}\r\n\r\n// Take input from [0, n] and return it as [0, 1]\r\nfunction bound01(n, max) {\r\n    if (isOnePointZero(n)) { n = \"100%\"; }\r\n\r\n    var processPercent = isPercentage(n);\r\n    n = mathMin(max, mathMax(0, parseFloat(n)));\r\n\r\n    // Automatically convert percentage into number\r\n    if (processPercent) {\r\n        n = parseInt(n * max, 10) / 100;\r\n    }\r\n\r\n    // Handle floating point rounding errors\r\n    if ((Math.abs(n - max) < 0.000001)) {\r\n        return 1;\r\n    }\r\n\r\n    // Convert into [0, 1] range if it isn't already\r\n    return (n % max) / parseFloat(max);\r\n}\r\n\r\n// Force a number between 0 and 1\r\nfunction clamp01(val) {\r\n    return mathMin(1, mathMax(0, val));\r\n}\r\n\r\n// Parse a base-16 hex value into a base-10 integer\r\nfunction parseIntFromHex(val) {\r\n    return parseInt(val, 16);\r\n}\r\n\r\n// Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\r\n// <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\r\nfunction isOnePointZero(n) {\r\n    return typeof n == \"string\" && n.indexOf('.') != -1 && parseFloat(n) === 1;\r\n}\r\n\r\n// Check to see if string passed in is a percentage\r\nfunction isPercentage(n) {\r\n    return typeof n === \"string\" && n.indexOf('%') != -1;\r\n}\r\n\r\n// Force a hex value to have 2 characters\r\nfunction pad2(c) {\r\n    return c.length == 1 ? '0' + c : '' + c;\r\n}\r\n\r\n// Replace a decimal with it's percentage value\r\nfunction convertToPercentage(n) {\r\n    if (n <= 1) {\r\n        n = (n * 100) + \"%\";\r\n    }\r\n\r\n    return n;\r\n}\r\n\r\n// Converts a decimal to a hex value\r\nfunction convertDecimalToHex(d) {\r\n    return Math.round(parseFloat(d) * 255).toString(16);\r\n}\r\n// Converts a hex value to a decimal\r\nfunction convertHexToDecimal(h) {\r\n    return (parseIntFromHex(h) / 255);\r\n}\r\n\r\nvar matchers = (function() {\r\n\r\n    // <http://www.w3.org/TR/css3-values/#integers>\r\n    var CSS_INTEGER = \"[-\\\\+]?\\\\d+%?\";\r\n\r\n    // <http://www.w3.org/TR/css3-values/#number-value>\r\n    var CSS_NUMBER = \"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\";\r\n\r\n    // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\r\n    var CSS_UNIT = \"(?:\" + CSS_NUMBER + \")|(?:\" + CSS_INTEGER + \")\";\r\n\r\n    // Actual matching.\r\n    // Parentheses and commas are optional, but not required.\r\n    // Whitespace can take the place of commas or opening paren\r\n    var PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\r\n    var PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\r\n\r\n    return {\r\n        CSS_UNIT: new RegExp(CSS_UNIT),\r\n        rgb: new RegExp(\"rgb\" + PERMISSIVE_MATCH3),\r\n        rgba: new RegExp(\"rgba\" + PERMISSIVE_MATCH4),\r\n        hsl: new RegExp(\"hsl\" + PERMISSIVE_MATCH3),\r\n        hsla: new RegExp(\"hsla\" + PERMISSIVE_MATCH4),\r\n        hsv: new RegExp(\"hsv\" + PERMISSIVE_MATCH3),\r\n        hsva: new RegExp(\"hsva\" + PERMISSIVE_MATCH4),\r\n        hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\r\n        hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\r\n        hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\r\n        hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\r\n    };\r\n})();\r\n\r\n// `isValidCSSUnit`\r\n// Take in a single string / number and check to see if it looks like a CSS unit\r\n// (see `matchers` above for definition).\r\nfunction isValidCSSUnit(color) {\r\n    return !!matchers.CSS_UNIT.exec(color);\r\n}\r\n\r\n// `stringInputToObject`\r\n// Permissive string parsing.  Take in a number of formats, and output an object\r\n// based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\r\nfunction stringInputToObject(color) {\r\n\r\n    color = color.replace(trimLeft,'').replace(trimRight, '').toLowerCase();\r\n    var named = false;\r\n    if (names[color]) {\r\n        color = names[color];\r\n        named = true;\r\n    }\r\n    else if (color == 'transparent') {\r\n        return { r: 0, g: 0, b: 0, a: 0, format: \"name\" };\r\n    }\r\n\r\n    // Try to match string input using regular expressions.\r\n    // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\r\n    // Just return an object and let the conversion functions handle that.\r\n    // This way the result will be the same whether the tinycolor is initialized with string or object.\r\n    var match;\r\n    if ((match = matchers.rgb.exec(color))) {\r\n        return { r: match[1], g: match[2], b: match[3] };\r\n    }\r\n    if ((match = matchers.rgba.exec(color))) {\r\n        return { r: match[1], g: match[2], b: match[3], a: match[4] };\r\n    }\r\n    if ((match = matchers.hsl.exec(color))) {\r\n        return { h: match[1], s: match[2], l: match[3] };\r\n    }\r\n    if ((match = matchers.hsla.exec(color))) {\r\n        return { h: match[1], s: match[2], l: match[3], a: match[4] };\r\n    }\r\n    if ((match = matchers.hsv.exec(color))) {\r\n        return { h: match[1], s: match[2], v: match[3] };\r\n    }\r\n    if ((match = matchers.hsva.exec(color))) {\r\n        return { h: match[1], s: match[2], v: match[3], a: match[4] };\r\n    }\r\n    if ((match = matchers.hex8.exec(color))) {\r\n        return {\r\n            r: parseIntFromHex(match[1]),\r\n            g: parseIntFromHex(match[2]),\r\n            b: parseIntFromHex(match[3]),\r\n            a: convertHexToDecimal(match[4]),\r\n            format: named ? \"name\" : \"hex8\"\r\n        };\r\n    }\r\n    if ((match = matchers.hex6.exec(color))) {\r\n        return {\r\n            r: parseIntFromHex(match[1]),\r\n            g: parseIntFromHex(match[2]),\r\n            b: parseIntFromHex(match[3]),\r\n            format: named ? \"name\" : \"hex\"\r\n        };\r\n    }\r\n    if ((match = matchers.hex4.exec(color))) {\r\n        return {\r\n            r: parseIntFromHex(match[1] + '' + match[1]),\r\n            g: parseIntFromHex(match[2] + '' + match[2]),\r\n            b: parseIntFromHex(match[3] + '' + match[3]),\r\n            a: convertHexToDecimal(match[4] + '' + match[4]),\r\n            format: named ? \"name\" : \"hex8\"\r\n        };\r\n    }\r\n    if ((match = matchers.hex3.exec(color))) {\r\n        return {\r\n            r: parseIntFromHex(match[1] + '' + match[1]),\r\n            g: parseIntFromHex(match[2] + '' + match[2]),\r\n            b: parseIntFromHex(match[3] + '' + match[3]),\r\n            format: named ? \"name\" : \"hex\"\r\n        };\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction validateWCAG2Parms(parms) {\r\n    // return valid WCAG2 parms for isReadable.\r\n    // If input parms are invalid, return {\"level\":\"AA\", \"size\":\"small\"}\r\n    var level, size;\r\n    parms = parms || {\"level\":\"AA\", \"size\":\"small\"};\r\n    level = (parms.level || \"AA\").toUpperCase();\r\n    size = (parms.size || \"small\").toLowerCase();\r\n    if (level !== \"AA\" && level !== \"AAA\") {\r\n        level = \"AA\";\r\n    }\r\n    if (size !== \"small\" && size !== \"large\") {\r\n        size = \"small\";\r\n    }\r\n    return {\"level\":level, \"size\":size};\r\n}\r\n\r\nexport default tinycolor\r\n\r\n// // Node: Export function\r\n// if (typeof module !== \"undefined\" && module.exports) {\r\n//     module.exports = tinycolor;\r\n// }\r\n// // AMD/requirejs: Define the module\r\n// else if (typeof define === 'function' && define.amd) {\r\n//     define(function () {return tinycolor;});\r\n// }\r\n// // Browser: Expose to window\r\n// else {\r\n//     window.tinycolor = tinycolor;\r\n// }\r\n\r\n// })(Math);\r\n"],"sourceRoot":""}